function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function createPngDataTable(){for(var t=new Int32Array(256),e=0;e<256;e++){for(var n=e,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}function calcCrc(t){var e=-1;pngDataTable=pngDataTable||createPngDataTable();for(var n=0;n<t.length;n++)e=pngDataTable[255&(e^t[n])]^e>>>8;return-1^e}!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.AreaSortable=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var rt="$areaSortable",at="rect",ot="scroll",st="style",lt="margin",ut="padding",ct="left",ht="right",ft="width",dt="top",pt="bottom",gt="height",mt="nextElementSibling",bt="previousElementSibling",vt="scrollTop",yt="scrollLeft",_t=1,St=2,wt=_t+St,xt=Math,Pt=String,y=parseInt,i=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n=/^\s+|\s+$/g,P=/mousedown|pointerdown/,l=Pt.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(n,"")},r=null;function Mt(t,e){return t<0?-1:0<t?1:e||0}function _(t){return"function"==typeof t}function S(t){return"[object String]"===e.call(t)}function u(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function w(t,e,n,i){null==r&&(r=u()),t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,r?i:"object"==typeof i?!!i.capture:!!i)}function o(t,e,n,i){null==r&&(r=u()),t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,r?i:"object"==typeof i?!!i.capture:!!i)}function x(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function At(t,e){t.classList?t.classList.add(e):x(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function Ct(t,e){t.classList?t.classList.remove(e):t.className=l((" "+t.className+" ").replace(" "+e+" "," "))}function Tt(t,e){return 0!==t[e]||(t[e]=1)===t[e]&&(t[e]=0,1)}function Et(t){return(_(window.getComputedStyle)?window.getComputedStyle(t,null):t.currentStyle)||{}}function kt(t,e,n){return t.elementsFromPoint(e,n)}function Rt(n,t){return t.reduce(function(t,e){return t[e]=n[st].getPropertyValue(e),t},{})}function Ft(e,t,n){n=n||e[rt][st],t.forEach(function(t){i.call(n,t)&&""!==n[t]?e[st][t]=n[t]:e[st].removeProperty(t)})}function It(e,t,n){var i,r,a,o;0<t&&(e[rt]&&e[rt].animation&&e[rt].animation.stop(),i="transform "+Pt(t)+"ms",r="translate3d(0,0,0)",a=null,o=function t(){a&&clearTimeout(a),a=null,e[rt]&&e[rt].animation&&t===e[rt].animation.stop&&(e[rt].animation=null),e[st].transform===r&&e[st].transition===i&&(e[st].transition="none",e[st].transform="none")},e[st].transition="none",e[st].transform="translate3d("+Pt(-(n[ct]||0))+"px,"+Pt(-(n[dt]||0))+"px,0)",e.offsetWidth,e[st].transform=r,e[st].transition=i,a=setTimeout(o,t),e[rt].animation={stop:o})}function Dt(t,e,n,i,r){return t=t[rt].r,e=e[rt][at],xt.max(0,xt.min(1,xt.max(0,xt.min(t[i]+t[r],e[i]-n[i]+e[r])-xt.max(t[i],e[i]-n[i]))/xt.min(t[r],e[r])))}function Lt(t,e,n,i,r){var t=t[rt].r,e=e[rt][at],a=xt.max(0,xt.min(t[ct]+t[ft],e[ct]-n[ct]+e[ft])-xt.max(t[ct],e[ct]-n[ct])),n=xt.max(0,xt.min(t[dt]+t[gt],e[dt]-n[dt]+e[gt])-xt.max(t[dt],e[dt]-n[dt]));return xt.max(0,xt.min(1,a*n/(xt.min(t[ft],e[ft])*xt.min(t[gt],e[gt]))))}function a(M,A){function T(t,e,n){n<0?(D===e&&(D=t),R===t&&(R=E[bt]),J.insertBefore(t,e)):0<n&&(D===t&&(D=t[mt]),e[mt]?J.insertBefore(t,e[mt]):(J.appendChild(t),R=t)),t[rt].index=e[rt].index,J.insertBefore(E,t),_(M.options.onChange)&&M.options.onChange(t)}function t(t){if(f&&!b&&M.options.container&&(!P.test(t.type)||0===t.button))if(g(),(c=t.target)&&x(c,M.options.handle||"dnd-sortable-handle"))if(C=function(t,e){if(t.closest)return t.closest("."+e);for(;t;){if(x(t,e))return t;t=t.parentNode}}(c,M.options.item||"dnd-sortable-item"))if(!(J=C.parentNode)||S(M.options.container)&&J.id!==M.options.container||!S(M.options.container)&&J!==M.options.container)g();else if(_(M.options.onStart)&&M.options.onStart(C),_(M.options.itemFilter)&&!(C=M.options.itemFilter(C)))g();else{b=!0,V=C.ownerDocument||document,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),d=t.touches&&t.touches.length;var e,r=0,a=0,o=ct,s=ft,l=ht,n=(J.tagName||"").toLowerCase();if(I=(e=V).scrollingElement||e.documentElement||e.body,L=null,M.options.autoscroll)for(L=J;L&&!(I===L||St!==A&&L.scrollHeight>L.clientHeight&&Tt(L,vt)||_t!==A&&L.scrollWidth>L.clientWidth&&Tt(L,yt));)L=L.parentNode;J[rt]={rect:J.getBoundingClientRect(),scroll:{top:J[vt]||0,left:J[yt]||0,width:J.scrollWidth,height:J.scrollHeight,top0:J[vt]||0,left0:J[yt]||0},$:Et(J),style:Rt(J,["width","height","max-width","max-height","box-sizing","padding-left","padding-top","padding-right","padding-bottom"])},J[rt][ut]={left:y(J[rt].$.paddingLeft)||0,right:y(J[rt].$.paddingRight)||0},L&&L!==J&&(L[rt]={rect:L.getBoundingClientRect(),scroll:{top:L[vt]||0,left:L[yt]||0,width:L.scrollWidth,height:L.scrollHeight,top0:L[vt]||0,left0:L[yt]||0}}),(h=[].map.call(J.children,function(t,e){var n=t.getBoundingClientRect(),i=Et(t);return t[rt]={index:e,line:0,prev:{},rect:{top:n[dt],left:n[ct],width:n[ft],height:n[gt]},r:{top:n[dt],left:n[ct],width:n[ft],height:n[gt]},margin:{top:y(i.marginTop)||0,right:y(i.marginRight)||0,bottom:y(i.marginBottom)||0,left:y(i.marginLeft)||0},$:i,style:Rt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),animation:null},e=t[rt][lt][o]+t[rt][at][s]+t[rt][lt][l],0<a&&J[rt][ut][o]+a+e+J[rt][ut][l]>J[rt][at][s]&&(r++,a=0),t[rt].line=r,a+=e,t})).length&&(D=h[0],R=h[h.length-1]),o=dt,s=gt,l=pt,F=new Array(h.length),h.forEach(function(t){var e=t[rt].line,t=t[rt][at][o]-t[rt][lt][o]-J[rt][at][o]+J[rt][ot][o];F[e]=null==F[e]?t:xt.min(t,F[e])}),At(J,M.options.activeArea||"dnd-sortable-area"),J[st].boxSizing="border-box",J[st][ft]=Pt(J[rt][at][ft])+"px",J[st][gt]=Pt(J[rt][at][gt])+"px",J[st].maxWidth=Pt(J[rt][at][ft])+"px",J[st].maxHeight=Pt(J[rt][at][gt])+"px",C.draggable=!1,At(C,M.options.activeItem||"dnd-sortable-dragged"),et=!0,h.forEach(function(t){var e=h[0];t[st].position="absolute",t[st].boxSizing="border-box",t[st].overflow="hidden",t[st][dt]=Pt(t[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt]-t[rt][lt][dt])+"px",t[st][ct]=Pt(t[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct]-t[rt][lt][ct])+"px",t[st][ft]=Pt(t[rt][at][ft])+"px",t[st][gt]=Pt(t[rt][at][gt])+"px",t[rt][at][ft]===e[rt][at][ft]&&t[rt][at][gt]===e[rt][at][gt]&&t[rt][lt][dt]===e[rt][lt][dt]&&t[rt][lt][pt]===e[rt][lt][pt]&&t[rt][lt][ct]===e[rt][lt][ct]&&t[rt][lt][ht]===e[rt][lt][ht]||(et=!1)}),At(E=V.createElement("ul"===n||"ol"===n?"li":"tr"===n?"td":"tbody"===n||"thead"===n||"tfoot"===n||"table"===n?"tr":"span"),M.options.placeholder||"dnd-sortable-placeholder"),E[st].position="absolute",E[st].display="block",E[st].boxSizing="border-box",E[st].margin="0",J===L&&(J[st].paddingLeft=Pt(J[rt][ot][ft]-J[rt][at][ft])+"px",J[st].paddingTop=Pt(J[rt][ot][gt]-J[rt][at][gt])+"px",J[st].paddingRight="0px",J[st].paddingBottom="0px",J[yt]=J[rt][ot][ct],J[vt]=J[rt][ot][dt]),d?(w(V,"touchmove",i,!1),w(V,"touchend",u,!1),w(V,"touchcancel",u,!1)):(w(V,"mousemove",i,!1),w(V,"mouseup",u,!1)),v=setInterval(m,60),K=O=(d?t.touches[0]:t).clientX,Z=H=(d?t.touches[0]:t).clientY,N=O,G=H,W=U=B=j=0,J.insertBefore(E,C),E[st][ft]=Pt(C[rt][at][ft])+"px",E[st][gt]=Pt(C[rt][at][gt])+"px",E[st][dt]=Pt(C[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt])+"px",E[st][ct]=Pt(C[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct])+"px",St!==A&&(C[st][dt]=Pt(H-G+C[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt]-C[rt][lt][dt])+"px"),_t!==A&&(C[st][ct]=Pt(O-N+C[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct]-C[rt][lt][ct])+"px")}else g();else g()}function i(){r||(n.apply(this,arguments),r=!0,setTimeout(function(){r=!1},60))}function m(){var t,e,n,i,r,a,o,s,l,u,c,h,f,d,p,g,m=0,b=dt,v=gt,y=ct,_=ft,S=0,w=0,x=!1,P=!1;_t===A&&(y=dt,_=gt),n=(e=K)-O,i=(t=Z)-H,j=0===j?n:j,B=0===B?i:B,U=0!=n?Mt(n):0!==j?Mt(j):U,W=0!=i?Mt(i):0!==B?Mt(B):W,O=e,H=t,q=(s=L)?{top:s[vt]-s[rt][ot].top0||0,left:s[yt]-s[rt][ot].left0||0}:{top:0,left:0},St!==A&&(C[rt].r[dt]=H-G+C[rt][at][dt],C[st][dt]=Pt(C[rt].r[dt]-J[rt][at][dt]+J[rt][ot][dt]-C[rt][lt][dt]+q[dt])+"px",P=i*B<0),_t!==A&&(C[rt].r[ct]=O-N+C[rt][at][ct],C[st][ct]=Pt(C[rt].r[ct]-J[rt][at][ct]+J[rt][ot][ct]-C[rt][lt][ct]+q[ct])+"px",x=n*j<0),M.options.autoscroll&&L&&(!Y||x||P)&&(Y&&(clearInterval(Y),Y=null),x=s=I===L?(l=L[rt][at][ft],a=L[rt][at][gt],o=r=0,1.5):(l=L[rt][at][ht],r=L[rt][at][ct],a=L[rt][at][pt],o=L[rt][at][dt],1.2),_t!==A&&(0<U&&L[yt]+L[rt][at][ft]<L[rt][ot][ft]&&C[rt].r[ct]+C[rt].r[ft]>=l||U<0&&0<L[yt]&&C[rt].r[ct]<=r)&&(S=xt.round(U*s*C[rt].r[ft])),St!==A&&(0<W&&L[vt]+L[rt][at][gt]<L[rt][ot][gt]&&C[rt].r[dt]+C[rt].r[gt]>=a||W<0&&0<L[vt]&&C[rt].r[dt]<=o)&&(w=xt.round(W*x*C[rt].r[gt])),S||w)&&(P=xt.abs(S)>xt.abs(w)?S:0,l=xt.abs(w)>=xt.abs(S)?w:0,u=M.options.scrollAnimationMs||0,c=1e3/60,h=L[vt]||0,f=L[yt]||0,d=0,p=P/(u||c),g=l/(u||c),Y=setInterval(function(){d+=c,h+=g*c,f+=p*c,L[vt]=xt.min(xt.max(0,h),L[rt][ot][gt]-L[rt][at][gt]),L[yt]=xt.min(xt.max(0,f),L[rt][ot][ft]-L[rt][at][ft]),Y&&u<=d&&(clearInterval(Y),Y=null)},c)),j=n,B=i,r=C[rt].r[ct]+C[rt].r[ft]/2,s=C[rt].r[dt]+C[rt].r[gt]/2,a=C[rt].r[y],o=function(t){for(var e=1,n=arguments,i=n.length;e<i;++e)t.push.apply(t,n[e]);return t}(kt(V,e,t),_t===A?[]:kt(V,C[rt].r[ct]+2,s),_t===A?[]:kt(V,C[rt].r[ct]+C[rt].r[ft]-2,s),St===A?[]:kt(V,r,C[rt].r[dt]+2),St===A?[]:kt(V,r,C[rt].r[dt]+C[rt].r[gt]-2)).reduce(function(t,e){var n;return e!==C&&e!==E&&e.parentNode===J&&(n=it(C,e,q,X,z),m<n)&&(m=n,t=e),t},null),x=wt===A?(o=!(o=!o&&C!==D&&0<=D[rt][at][y]-q[y]-(a+C[rt][at][_])&&D[rt][at][y]-q[y]-(a+C[rt][at][_])<25&&.7<(m=Dt(C,D,q,b,v))?D:o)&&C!==R&&0<=a-(R[rt][at][y]-q[y]+R[rt][at][_])&&a-(R[rt][at][y]-q[y]+R[rt][at][_])<25&&.7<(m=Dt(C,R,q,b,v))?R:o)?o[rt].index-C[rt].index:xt.abs(W)>=xt.abs(U)?W:U:(!(o=!o&&C!==D&&D[rt][at][y]-q[y]>a+C[rt][at][_]?D:o)&&C!==R&&a>R[rt][at][y]-q[y]+R[rt][at][_]&&(o=R),St===A?U:W),k&&(Q<0&&0<x&&$<.5||0<Q&&x<0&&$<.5||o&&k!==o&&$<m||!it(C,k,q,X,z))&&(Ct(k,M.options.closestItem||"dnd-sortable-closest"),$=0,k=null),!k&&o&&m&&(k=o,Q=0<x?1:-1,$=m,tt=!1),k&&((m=m||it(C,k,q,X,z))?.2<($=m)?(At(k,M.options.closestItem||"dnd-sortable-closest"),.5<m&&!tt&&(N-=C[rt][at][ct],G-=C[rt][at][dt],tt=!0,nt(C,k,Q,M.options.animationMs||0),N+=C[rt][at][ct],G+=C[rt][at][dt])):Ct(k,M.options.closestItem||"dnd-sortable-closest"):(Ct(k,M.options.closestItem||"dnd-sortable-closest"),$=0,k=null))}function u(t){var e=C;a(),g(),_(M.options.onEnd)&&M.options.onEnd(e)}var E,C,c,k,D,R,h,F,I,L,J,N,G,O,H,j,B,U,W,K,Z,q,Q,$,tt,V,n,r,e=!1,f=!1,b=!1,d=!1,v=null,Y=null,et=!1,z=St===A?ft:gt,X=St===A?ct:dt,p=ct===X?ht:pt,g=function(){V=F=h=J=L=I=R=D=k=c=C=E=null,tt=!1,$=0},a=function(){b&&(Y&&(clearInterval(Y),Y=null),d?(o(V,"touchmove",i,!1),o(V,"touchend",u,!1),o(V,"touchcancel",u,!1)):(o(V,"mousemove",i,!1),o(V,"mouseup",u,!1)),v&&(clearInterval(v),v=null),E&&E.parentNode&&(E.parentNode.removeChild(E),E[rt]=null),Ct(J,M.options.activeArea||"dnd-sortable-area"),Ft(J,["width","height","max-width","max-height","box-sizing","padding-left","padding-top","padding-right","padding-bottom"],J[rt].style),k&&Ct(k,M.options.closestItem||"dnd-sortable-closest"),Ct(C,M.options.activeItem||"dnd-sortable-dragged"),h.forEach(function(t){Ft(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[rt]=null}),J[rt]=null,L&&(L[rt]=null),b=!1)},nt=wt===A?function(t,e,n,i){var r,a=e;if(et){if(n<0){for(o=t[mt],T(t,e,n),t[rt].prev.line=t[rt].line,t[rt].prev[dt]=t[rt][at][dt],t[rt].prev[ct]=t[rt][at][ct],t[rt].line=e[rt].line,t[rt][at][dt]=e[rt][at][dt],t[rt][at][ct]=e[rt][at][ct],E[st][dt]=Pt(t[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt])+"px",E[st][ct]=Pt(t[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct])+"px";(r=e[mt])&&r!==o;)e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev.line=e[rt].line,e[rt].prev[dt]=e[rt][at][dt],e[rt].prev[ct]=e[rt][at][ct],e[rt].line=r[rt].line,e[rt][at][dt]=r[rt][at][dt],e[rt][at][ct]=r[rt][at][ct],e[st][dt]=Pt(e[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt]-e[rt][lt][dt])+"px",e[st][ct]=Pt(e[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct]-e[rt][lt][ct])+"px",e=r;e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev.line=e[rt].line,e[rt].prev[dt]=e[rt][at][dt],e[rt].prev[ct]=e[rt][at][ct],e[rt].line=t[rt].prev.line,e[rt][at][dt]=t[rt].prev[dt],e[rt][at][ct]=t[rt].prev[ct],e[st][dt]=Pt(e[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt]-e[rt][lt][dt])+"px",e[st][ct]=Pt(e[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct]-e[rt][lt][ct])+"px"}else if(0<n){for(o=t[mt],T(t,e,n),e=o,(r=t)[rt].prev.line=r[rt].line,r[rt].prev[dt]=r[rt][at][dt],r[rt].prev[ct]=r[rt][at][ct];e[rt].animation&&e[rt].animation.stop(),e[rt].index--,e[rt].prev.line=e[rt].line,e[rt].prev[dt]=e[rt][at][dt],e[rt].prev[ct]=e[rt][at][ct],e[rt].line=r[rt].prev.line,e[rt][at][dt]=r[rt].prev[dt],e[rt][at][ct]=r[rt].prev[ct],e[st][dt]=Pt(e[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt]-e[rt][lt][dt])+"px",e[st][ct]=Pt(e[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct]-e[rt][lt][ct])+"px",(e=(r=e)[mt])&&e!==E;);t[rt].line=r[rt].prev.line,t[rt][at][dt]=r[rt].prev[dt],t[rt][at][ct]=r[rt].prev[ct],E[st][dt]=Pt(t[rt][at][dt]-J[rt][at][dt]+J[rt][ot][dt])+"px",E[st][ct]=Pt(t[rt][at][ct]-J[rt][at][ct]+J[rt][ot][ct])+"px"}}else{n<0?(r=E[bt],o=e[bt]||e,T(t,e,n)):0<n&&(r=t[mt],o=E[bt]||t[mt],T(t,e,n)),function(t,e,n,i){for(t=t[n<0?mt:bt];t;){if(t!==i&&(t[rt].index+=n<0?1:-1),t===e)return;t=t[n<0?mt:bt]}}(t,r,n,E);for(var o,s,l=o=function(t,e){for(var n;(n=t[bt])&&n[rt]&&n[rt].line>=e;)t=n;return t}(o,n=o[rt].line),u=n,c=J,h=t,f=E,d=ct,p=ft,g=ht,m=0;l;)l!==f&&(l[rt]&&l[rt].animation&&l[rt].animation.stop(),s=l[rt][lt][d]+l[rt][at][p]+l[rt][lt][g],0<m&&c[rt][ut][d]+m+s+c[rt][ut][g]>c[rt][at][p]&&(u++,m=0),l[rt].line=u,l[rt].prev[d]=l[rt][at][d],l[rt][at][d]=c[rt][at][d]-c[rt][ot][d]+c[rt][ut][d]+m+l[rt][lt][d],(l===h?f:l)[st][d]=Pt(l[rt][at][d]-c[rt][at][d]+c[rt][ot][d]-(l===h?0:l[rt][lt][d]))+"px",m+=s),l=l[mt];for(var b,v,y,_=o,S=F,w=J,x=t,P=E,M=dt,A=gt,C=pt,n=_,k=_[rt].line,D=0;_;)_!==P&&(b=_[rt].line,y=_[rt][lt][M]+_[rt][at][A]+_[rt][lt][C],D=b===k?xt.max(D,y):(S[b]=S[k]+D,k=b,y)),_=_[mt];for(0<D&&(S[k+1]=S[k]+D),_=n;_;)_!==P&&(v=S[b=_[rt].line],_[rt].prev[M]=_[rt][at][M],"bottom"===_[rt].$.verticalAlign?_[rt][at][M]=w[rt][at][M]-w[rt][ot][M]+S[b+1]-_[rt][at][A]-_[rt][lt][C]:_[rt][at][M]=w[rt][at][M]-w[rt][ot][M]+v+_[rt][lt][M],(_===x?P:_)[st][M]=Pt(_[rt][at][M]-(_===x?0:_[rt][lt][M])-w[rt][at][M]+w[rt][ot][M])+"px"),_=_[mt]}It(a,i,{top:a[rt][at][dt]-a[rt].prev[dt],left:a[rt][at][ct]-a[rt].prev[ct]})}:function(t,e,n,i){var r,a,o=e,s=0,l=0;if(n<0){for(a=t[mt],T(t,e,n),t[rt].prev[X]=t[rt][at][X],l=t[rt][lt][X]-e[rt][lt][X],t[rt][at][X]=e[rt][at][X]+l,E[st][X]=Pt(t[rt][at][X]-J[rt][at][X]+J[rt][ot][X])+"px",s=t[rt][at][z]-e[rt][at][z],l+=t[rt][lt][p]-e[rt][lt][p];(r=e[mt])&&r!==a;)e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev[X]=e[rt][at][X],l+=e[rt][lt][X]-r[rt][lt][X],e[rt][at][X]=r[rt][at][X]+s+l,l+=e[rt][lt][p]-r[rt][lt][p],e[st][X]=Pt(e[rt][at][X]-J[rt][at][X]+J[rt][ot][X]-e[rt][lt][X])+"px",s+=e[rt][at][z]-r[rt][at][z],e=r;e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev[X]=e[rt][at][X],e[rt][at][X]=t[rt].prev[X]+s+l-t[rt][lt][X]+e[rt][lt][X],e[st][X]=Pt(e[rt][at][X]-J[rt][at][X]+J[rt][ot][X]-e[rt][lt][X])+"px"}else if(0<n){for(a=t[mt],T(t,e,n),e=a,s=l=0,(r=t)[rt].prev[X]=r[rt][at][X];e[rt].animation&&e[rt].animation.stop(),e[rt].index--,e[rt].prev[X]=e[rt][at][X],l+=e[rt][lt][X]-r[rt][lt][X],e[rt][at][X]=r[rt].prev[X]+s+l,e[st][X]=Pt(e[rt][at][X]-J[rt][at][X]+J[rt][ot][X]-e[rt][lt][X])+"px",s+=-(r[rt][at][z]-e[rt][at][z]),l+=e[rt][lt][p]-r[rt][lt][p],(e=(r=e)[mt])&&e!==E;);t[rt][at][X]=r[rt].prev[X]+s+l-r[rt][lt][X]+t[rt][lt][X],E[st][X]=Pt(t[rt][at][X]-J[rt][at][X]+J[rt][ot][X])+"px"}(n={})[X]=o[rt][at][X]-o[rt].prev[X],It(o,i,n)},it=wt===A?Lt:Dt;r=!(n=function(t){K=(d?t.touches[0]:t).clientX,Z=(d?t.touches[0]:t).clientY});M.start=M.options.callable?function(){f||(f=!(e=!1),M.handle=t)}:function(){f||(f=!0,e)||(e=!0,w(document,"touchstart",t,{capture:!0,passive:!1}),w(document,"mousedown",t,{capture:!0,passive:!1}))},M.stop=function(){M.handle=null,f=!1,e&&(o(document,"touchstart",t,{capture:!0,passive:!1}),o(document,"mousedown",t,{capture:!0,passive:!1}),e=!1),a(),g()}}function s(t,e){var n=this;if(!(n instanceof s))return new s(t,e);switch(n.options=e||{},(t=Pt(t)).toLowerCase()){case"unrestricted":a(n,wt);break;case"horizontal":a(n,St);break;case"vertical":a(n,_t);break;default:throw new TypeError("AreaSortable invalid sort mode:"+t)}n.start()}return window.Element&&!i.call(window.Element.prototype,rt)&&(window.Element.prototype[rt]=null),s.VERSION="1.2.2",s.prototype={constructor:s,options:null,start:null,handle:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.options=null,t.start=null,t.handle=null,t.stop=null,t}},s});var pngDataTable=void 0,PNG="image/png",JPEG="image/jpeg",b64PhysSignature1="AAlwSFlz",b64PhysSignature2="AAAJcEhZ",b64PhysSignature3="AAAACXBI",_P="p".charCodeAt(0),_H="H".charCodeAt(0),_Y="Y".charCodeAt(0),_S="s".charCodeAt(0);function changeDpiBlob(r,a){var e=r.slice(0,33);return new Promise(function(n,t){var i=new FileReader;i.onload=function(){var t=new Uint8Array(i.result),e=r.slice(33),t=changeDpiOnArray(t,a,r.type);n(new Blob([t,e],{type:r.type}))},i.readAsArrayBuffer(e)})}function changeDpiDataUrl(t,e){for(var n=(t=t.split(","))[0],t=t[1],i=void 0,r=void 0,a=!1,o=(-1!==n.indexOf(PNG)&&(i=PNG,0<=(o=detectPhysChunkFromDataUrl(t))?(r=4*Math.ceil((o+28)/3),a=!0):r=44),-1!==n.indexOf(JPEG)&&(i=JPEG,r=24),t.substring(0,r)),t=t.substring(r),s=atob(o),l=new Uint8Array(s.length),u=0;u<l.length;u++)l[u]=s.charCodeAt(u);return r=changeDpiOnArray(l,e,i,a),[n,",",btoa(String.fromCharCode.apply(String,_toConsumableArray(r))),t].join("")}function detectPhysChunkFromDataUrl(t){var e=t.indexOf(b64PhysSignature1);return-1===(e=-1===e?t.indexOf(b64PhysSignature2):e)?t.indexOf(b64PhysSignature3):e}function searchStartOfPhys(t){for(var e=t.length-1;4<=e;e--)if(9===t[e-4]&&t[e-3]===_P&&t[e-2]===_H&&t[e-1]===_Y&&t[e]===_S)return e-3}function changeDpiOnArray(t,e,n,i){var r;return n===JPEG?(t[13]=1,t[14]=e>>8,t[15]=255&e,t[16]=e>>8,t[17]=255&e,t):n===PNG?(e*=39.3701,(n=new Uint8Array(13))[0]=_P,n[1]=_H,n[2]=_Y,n[3]=_S,n[4]=e>>>24,n[5]=e>>>16,n[6]=e>>>8,n[7]=255&e,n[8]=n[4],n[9]=n[5],n[10]=n[6],n[11]=n[7],n[12]=1,e=calcCrc(n),(r=new Uint8Array(4))[0]=e>>>24,r[1]=e>>>16,r[2]=e>>>8,r[3]=255&e,i?(e=searchStartOfPhys(t),t.set(n,e),t.set(r,e+13),t):((i=new Uint8Array(4))[0]=0,i[1]=0,i[2]=0,i[3]=9,(e=new Uint8Array(54)).set(t,0),e.set(i,33),e.set(n,37),e.set(r,50),e)):void 0}if(!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.download=e()}(this,function(){return function e(t,n,i){function r(t){return String(t)}var a=window,o="application/octet-stream",s=i||o,i=!n&&!i&&t,l=document.createElement("a"),u=a.Blob||a.MozBlob||a.WebKitBlob||r,c=n||"download",u=u.call?u.bind(a):Blob;if("true"===String(this)&&(s=(t=[t,s])[0],t=t[1]),i&&i.length<2048){var h,c=i.split("/").pop().split("?")[0];if(l.href=i,-1!==l.href.indexOf(i))return(h=new XMLHttpRequest).open("GET",i,!0),h.responseType="blob",h.onload=function(t){e(t.target.response,c,o)},setTimeout(function(){h.send()},0),h}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(t)){if(!(2096103.424<t.length&&u!==r))return navigator.msSaveBlob?navigator.msSaveBlob(f(t),c):d(t);s=(t=f(t)).type||o}function f(t){for(var e=(t=t.split(/[:;,]/))[1],n=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),i=n.length,r=0,a=new Uint8Array(i);r<i;++r)a[r]=n.charCodeAt(r);return new u([a],{type:e})}function d(t,e){var n;return"download"in l?(l.href=t,l.setAttribute("download",c),l.className="download-js-link",l.innerHTML="downloading...",l.style.display="none",document.body.appendChild(l),setTimeout(function(){l.click(),document.body.removeChild(l),!0===e&&setTimeout(function(){a.URL.revokeObjectURL(l.href)},250)},66),!0):/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)?(t=t.replace(/^data:([\w\/\-\+]+)/,o),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0):(n=document.createElement("iframe"),document.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,o)),n.src=t,void setTimeout(function(){document.body.removeChild(n)},333))}if(n=t instanceof u?t:new u([t],{type:s}),navigator.msSaveBlob)return navigator.msSaveBlob(n,c);if(a.URL)d(a.URL.createObjectURL(n),!0);else{if("string"==typeof n||n.constructor===r)try{return d("data:"+s+";base64,"+a.btoa(n))}catch(t){return d("data:"+s+","+encodeURIComponent(n))}(i=new FileReader).onload=function(t){d(this.result)},i.readAsDataURL(n)}return!0}}),this.JpegMeta)throw Error("Library included multiple times");var JpegMeta={stringIsClean:function(t){for(var e=0;e<t.length;e++)if(t.charCodeAt(e)<32)return!1;return!0},parseNum:function(t,e,n,i){var r,a,o=">"===t;for(void 0===n&&(n=0),void 0===i&&(i=e.length-n),r=o?n:n+i-1;o?r<n+i:n<=r;o?r++:r--)a=(a<<=8)+e.charCodeAt(r);return a},parseSnum:function(t,e,n,i){var r,a,o,s=">"===t;for(void 0===n&&(n=0),void 0===i&&(i=e.length-n),r=s?n:n+i-1;s?r<n+i:n<=r;s?r++:r--)a=(a<<=8)+((o=void 0===o?128==(128&e.charCodeAt(r)):o)?255&~e.charCodeAt(r):e.charCodeAt(r));return o?-1*(a+1):a},Rational:function(t,e){return this.num=t,this.den=e||1,this}};JpegMeta.Rational.prototype.toString=function(){return 0===this.num||1===this.den?""+this.num:1===this.num?this.num+" / "+this.den:this.num/this.den},JpegMeta.Rational.prototype.asFloat=function(){return this.num/this.den},JpegMeta.MetaGroup=function(t,e){return this.fieldName=t,this.description=e,this.metaProps={},this},JpegMeta.MetaGroup.prototype._addProperty=function(t,e,n){this[(t=new JpegMeta.MetaProp(t,e,n)).fieldName]=t,this.metaProps[t.fieldName]=t},JpegMeta.MetaGroup.prototype.toString=function(){return"[MetaGroup "+this.description+"]"},JpegMeta.MetaProp=function(t,e,n){return this.fieldName=t,this.description=e,this.value=n,this},JpegMeta.MetaProp.prototype.toString=function(){return""+this.value},this.JpegMeta.JpegFile=function(t,e){var n,i,r,a=this._SOS,o=(this.metaGroups={},this._binary_data=t,this.filename=e,0);if(this._binary_data.slice(0,2)!==this._SOI_MARKER)throw new Error("Doesn't look like a JPEG file. First two bytes are "+this._binary_data.charCodeAt(0)+","+this._binary_data.charCodeAt(1)+".");for(o+=2;o<this._binary_data.length&&(r=this._binary_data.charCodeAt(o++),i=this._binary_data.charCodeAt(o++),n=o,r==this._DELIM)&&i!==a;){for(o+=JpegMeta.parseNum(">",this._binary_data,o,2);o<this._binary_data.length;)if(this._binary_data.charCodeAt(o++)==this._DELIM&&0!=this._binary_data.charCodeAt(o++)){o-=2;break}(r=this._markers[i]?(this._markers[i][0],this._markers[i][1]):void 0)&&this[r](i,n+2,o-n-2)}if(void 0===this.general)throw Error("Invalid JPEG file.");return this},this.JpegMeta.JpegFile.prototype.toString=function(){return"[JpegFile "+this.filename+" "+this.general.type+" "+this.general.pixelWidth+"x"+this.general.pixelHeight+" Depth: "+this.general.depth+"]"},this.JpegMeta.JpegFile.prototype._SOI_MARKER="ÿØ",this.JpegMeta.JpegFile.prototype._DELIM=255,this.JpegMeta.JpegFile.prototype._EOI=217,this.JpegMeta.JpegFile.prototype._SOS=218,this.JpegMeta.JpegFile.prototype._sofHandler=function(t,e){if(void 0!==this.general)throw Error("Unexpected multiple-frame image");this._addMetaGroup("general","General"),this.general._addProperty("depth","Depth",JpegMeta.parseNum(">",this._binary_data,e,1)),this.general._addProperty("pixelHeight","Pixel Height",JpegMeta.parseNum(">",this._binary_data,e+1,2)),this.general._addProperty("pixelWidth","Pixel Width",JpegMeta.parseNum(">",this._binary_data,e+3,2)),this.general._addProperty("type","Type",this._markers[t][2])},this.JpegMeta.JpegFile.prototype._commentHandler=function(t,e,n){var i,r;for(n--,i=++e,r="";i<e+n;)r+=String.fromCharCode(this._binary_data.charCodeAt(i)),i++;this._addMetaGroup("comment","Comment"),this.comment._addProperty("comment","Comment",r)},this.JpegMeta.JpegFile.prototype._JFIF_IDENT="JFIF\0",this.JpegMeta.JpegFile.prototype._JFXX_IDENT="JFXX\0",this.JpegMeta.JpegFile.prototype._EXIF_IDENT="Exif\0",this.JpegMeta.JpegFile.prototype._types={1:["BYTE",1],2:["ASCII",1],3:["SHORT",2],4:["LONG",4],5:["RATIONAL",8],6:["SBYTE",1],7:["UNDEFINED",1],8:["SSHORT",2],9:["SLONG",4],10:["SRATIONAL",8],11:["FLOAT",4],12:["DOUBLE",8]},this.JpegMeta.JpegFile.prototype._tifftags={256:["Image width","ImageWidth"],257:["Image height","ImageLength"],258:["Number of bits per component","BitsPerSample"],259:["Compression scheme","Compression",{1:"uncompressed",6:"JPEG compression"}],262:["Pixel composition","PhotmetricInerpretation",{2:"RGB",6:"YCbCr"}],274:["Orientation of image","Orientation",{1:"Normal",2:"Reverse?",3:"Upside-down",4:"Upside-down Reverse",5:"90 degree CW",6:"90 degree CW reverse",7:"90 degree CCW",8:"90 degree CCW reverse"}],277:["Number of components","SamplesPerPixel"],284:["Image data arrangement","PlanarConfiguration",{1:"chunky format",2:"planar format"}],530:["Subsampling ratio of Y to C","YCbCrSubSampling"],531:["Y and C positioning","YCbCrPositioning",{1:"centered",2:"co-sited"}],282:["X Resolution","XResolution"],283:["Y Resolution","YResolution"],296:["Resolution Unit","ResolutionUnit",{2:"inches",3:"centimeters"}],273:["Image data location","StripOffsets"],278:["Number of rows per strip","RowsPerStrip"],279:["Bytes per compressed strip","StripByteCounts"],513:["Offset to JPEG SOI","JPEGInterchangeFormat"],514:["Bytes of JPEG Data","JPEGInterchangeFormatLength"],301:["Transfer function","TransferFunction"],318:["White point chromaticity","WhitePoint"],319:["Chromaticities of primaries","PrimaryChromaticities"],529:["Color space transformation matrix coefficients","YCbCrCoefficients"],532:["Pair of black and white reference values","ReferenceBlackWhite"],306:["Date and time","DateTime"],270:["Image title","ImageDescription"],271:["Make","Make"],272:["Model","Model"],305:["Software","Software"],315:["Person who created the image","Artist"],316:["Host Computer","HostComputer"],33432:["Copyright holder","Copyright"],34665:["Exif tag","ExifIfdPointer"],34853:["GPS tag","GPSInfoIfdPointer"]},this.JpegMeta.JpegFile.prototype._exiftags={36864:["Exif Version","ExifVersion"],40960:["FlashPix Version","FlashpixVersion"],40961:["Color Space","ColorSpace"],37121:["Meaning of each component","ComponentsConfiguration"],37122:["Compressed Bits Per Pixel","CompressedBitsPerPixel"],40962:["Pixel X Dimension","PixelXDimension"],40963:["Pixel Y Dimension","PixelYDimension"],37500:["Manufacturer notes","MakerNote"],37510:["User comments","UserComment"],40964:["Related audio file","RelatedSoundFile"],36867:["Date Time Original","DateTimeOriginal"],36868:["Date Time Digitized","DateTimeDigitized"],37520:["DateTime subseconds","SubSecTime"],37521:["DateTimeOriginal subseconds","SubSecTimeOriginal"],37522:["DateTimeDigitized subseconds","SubSecTimeDigitized"],33434:["Exposure time","ExposureTime"],33437:["FNumber","FNumber"],34850:["Exposure program","ExposureProgram"],34852:["Spectral sensitivity","SpectralSensitivity"],34855:["ISO Speed Ratings","ISOSpeedRatings"],34856:["Optoelectric coefficient","OECF"],37377:["Shutter Speed","ShutterSpeedValue"],37378:["Aperture Value","ApertureValue"],37379:["Brightness","BrightnessValue"],37380:["Exposure Bias Value","ExposureBiasValue"],37381:["Max Aperture Value","MaxApertureValue"],37382:["Subject Distance","SubjectDistance"],37383:["Metering Mode","MeteringMode"],37384:["Light Source","LightSource"],37385:["Flash","Flash"],37386:["Focal Length","FocalLength"],37396:["Subject Area","SubjectArea"],41483:["Flash Energy","FlashEnergy"],41484:["Spatial Frequency Response","SpatialFrequencyResponse"],41486:["Focal Plane X Resolution","FocalPlaneXResolution"],41487:["Focal Plane Y Resolution","FocalPlaneYResolution"],41488:["Focal Plane Resolution Unit","FocalPlaneResolutionUnit"],41492:["Subject Location","SubjectLocation"],41493:["Exposure Index","ExposureIndex"],41495:["Sensing Method","SensingMethod"],41728:["File Source","FileSource"],41729:["Scene Type","SceneType"],41730:["CFA Pattern","CFAPattern"],41985:["Custom Rendered","CustomRendered"],41986:["Exposure Mode","Exposure Mode"],41987:["White Balance","WhiteBalance"],41988:["Digital Zoom Ratio","DigitalZoomRatio"],41989:["Focal length in 35 mm film","FocalLengthIn35mmFilm"],41990:["Scene Capture Type","SceneCaptureType"],41991:["Gain Control","GainControl"],41992:["Contrast","Contrast"],41993:["Saturation","Saturation"],41994:["Sharpness","Sharpness"],41995:["Device settings description","DeviceSettingDescription"],41996:["Subject distance range","SubjectDistanceRange"],42016:["Unique image ID","ImageUniqueID"],40965:["Interoperability tag","InteroperabilityIFDPointer"]},this.JpegMeta.JpegFile.prototype._gpstags={0:["GPS tag version","GPSVersionID"],1:["North or South Latitude","GPSLatitudeRef"],2:["Latitude","GPSLatitude"],3:["East or West Longitude","GPSLongitudeRef"],4:["Longitude","GPSLongitude"],5:["Altitude reference","GPSAltitudeRef"],6:["Altitude","GPSAltitude"],7:["GPS time (atomic clock)","GPSTimeStamp"],8:["GPS satellites usedd for measurement","GPSSatellites"],9:["GPS receiver status","GPSStatus"],10:["GPS mesaurement mode","GPSMeasureMode"],11:["Measurement precision","GPSDOP"],12:["Speed unit","GPSSpeedRef"],13:["Speed of GPS receiver","GPSSpeed"],14:["Reference for direction of movement","GPSTrackRef"],15:["Direction of movement","GPSTrack"],16:["Reference for direction of image","GPSImgDirectionRef"],17:["Direction of image","GPSImgDirection"],18:["Geodetic survey data used","GPSMapDatum"],19:["Reference for latitude of destination","GPSDestLatitudeRef"],20:["Latitude of destination","GPSDestLatitude"],21:["Reference for longitude of destination","GPSDestLongitudeRef"],22:["Longitude of destination","GPSDestLongitude"],23:["Reference for bearing of destination","GPSDestBearingRef"],24:["Bearing of destination","GPSDestBearing"],25:["Reference for distance to destination","GPSDestDistanceRef"],26:["Distance to destination","GPSDestDistance"],27:["Name of GPS processing method","GPSProcessingMethod"],28:["Name of GPS area","GPSAreaInformation"],29:["GPS Date","GPSDateStamp"],30:["GPS differential correction","GPSDifferential"]},this.JpegMeta.JpegFile.prototype._iptctags={0:["Record Version","recordVersion"],3:["Object Type Reference","objectType"],4:["Object Attribute Reference","objectAttribute"],5:["Object Name","objectName"],7:["Edit Status","editStatus"],8:["Editorial Update","editorialUpdate"],10:["Urgency","urgency"],12:["Subject Reference","subjectRef"],15:["Category","category"],20:["Supplemental Category","supplCategory"],22:["Fixture Identifier","fixtureID"],25:["Keywords","keywords"],26:["Content Location Code","contentLocCode"],27:["Content Location Name","contentLocName"],30:["Release Date","releaseDate"],35:["Release Time","releaseTime"],37:["Expiration Date","expirationDate"],38:["Expiration Time","expirationTime"],40:["Special Instructions","specialInstructions"],42:["Action Advised","actionAdvised"],45:["Reference Service","refService"],47:["Reference Date","refDate"],50:["Reference Number","refNumber"],55:["Date Created","dateCreated"],60:["Time Created","timeCreated"],62:["Digital Creation Date","digitalCreationDate"],63:["Digital Creation Time","digitalCreationTime"],65:["Originating Program","originatingProgram"],70:["Program Version","programVersion"],75:["Object Cycle","objectCycle"],80:["By-line","byline"],85:["By-line Title","bylineTitle"],90:["City","city"],92:["Sub-location","sublocation"],95:["Province/State","state"],100:["Country Code","countryCode"],101:["Country Name","countryName"],103:["Original Transmission Reference","origTransRef"],105:["Headline","headline"],110:["Credit","credit"],115:["Source","source"],116:["Copyright Notice","copyrightNotice"],118:["Contact","contact"],120:["Caption/Abstract","caption"],122:["Writer/Editor","writerEditor"],125:["Rasterized Caption","rasterizedCaption"],130:["Image Type","imageType"],131:["Image Orientation","imageOrientation"],135:["Language Identifier","languageID"],150:["Audio Type","audioType"],151:["Audio Sampling Rate","audioSamplingRate"],152:["Audio Sampling Resolution","audioSamplingRes"],153:["Audio Duration","audioDuration"],154:["Audio Outcue","audioOutcue"],200:["Preview File Format","previewFileFormat"],201:["Preview File Format Version","previewFileFormatVer"],202:["Preview Data","previewData"]},this.JpegMeta.JpegFile.prototype._markers={192:["SOF0","_sofHandler","Baseline DCT"],193:["SOF1","_sofHandler","Extended sequential DCT"],194:["SOF2","_sofHandler","Progressive DCT"],195:["SOF3","_sofHandler","Lossless (sequential)"],197:["SOF5","_sofHandler","Differential sequential DCT"],198:["SOF6","_sofHandler","Differential progressive DCT"],199:["SOF7","_sofHandler","Differential lossless (sequential)"],200:["JPG",null,"Reserved for JPEG extensions"],201:["SOF9","_sofHandler","Extended sequential DCT"],202:["SOF10","_sofHandler","Progressive DCT"],203:["SOF11","_sofHandler","Lossless (sequential)"],205:["SOF13","_sofHandler","Differential sequential DCT"],206:["SOF14","_sofHandler","Differential progressive DCT"],207:["SOF15","_sofHandler","Differential lossless (sequential)"],196:["DHT",null,"Define Huffman table(s)"],204:["DAC",null,"Define arithmetic coding conditioning(s)"],208:["RST0",null,"Restart with modulo 8 count �0�"],209:["RST1",null,"Restart with modulo 8 count �1�"],210:["RST2",null,"Restart with modulo 8 count �2�"],211:["RST3",null,"Restart with modulo 8 count �3�"],212:["RST4",null,"Restart with modulo 8 count �4�"],213:["RST5",null,"Restart with modulo 8 count �5�"],214:["RST6",null,"Restart with modulo 8 count �6�"],215:["RST7",null,"Restart with modulo 8 count �7�"],216:["SOI",null,"Start of image"],217:["EOI",null,"End of image"],218:["SOS",null,"Start of scan"],219:["DQT",null,"Define quantization table(s)"],220:["DNL",null,"Define number of lines"],221:["DRI",null,"Define restart interval"],222:["DHP",null,"Define hierarchical progression"],223:["EXP",null,"Expand reference component(s)"],224:["APP0","_app0Handler","Reserved for application segments"],225:["APP1","_app1Handler"],226:["APP2",null],227:["APP3",null],228:["APP4",null],229:["APP5",null],230:["APP6",null],231:["APP7",null],232:["APP8",null],233:["APP9",null],234:["APP10",null],235:["APP11",null],236:["APP12",null],237:["IPTC","_iptcHandler","IPTC Photo Metadata"],238:["APP14",null],239:["APP15",null],240:["JPG0",null],241:["JPG1",null],242:["JPG2",null],243:["JPG3",null],244:["JPG4",null],245:["JPG5",null],246:["JPG6",null],247:["JPG7",null],248:["JPG8",null],249:["JPG9",null],250:["JPG10",null],251:["JPG11",null],252:["JPG12",null],253:["JPG13",null],254:["COM","_commentHandler","Comment"],1:["JPG13",null]},this.JpegMeta.JpegFile.prototype._addMetaGroup=function(t,e){return this[(t=new JpegMeta.MetaGroup(t,e)).fieldName]=t,this.metaGroups[t.fieldName]=t},this.JpegMeta.JpegFile.prototype._parseIfd=function(t,e,n,i,r,a,o){for(var s,l,u,c,h,f,d,p,g,m=JpegMeta.parseNum(t,e,n+i,2),b=this._addMetaGroup(a,o),v=0;v<m;v++)if(l=JpegMeta.parseNum(t,e,s=n+i+2+12*v,2),c=JpegMeta.parseNum(t,e,s+2,2),f=JpegMeta.parseNum(t,e,s+4,4),d=JpegMeta.parseNum(t,e,s+8,4),void 0!==this._types[c]){if(u=this._types[c][0],d=(h=this._types[c][1])*f<=4?s+8:n+d,"UNDEFINED"==u)y=void 0;else if("ASCII"==u)y=(y=e.slice(d,d+f)).split("\0")[0],JpegMeta.stringIsClean(y)||(y="");else{for(var y=new Array,_=0;_<f;_++,d+=h)"BYTE"!=u&&"SHORT"!=u&&"LONG"!=u||y.push(JpegMeta.parseNum(t,e,d,h)),"SBYTE"!=u&&"SSHORT"!=u&&"SLONG"!=u||y.push(JpegMeta.parseSnum(t,e,d,h)),"RATIONAL"==u&&(p=JpegMeta.parseNum(t,e,d,4),g=JpegMeta.parseNum(t,e,d+4,4),y.push(new JpegMeta.Rational(p,g))),"SRATIONAL"==u&&(p=JpegMeta.parseSnum(t,e,d,4),g=JpegMeta.parseSnum(t,e,d+4,4),y.push(new JpegMeta.Rational(p,g))),y.push();1===f&&(y=y[0])}r.hasOwnProperty(l)?b._addProperty(r[l][1],r[l][0],y):console.log("WARNING(jpegmeta.js): Unknown tag: ",l)}},this.JpegMeta.JpegFile.prototype._jfifHandler=function(t,e){if(void 0!==this.jfif)throw Error("Multiple JFIF segments found");this._addMetaGroup("jfif","JFIF"),this.jfif._addProperty("version_major","Version Major",this._binary_data.charCodeAt(e+5)),this.jfif._addProperty("version_minor","Version Minor",this._binary_data.charCodeAt(e+6)),this.jfif._addProperty("version","JFIF Version",this.jfif.version_major.value+"."+this.jfif.version_minor.value),this.jfif._addProperty("units","Density Unit",this._binary_data.charCodeAt(e+7)),this.jfif._addProperty("Xdensity","X density",JpegMeta.parseNum(">",this._binary_data,e+8,2)),this.jfif._addProperty("Ydensity","Y Density",JpegMeta.parseNum(">",this._binary_data,e+10,2)),this.jfif._addProperty("Xthumbnail","X Thumbnail",JpegMeta.parseNum(">",this._binary_data,e+12,1)),this.jfif._addProperty("Ythumbnail","Y Thumbnail",JpegMeta.parseNum(">",this._binary_data,e+13,1))},this.JpegMeta.JpegFile.prototype._app0Handler=function(t,e){this._binary_data.slice(e,e+5)==this._JFIF_IDENT?this._jfifHandler(t,e):this._JFXX_IDENT},this.JpegMeta.JpegFile.prototype._app1Handler=function(t,e){this._binary_data.slice(e,e+5)==this._EXIF_IDENT&&this._exifHandler(t,e+6)},JpegMeta.JpegFile.prototype._exifHandler=function(t,e){if(void 0!==this.exif)throw new Error("Multiple JFIF segments found");var n,i=this._binary_data.slice(e,e+2);if("II"===i)n="<";else{if("MM"!==i)throw new Error("Malformed TIFF meta-data. Unknown endianess: "+i);n=">"}if(42!==(i=JpegMeta.parseNum(n,this._binary_data,e+2,2)))throw new Error("Malformed TIFF meta-data. Bad magic: "+i);i=JpegMeta.parseNum(n,this._binary_data,e+4,4),this._parseIfd(n,this._binary_data,e,i,this._tifftags,"tiff","TIFF"),this.tiff.ExifIfdPointer&&this._parseIfd(n,this._binary_data,e,this.tiff.ExifIfdPointer.value,this._exiftags,"exif","Exif"),this.tiff.GPSInfoIfdPointer&&(this._parseIfd(n,this._binary_data,e,this.tiff.GPSInfoIfdPointer.value,this._gpstags,"gps","GPS"),this.gps.GPSLatitude&&(i=this.gps.GPSLatitude.value[0].asFloat()+1/60*this.gps.GPSLatitude.value[1].asFloat()+1/3600*this.gps.GPSLatitude.value[2].asFloat(),"S"===this.gps.GPSLatitudeRef.value&&(i=-i),this.gps._addProperty("latitude","Dec. Latitude",i)),this.gps.GPSLongitude)&&(n=this.gps.GPSLongitude.value[0].asFloat()+1/60*this.gps.GPSLongitude.value[1].asFloat()+1/3600*this.gps.GPSLongitude.value[2].asFloat(),"W"===this.gps.GPSLongitudeRef.value&&(n=-n),this.gps._addProperty("longitude","Dec. Longitude",n))},this.JpegMeta.JpegFile.prototype._iptcHandler=function(t,e,n){this._addMetaGroup("iptc","IPTC");for(var i,r,a,o=JpegMeta.parseNum("<",this._binary_data,e+4,1),s=0;s<n;s++)if(2==JpegMeta.parseNum("<",this._binary_data,r=e+s,1)&&(a=JpegMeta.parseNum("<",this._binary_data,r+1,1),tag_desc=this._iptctags[a])){for(o=0,i=2;i<n&&28!=JpegMeta.parseNum("<",this._binary_data,r+i,1)&&2!=JpegMeta.parseNum("<",this._binary_data,r+i+1,1);)i++,o++;o&&(a=(a=this._binary_data.slice(e+s+2,e+s+2+o)).replace("\0","").trim(),this.iptc._addProperty(tag_desc[1],tag_desc[0],a),s+=o-1)}},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).tinycolor=e()}(this,function(){"use strict";function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var v=/^\s+/,y=/\s+$/;function _(t,e){var n,i,r,a,o,s,l,u,c,h,f,d,p,g;return e=e||{},(t=t||"")instanceof _?t:this instanceof _?(h={r:0,g:0,b:0},d=null,g=p=!1,f=w("object"==b(n="string"==typeof(n=t)?function(t){t=t.replace(v,"").replace(y,"").toLowerCase();var e,n=!1;if(S[t])t=S[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=F.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=F.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=F.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=F.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=F.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=F.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=F.hex8.exec(t))?{r:M(e[1]),g:M(e[2]),b:M(e[3]),a:D(e[4]),format:n?"name":"hex8"}:(e=F.hex6.exec(t))?{r:M(e[1]),g:M(e[2]),b:M(e[3]),format:n?"name":"hex"}:(e=F.hex4.exec(t))?{r:M(e[1]+""+e[1]),g:M(e[2]+""+e[2]),b:M(e[3]+""+e[3]),a:D(e[4]+""+e[4]),format:n?"name":"hex8"}:!!(e=F.hex3.exec(t))&&{r:M(e[1]+""+e[1]),g:M(e[2]+""+e[2]),b:M(e[3]+""+e[3]),format:n?"name":"hex"}}(n):n)&&(I(n.r)&&I(n.g)&&I(n.b)?(u=n.r,c=n.g,f=n.b,h={r:255*x(u,255),g:255*x(c,255),b:255*x(f,255)},p=!0,g="%"===String(n.r).substr(-1)?"prgb":"rgb"):I(n.h)&&I(n.s)&&I(n.v)?(d=C(n.s),u=C(n.v),f=d,c=6*x(c=n.h,360),f=x(f,100),h={r:255*[u=x(u,100),l=u*(1-(c-=o=Math.floor(c))*f),s=u*(1-f),s,c=u*(1-(1-c)*f),u][f=o%6],g:255*[c,u,u,l,s,s][f],b:255*[s,s,c,u,u,l][f]},p=!0,g="hsv"):I(n.h)&&I(n.s)&&I(n.l)&&(c=d=C(n.s),u=o=C(n.l),s=x(s=n.h,360),c=x(c,100),u=x(u,100),0===c?i=r=a=u:(i=m(c=2*u-(u=u<.5?u*(1+c):u+c-u*c),u,s+1/3),r=m(c,u,s),a=m(c,u,s-1/3)),h={r:255*i,g:255*r,b:255*a},p=!0,g="hsl"),n.hasOwnProperty("a"))?n.a:1),l={ok:p,format:n.format||g,r:Math.min(255,Math.max(h.r,0)),g:Math.min(255,Math.max(h.g,0)),b:Math.min(255,Math.max(h.b,0)),a:f},this._originalInput=t,this._r=l.r,this._g=l.g,this._b=l.b,this._a=l.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||l.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),void(this._ok=l.ok)):new _(t,e);function m(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}function i(t,e,n){t=x(t,255),e=x(e,255),n=x(n,255);var i,r=Math.max(t,e,n),a=Math.min(t,e,n),o=(r+a)/2;if(r==a)i=l=0;else{var s=r-a,l=.5<o?s/(2-r-a):s/(r+a);switch(r){case t:i=(e-n)/s+(e<n?6:0);break;case e:i=(n-t)/s+2;break;case n:i=(t-e)/s+4}i/=6}return{h:i,s:l,l:o}}function r(t,e,n){t=x(t,255),e=x(e,255),n=x(n,255);var i,r=Math.max(t,e,n),a=Math.min(t,e,n),o=r,s=r-a,l=0===r?0:s/r;if(r==a)i=0;else{switch(r){case t:i=(e-n)/s+(e<n?6:0);break;case e:i=(n-t)/s+2;break;case n:i=(t-e)/s+4}i/=6}return{h:i,s:l,v:o}}function e(t,e,n,i){return t=[A(Math.round(t).toString(16)),A(Math.round(e).toString(16)),A(Math.round(n).toString(16))],i&&t[0].charAt(0)==t[0].charAt(1)&&t[1].charAt(0)==t[1].charAt(1)&&t[2].charAt(0)==t[2].charAt(1)?t[0].charAt(0)+t[1].charAt(0)+t[2].charAt(0):t.join("")}function a(t,e,n,i){return[A(k(i)),A(Math.round(t).toString(16)),A(Math.round(e).toString(16)),A(Math.round(n).toString(16))].join("")}function t(t,e){return e=0===e?0:e||10,(t=_(t).toHsl()).s-=e/100,t.s=P(t.s),_(t)}function n(t,e){return e=0===e?0:e||10,(t=_(t).toHsl()).s+=e/100,t.s=P(t.s),_(t)}function o(t){return _(t).desaturate(100)}function s(t,e){return e=0===e?0:e||10,(t=_(t).toHsl()).l+=e/100,t.l=P(t.l),_(t)}function l(t,e){return e=0===e?0:e||10,(t=_(t).toRgb()).r=Math.max(0,Math.min(255,t.r-Math.round(-e/100*255))),t.g=Math.max(0,Math.min(255,t.g-Math.round(-e/100*255))),t.b=Math.max(0,Math.min(255,t.b-Math.round(-e/100*255))),_(t)}function u(t,e){return e=0===e?0:e||10,(t=_(t).toHsl()).l-=e/100,t.l=P(t.l),_(t)}function c(t,e){return e=((t=_(t).toHsl()).h+e)%360,t.h=e<0?360+e:e,_(t)}function h(t){return(t=_(t).toHsl()).h=(t.h+180)%360,_(t)}function f(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=_(t).toHsl(),i=[_(t)],r=360/e,a=1;a<e;a++)i.push(_({h:(n.h+a*r)%360,s:n.s,l:n.l}));return i}function d(t){var e=_(t).toHsl(),n=e.h;return[_(t),_({h:(n+72)%360,s:e.s,l:e.l}),_({h:(n+216)%360,s:e.s,l:e.l})]}function p(t,e,n){e=e||6,n=n||30;var i=_(t).toHsl(),r=360/n,a=[_(t)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,a.push(_(i));return a}function g(t,e){e=e||6;for(var n=(t=_(t).toHsv()).h,i=t.s,r=t.v,a=[],o=1/e;e--;)a.push(_({h:n,s:i,v:r})),r=(r+o)%1;return a}_.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t=(n=this.toRgb()).r/255,e=n.g/255,n=n.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((.055+n)/1.055,2.4))},setAlpha:function(t){return this._a=w(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),t=Math.round(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+t+"%)":"hsva("+e+", "+n+"%, "+t+"%, "+this._roundA+")"},toHsl:function(){var t=i(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=i(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),t=Math.round(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+t+"%)":"hsla("+e+", "+n+"%, "+t+"%, "+this._roundA+")"},toHex:function(t){return e(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){var e=this._r,n=this._g,i=this._b,r=this._a,e=[A(Math.round(e).toString(16)),A(Math.round(n).toString(16)),A(Math.round(i).toString(16)),A(k(r))];return t&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)&&e[3].charAt(0)==e[3].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0)+e[3].charAt(0):e.join("")},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*x(this._r,255))+"%",g:Math.round(100*x(this._g,255))+"%",b:Math.round(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*x(this._r,255))+"%, "+Math.round(100*x(this._g,255))+"%, "+Math.round(100*x(this._b,255))+"%)":"rgba("+Math.round(100*x(this._r,255))+"%, "+Math.round(100*x(this._g,255))+"%, "+Math.round(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(m[e(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+a(this._r,this._g,this._b,this._a),n=e;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+e+",endColorstr="+(t?"#"+a((e=_(t))._r,e._g,e._b,e._a):n)+")"},toString:function(t){var e=!!t,n=(t=t||this._format,!1),i=this._a<1&&0<=this._a;return e||!i||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),(n="hsv"===t?this.toHsvString():n)||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return _(this.toString())},_applyModification:function(t,e){return t=t.apply(null,[this].concat([].slice.call(e))),this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},lighten:function(){return this._applyModification(s,arguments)},brighten:function(){return this._applyModification(l,arguments)},darken:function(){return this._applyModification(u,arguments)},desaturate:function(){return this._applyModification(t,arguments)},saturate:function(){return this._applyModification(n,arguments)},greyscale:function(){return this._applyModification(o,arguments)},spin:function(){return this._applyModification(c,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(p,arguments)},complement:function(){return this._applyCombination(h,arguments)},monochromatic:function(){return this._applyCombination(g,arguments)},splitcomplement:function(){return this._applyCombination(d,arguments)},triad:function(){return this._applyCombination(f,[3])},tetrad:function(){return this._applyCombination(f,[4])}},_.fromRatio=function(t,e){if("object"==b(t)){var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]="a"===n?t[n]:C(t[n]));t=i}return _(t,e)},_.equals=function(t,e){return!(!t||!e)&&_(t).toRgbString()==_(e).toRgbString()},_.random=function(){return _.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},_.mix=function(t,e,n){return n=0===n?0:n||50,t=_(t).toRgb(),e=_(e).toRgb(),_({r:(e.r-t.r)*(n/=100)+t.r,g:(e.g-t.g)*n+t.g,b:(e.b-t.b)*n+t.b,a:(e.a-t.a)*n+t.a})},_.readability=function(t,e){return t=_(t),e=_(e),(Math.max(t.getLuminance(),e.getLuminance())+.05)/(Math.min(t.getLuminance(),e.getLuminance())+.05)},_.isReadable=function(t,e,n){var i=_.readability(t,e),r=!1;switch((n={level:e="AA"!==(e=((t=n||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==e?"AA":e,size:t="small"!==(t=(t.size||"small").toLowerCase())&&"large"!==t?"small":t}).level+n.size){case"AAsmall":case"AAAlarge":r=4.5<=i;break;case"AAlarge":r=3<=i;break;case"AAAsmall":r=7<=i}return r},_.mostReadable=function(t,e,n){for(var i,r=null,a=0,o=(n=n||{}).includeFallbackColors,s=n.level,l=n.size,u=0;u<e.length;u++)(i=_.readability(t,e[u]))>a&&(a=i,r=_(e[u]));return _.isReadable(t,r,{level:s,size:l})||!o?r:(n.includeFallbackColors=!1,_.mostReadable(t,["#fff","#000"],n))};var S=_.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},m=_.hexNames=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}(S);function w(t){return t=parseFloat(t),isNaN(t)||t<0||1<t?1:t}function x(t,e){var n="string"==typeof(t="string"==typeof(n=t)&&-1!=n.indexOf(".")&&1===parseFloat(n)?"100%":t)&&-1!=t.indexOf("%");return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function P(t){return Math.min(1,Math.max(0,t))}function M(t){return parseInt(t,16)}function A(t){return 1==t.length?"0"+t:""+t}function C(t){return t<=1?100*t+"%":t}function k(t){return Math.round(255*parseFloat(t)).toString(16)}function D(t){return M(t)/255}var T,E,R,E="[\\s|\\(]+("+(T="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+T+")[,|\\s]+("+T+")\\s*\\)?",R="[\\s|\\(]+("+T+")[,|\\s]+("+T+")[,|\\s]+("+T+")[,|\\s]+("+T+")\\s*\\)?",F={CSS_UNIT:new RegExp(T),rgb:new RegExp("rgb"+E),rgba:new RegExp("rgba"+R),hsl:new RegExp("hsl"+E),hsla:new RegExp("hsla"+R),hsv:new RegExp("hsv"+E),hsva:new RegExp("hsva"+R),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function I(t){return F.CSS_UNIT.exec(t)}return _}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Picker=e()}(this,function(){"use strict";function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){var n=e,i=[],r=!0,e=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!n||i.length!==n);r=!0);}catch(t){e=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(e)throw a}}return i}throw new TypeError("Invalid attempt to destructure non-iterable instance")}String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var n=this;n.length<t;)n=e+n;return n};var e={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function r(t,e){return(0<(e=1<arguments.length&&void 0!==e?e:1)?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString())||"0"}t(h,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map(function(t,e){return r(t,3===e?3:0)});return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var n=[360,100,100,1],i=["","%","%",""],e=(t?this.hsla:this.hsla.slice(0,3)).map(function(t,e){return r(t*n[e],3===e?3:1)+i[e]});return t?"hsla("+e+")":"hsl("+e+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(this._hsla)return this._rgba=h.hslToRgb(this._hsla);throw new Error("No color is set")},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(this._rgba)return this._hsla=h.rgbToHsl(this._rgba);throw new Error("No color is set")},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map(function(t,e){return(e<3?t:Math.round(255*t)).toString(16)}).map(function(t){return t.padStart(2,"0")}).join("")},set:function(t){this.rgba=h.hexToRgb(t)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(e.match(/^([0-9a-fA-F]{8})$/))return(e=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(t){return parseInt(t,16)}))[3]=e[3]/255,e;throw new Error("Unknown hex color; "+t)}},{key:"nameToRgb",value:function(t){return t=t.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),void 0===(t=e[t])?t:h.hexToRgb(t.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=(t=c(t,4))[0],n=t[1],i=t[2],t=t[3],r=(e/=255,n/=255,i/=255,Math.max(e,n,i)),a=Math.min(e,n,i),o=void 0,s=void 0,l=(r+a)/2;if(r===a)o=s=0;else{var u=r-a,s=.5<l?u/(2-r-a):u/(r+a);switch(r){case e:o=(n-i)/u+(n<i?6:0);break;case n:o=(i-e)/u+2;break;case i:o=(e-n)/u+4}o/=6}return[o,s,l,t]}},{key:"hslToRgb",value:function(t){var e=(t=c(t,4))[0],n=t[1],i=t[2],t=t[3],r=void 0,a=void 0,o=void 0,s=(0===n?r=a=o=i:(r=(s=function(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t})(n=2*i-(i=i<.5?i*(1+n):i+n-i*n),i,e+1/3),a=s(n,i,e),o=s(n,i,e-1/3)),[255*r,255*a,255*o].map(Math.round));return s[3]=t,s}}]);var a=h;function h(t,e,n,i){u(this,h);var r,a,o,s,l;void 0!==t&&(Array.isArray(t)?this.rgba=t:void 0===n?(r=t&&""+t)&&((r=r.toLowerCase()).startsWith("hsl")?(o=r.match(/([\-\d\.e]+)/g).map(Number),s=(o=c(o,4))[0],l=o[1],a=o[2],o=o[3],this.hsla=[s/=360,l/=100,a/=100,o=void 0===o?1:o]):r.startsWith("rgb")?(s=r.match(/([\-\d\.e]+)/g).map(Number),a=(l=c(s,4))[0],o=l[1],s=l[2],l=l[3],this.rgba=[a,o,s,l=void 0===l?1:l]):r.startsWith("#")?this.rgba=h.hexToRgb(r):this.rgba=h.nameToRgb(r)||h.hexToRgb(r)):this.rgba=[t,e,n,void 0===i?1:i])}t(o,[{key:"add",value:function(t,e,n){t.addEventListener(e,n,!1),this._events.push({target:t,type:e,handler:n})}},{key:"remove",value:function(n,i,r){this._events=this._events.filter(function(t){var e=!0;return n&&n!==t.target&&(e=!1),i&&i!==t.type&&(e=!1),(e=(!r||r===t.handler)&&e)&&o._doRemove(t.target,t.type,t.handler),!e})}},{key:"destroy",value:function(){this._events.forEach(function(t){return o._doRemove(t.target,t.type,t.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(t,e,n){t.removeEventListener(e,n,!1)}}]);var n=o;function o(){u(this,o),this._events=[]}function s(t,a,o){var s=!1;function l(t,e,n){return Math.max(e,Math.min(t,n))}function n(t,e,n){var i,r;(s=!!n||s)&&(t.preventDefault(),t=(n=a.getBoundingClientRect()).width,i=n.height,r=e.clientX,e=e.clientY,r=l(r-n.left,0,t),e=l(e-n.top,0,i),console.log(a,i),o(r/t,e/i))}function e(t,e){1===(void 0===t.buttons?t.which:t.buttons)?n(t,t,e):s=!1}function i(t,e){1===t.touches.length?n(t,t.touches[0],e):s=!1}t.add(a,"mousedown",function(t){e(t,!0)}),t.add(a,"touchstart",function(t){i(t,!0)}),t.add(window,"mousemove",e),t.add(a,"touchmove",i),t.add(window,"mouseup",function(t){s=!1}),t.add(a,"touchend",function(t){s=!1}),t.add(a,"touchcancel",function(t){s=!1})}var l="keydown",f="mousedown",d="focusin";function p(t,e){return(e||document).querySelector(t)}function g(t){t.preventDefault(),t.stopPropagation()}function m(t,e,n,i,r){t.add(e,l,function(t){0<=n.indexOf(t.key)&&(r&&g(t),i(t))})}function b(t){u(this,b),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new n,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(t)}return t(b,[{key:"setOptions",value:function(t){var e=this;if(t){var n,i=this.settings;if(t instanceof HTMLElement)i.parent=t;else{i.parent&&t.parent&&i.parent!==t.parent&&(this._events.remove(i.parent),this._popupInited=!1);var r,a,o=t,s=i;for(r in o)s[r]=o[r];t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose),(a=t.color||t.colour)&&this._setColor(a)}(a=i.parent)&&i.popup&&!this._popupInited?(this._events.add(a,"click",n=function(t){return e.openHandler(t)}),m(this._events,a,[" ","Spacebar","Enter"],n),this._popupInited=!0):t.parent&&!i.popup&&this.show()}}},{key:"openHandler",value:function(t){var e;this.show()&&(t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none",e=t&&t.type===l?this._domEdit:this.domElement,setTimeout(function(){return e.focus()},100),this.onOpen)&&this.onOpen(this.colour)}},{key:"closeHandler",value:function(t){var e,n=t&&t.type,i=!1;t?n===f||n===d?(e=(this.__containedEvent||0)+100,t.timeStamp>e&&(i=!0)):(g(t),i=!0):i=!0,i&&this.hide()&&(this.settings.parent.style.pointerEvents="",n!==f&&this.settings.parent.focus(),this.onClose)&&this.onClose(this.colour)}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if(t="string"==typeof t?t.trim():t){e=e||{};var n=void 0;try{n=new a(t)}catch(t){if(e.failSilently)return;throw t}this.settings.alpha||((t=n.hsla)[3]=1,n.hsla=t),this.colour=this.color=n,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){var t,e,n;return!!this.settings.parent&&(this.domElement?(e=this._toggleDOM(!0),this._setPosition(),e):(e=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',(n=document.createElement("div")).innerHTML=e,t=n.firstElementChild,this.domElement=t,this._domH=p(".picker_hue",t),this._domSL=p(".picker_sl",t),this._domA=p(".picker_alpha",t),this._domEdit=p(".picker_editor input",t),this._domSample=p(".picker_sample",t),this._domOkay=p(".picker_done button",t),this._domCancel=p(".picker_cancel button",t),t.classList.add("layout_"+this.settings.layout),this.settings.alpha||t.classList.add("no_alpha"),this.settings.editor||t.classList.add("no_editor"),this.settings.cancelButton||t.classList.add("no_cancel"),this._ifPopup(function(){return t.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0))}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var n=this,i=this,r=this.domElement,a=this._events;function o(t,e,n){a.add(t,e,n)}function t(t){n._ifPopup(function(){return n.closeHandler(t)}),n.onDone&&n.onDone(n.colour)}o(r,"click",function(t){return t.preventDefault()}),s(a,this._domH,function(t,e){i._setHSLA(t)}),s(a,this._domSL,function(t,e){i._setHSLA(null,t,1-e)}),this.settings.alpha&&s(a,this._domA,function(t,e){i._setHSLA(null,null,null,1-e)});var e=this._domEdit;o(e,"input",function(t){i._setColor(this.value,{fromEditor:!0,failSilently:!0})}),o(e,"focus",function(t){this.selectionStart===this.selectionEnd&&this.select()}),this._ifPopup(function(){function t(t){return n.closeHandler(t)}function e(t){n.__containedEvent=t.timeStamp}o(window,f,t),o(window,d,t),m(a,r,["Esc","Escape"],t),o(r,f,e),o(r,d,e),o(n._domCancel,"click",t)}),o(this._domOkay,"click",t),m(a,r,["Enter"],t)}},{key:"_setPosition",value:function(){var n=this.settings.parent,i=this.domElement;n!==i.parentNode&&n.appendChild(i),this._ifPopup(function(t){"static"===getComputedStyle(n).position&&(n.style.position="relative");var e=!0===t?"popup_right":"popup_"+t;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(t){t===e?i.classList.add(t):i.classList.remove(t)}),i.classList.add(e)})}},{key:"_setHSLA",value:function(t,e,n,i,r){r=r||{};var a=this.colour,o=a.hsla;[t,e,n,i].forEach(function(t,e){!t&&0!==t||(o[e]=t)}),a.hsla=o,this._updateUI(r),this.onChange&&!r.silent&&this.onChange(a)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,n=e.hsla,i="hsl("+360*n[0]+", 100%, 50%)",r=e.hslString,a=e.hslaString,o=this._domH,s=this._domSL,l=this._domA,o=p(".picker_selector",o),u=p(".picker_selector",s),l=p(".picker_selector",l);f(0,o,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,f(0,u,n[1]),d(0,u,1-n[2]),s.style.color=r,d(0,l,1-n[3]);i=(o=r).replace("hsl","hsla").replace(")",", 0)");if(this._domA.style.background="linear-gradient("+[o,i]+"), linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",!t.fromEditor){var u=this.settings.editorFormat,c=this.settings.alpha,h=void 0;switch(u){case"rgb":h=e.printRGB(c);break;case"hsl":h=e.printHSL(c);break;default:h=e.printHex(c)}this._domEdit.value=h}this._domSample.style.color=a}function f(t,e,n){e.style.left=100*n+"%"}function d(t,e,n){e.style.top=100*n+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e,n=this.domElement;return!!n&&((e=n.style.display!==(t=t?"":"none"))&&(n.style.display=t),e)}}]),b}),function(){function J(t,e,n){return t.call.apply(t.bind,arguments)}function N(e,n,t){var i;if(e)return 2<arguments.length?(i=Array.prototype.slice.call(arguments,2),function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}):function(){return e.apply(n,arguments)};throw Error()}function p(t,e,n){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?J:N).apply(null,arguments)}var s=Date.now||function(){return+new Date};function G(t,e){this.a=t,this.m=e||t,this.c=this.m.document}var O=!!window.FontFace;function l(t,e,n,i){if(e=t.c.createElement(e),n)for(var r in n)n.hasOwnProperty(r)&&("style"==r?e.style.cssText=n[r]:e.setAttribute(r,n[r]));return i&&e.appendChild(t.c.createTextNode(i)),e}function u(t,e,n){(t=(t=t.c.getElementsByTagName(e)[0])||document.documentElement).insertBefore(n,t.lastChild)}function n(t){t.parentNode&&t.parentNode.removeChild(t)}function g(t,e,n){e=e||[],n=n||[];for(var i=t.className.split(/\s+/),r=0;r<e.length;r+=1){for(var a=!1,o=0;o<i.length;o+=1)if(e[r]===i[o]){a=!0;break}a||i.push(e[r])}for(e=[],r=0;r<i.length;r+=1){for(a=!1,o=0;o<n.length;o+=1)if(i[r]===n[o]){a=!0;break}a||e.push(i[r])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function a(t,e){for(var n=t.className.split(/\s+/),i=0,r=n.length;i<r;i++)if(n[i]==e)return!0;return!1}function P(t){var e;return"string"==typeof t.f?t.f:"https:"==("about:"==(e=t.m.location.protocol)?t.a.location.protocol:e)?"https:":"http:"}function M(t,e,n){function i(){o&&r&&(o(a),o=null)}e=l(t,"link",{rel:"stylesheet",href:e,media:"all"});var r=!1,a=null,o=n||null;O?(e.onload=function(){r=!0,i()},e.onerror=function(){r=!0,a=Error("Stylesheet failed to load"),i()}):setTimeout(function(){r=!0,i()},0),u(t,"head",e)}function i(t,e,n,i){var r,a,o=t.c.getElementsByTagName("head")[0];return o?(r=l(t,"script",{src:e}),a=!1,r.onload=r.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,n&&n(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&o.removeChild(r))},o.appendChild(r),setTimeout(function(){a||(a=!0,n&&n(Error("Script load timeout")))},i||5e3),r):null}function A(){this.a=0,this.c=null}function C(t){return t.a++,function(){t.a--,r(t)}}function k(t,e){t.c=e,r(t)}function r(t){0==t.a&&t.c&&(t.c(),t.c=null)}function o(t){this.a=t||"-"}function D(t,e){this.c=t,this.f=4,this.a="n",(t=(e||"n4").match(/^([nio])([1-9])$/i))&&(this.a=t[1],this.f=parseInt(t[2],10))}function c(t){var e=[];t=t.split(/,\s*/);for(var n=0;n<t.length;n++){var i=t[n].replace(/['"]/g,"");-1!=i.indexOf(" ")||/^\d/.test(i)?e.push("'"+i+"'"):e.push(i)}return e.join(",")}function m(t){return t.a+t.f}function h(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function H(t,e){this.c=t,this.f=t.m.document.documentElement,this.h=e,this.a=new o("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function b(t){var e,n,i;t.g&&(e=a(t.f,t.a.c("wf","active")),n=[],i=[t.a.c("wf","loading")],e||n.push(t.a.c("wf","inactive")),g(t.f,n,i)),v(t,"inactive")}function v(t,e,n){t.j&&t.h[e]&&(n?t.h[e](n.c,m(n)):t.h[e]())}function j(){this.c={}}function f(t,e){this.c=t,this.f=e,this.a=l(this.c,"span",{"aria-hidden":"true"},this.f)}function d(t){u(t.c,"body",t.a)}function y(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+c(t.c)+";font-style:"+h(t)+";font-weight:"+t.f+"00;"}function _(t,e,n,i,r,a){this.g=t,this.j=e,this.a=i,this.c=n,this.f=r||3e3,this.h=a||void 0}function S(t,e,n,i,r,a,o){this.v=t,this.B=e,this.c=n,this.a=i,this.s=o||"BESbswy",this.f={},this.w=r||3e3,this.u=a||null,this.o=this.j=this.h=this.g=null,this.g=new f(this.c,this.s),this.h=new f(this.c,this.s),this.j=new f(this.c,this.s),this.o=new f(this.c,this.s),t=y(t=new D(this.a.c+",serif",m(this.a))),this.g.a.style.cssText=t,t=y(t=new D(this.a.c+",sans-serif",m(this.a))),this.h.a.style.cssText=t,t=y(t=new D("serif",m(this.a))),this.j.a.style.cssText=t,t=y(t=new D("sans-serif",m(this.a))),this.o.a.style.cssText=t,d(this.g),d(this.h),d(this.j),d(this.o)}o.prototype.c=function(t){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},_.prototype.start=function(){var r=this.c.m.document,a=this,o=s(),t=new Promise(function(n,i){!function e(){var t;s()-o>=a.f?i():r.fonts.load(h(t=a.a)+" "+t.f+"00 300px "+c(t.c),a.h).then(function(t){1<=t.length?n():setTimeout(e,25)},function(){i()})}()}),e=new Promise(function(t,e){setTimeout(e,a.f)});Promise.race([e,t]).then(function(){a.g(a.a)},function(){a.j(a.a)})};var w={D:"serif",C:"sans-serif"},e=null;function x(){var t;return null===e&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),e=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)),e}function T(t,e,n){for(var i in w)if(w.hasOwnProperty(i)&&e===t.f[w[i]]&&n===t.f[w[i]])return 1}function E(t,e){setTimeout(p(function(){n(this.g.a),n(this.h.a),n(this.j.a),n(this.o.a),e(this.a)},t),0)}function R(t,e,n){this.c=t,this.a=e,this.f=0,this.o=this.j=!1,this.s=n}S.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.o.a.offsetWidth,this.A=s(),function t(e){var n=e.g.a.offsetWidth,i=e.h.a.offsetWidth;n===e.f.serif&&i===e.f["sans-serif"]||x()&&T(e,n,i)?s()-e.A>=e.w?x()&&T(e,n,i)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?E(e,e.v):E(e,e.B):setTimeout(p(function(){t(this)},e),50):E(e,e.v)}(this)};var F=null;function I(t){0==--t.f&&t.j&&(t.o?((t=t.a).g&&g(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),v(t,"active")):b(t.a))}function B(t){this.j=t,this.a=new j,this.h=0,this.f=this.g=!0}function U(t,e){this.c=t,this.a=e}function W(t,e){this.c=t,this.a=e}function q(t,e,n){this.c=t||e+"//fonts.googleapis.com/css",this.a=[],this.f=[],this.g=n||""}function $(t){this.f=t,this.a=[],this.c={}}R.prototype.g=function(t){var e=this.a;e.g&&g(e.f,[e.a.c("wf",t.c,m(t).toString(),"active")],[e.a.c("wf",t.c,m(t).toString(),"loading"),e.a.c("wf",t.c,m(t).toString(),"inactive")]),v(e,"fontactive",t),this.o=!0,I(this)},R.prototype.h=function(t){var e,n,i,r=this.a;r.g&&(e=a(r.f,r.a.c("wf",t.c,m(t).toString(),"active")),n=[],i=[r.a.c("wf",t.c,m(t).toString(),"loading")],e||n.push(r.a.c("wf",t.c,m(t).toString(),"inactive")),g(r.f,n,i)),v(r,"fontinactive",t),I(this)},B.prototype.load=function(t){this.c=new G(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes;var e,i=this,n=new H(this.c,t),r=t,a=[],t=r.timeout,a=((e=n).g&&g(e.f,[e.a.c("wf","loading")]),v(e,"loading"),function(t,e,n){var i,r,a=[];for(i in e)e.hasOwnProperty(i)&&(r=t.c[i])&&a.push(r(e[i],n));return a}(i.a,r,i.c)),o=new R(i.c,n,t);for(i.h=a.length,n=0,r=a.length;n<r;n++)a[n].load(function(t,e,n){var u=o,c=t,h=e,f=n,d=0==--(t=i).h;(t.f||t.g)&&setTimeout(function(){var t=f||null,e=h||{};if(0===c.length&&d)b(u.a);else{u.f+=c.length,d&&(u.j=d);for(var n=[],i=0;i<c.length;i++){var r,a=c[i],o=e[a.c],s=u.a,l=a;s.g&&g(s.f,[s.a.c("wf",l.c,m(l).toString(),"loading")]),v(s,"fontloading",l),s=(F=(s=null)===F?!!window.FontFace&&(l=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),r=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor),l?42<parseInt(l[1],10):!r):F)?new _(p(u.g,u),p(u.h,u),u.c,a,u.s,o):new S(p(u.g,u),p(u.h,u),u.c,a,u.s,t,o),n.push(s)}for(i=0;i<n.length;i++)n[i].start()}},0)})},U.prototype.load=function(o){var s,t,e=this,l=e.a.projectId,n=e.a.version;l?(s=e.c.m,i(this.c,(t=l,P(e.c)+"//"+(e.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"")+"/"+t+".js"+(n?"?v="+n:"")),function(t){t?o([]):(s["__MonotypeConfiguration__"+l]=function(){return e.a},function t(){if(s["__mti_fntLst"+l]){var e,n=s["__mti_fntLst"+l](),i=[];if(n)for(var r=0;r<n.length;r++){var a=n[r].fontfamily;null!=n[r].fontStyle&&null!=n[r].fontWeight?(e=n[r].fontStyle+n[r].fontWeight,i.push(new D(a,e))):i.push(new D(a))}o(i)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+l):o([])},W.prototype.load=function(t){for(var e=this.a.urls||[],n=this.a.families||[],i=this.a.testStrings||{},r=new A,a=0,o=e.length;a<o;a++)M(this.c,e[a],C(r));for(var s=[],a=0,o=n.length;a<o;a++)if((e=n[a].split(":"))[1])for(var l=e[1].split(","),u=0;u<l.length;u+=1)s.push(new D(e[0],l[u]));else s.push(new D(e[0]));k(r,function(){t(s,i)})};var V={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},Y={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},z={i:"i",italic:"i",n:"n",normal:"n"},X=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function K(t,e){this.c=t,this.a=e}var Z={Arimo:!0,Cousine:!0,Tinos:!0};function Q(t,e){this.c=t,this.a=e}function tt(t,e){this.c=t,this.f=e,this.a=[]}K.prototype.load=function(t){for(var e=new A,n=this.c,i=new q(this.a.api,P(n),this.a.text),r=this.a.families,a=i,o=r,s=o.length,l=0;l<s;l++){var u=o[l].split(":"),c=(3==u.length&&a.f.push(u.pop()),"");2==u.length&&""!=u[1]&&(c=":"),a.a.push(u.join(c))}for(var h=new $(r),f=h,d=f.f.length,p=0;p<d;p++){var g=f.f[p].split(":"),m=g[0].replace(/\+/g," "),b=["n4"];if(2<=g.length){var v,y,_=g[1],S=[];if(_)for(var w=(_=_.split(",")).length,x=0;x<w;x++)(y=(y=_[x]).match(/^[\w-]+$/)&&null!=(v=X.exec(y.toLowerCase()))?[y=null==(y=v[2])||""==y?"n":z[y],v=null==(v=v[1])||""==v?"4":Y[v]||(isNaN(v)?"4":v.substr(0,1))].join(""):"")&&S.push(y);0<S.length&&(b=S),3==g.length&&(S=[],0<(g=(g=g[2])?g.split(","):S).length)&&(g=V[g[0]])&&(f.c[m]=g)}for(f.c[m]||(g=V[m])&&(f.c[m]=g),g=0;g<b.length;g+=1)f.a.push(new D(m,b[g]))}M(n,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,n=[],i=0;i<e;i++)n.push(t.a[i].replace(/ /g,"+"));return e=t.c+"?family="+n.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(i),C(e)),k(e,function(){t(h.a,h.c,Z)})},Q.prototype.load=function(o){var t=this.a.id,s=this.c.m;t?i(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)o([]);else if(s.Typekit&&s.Typekit.config&&s.Typekit.config.fn){t=s.Typekit.config.fn;for(var e=[],n=0;n<t.length;n+=2)for(var i=t[n],r=t[n+1],a=0;a<r.length;a++)e.push(new D(i,r[a]));try{s.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}o(e)}},2e3):o([])},tt.prototype.load=function(l){var t=this.f.id,e=this.c.m,u=this;t?(e.__webfontfontdeckmodule__||(e.__webfontfontdeckmodule__={}),e.__webfontfontdeckmodule__[t]=function(t,e){for(var n,i,r,a=0,o=e.fonts.length;a<o;++a){var s=e.fonts[a];u.a.push(new D(s.name,(r=i=n=void 0,n=4,i="n",r=null,(s="font-weight:"+s.weight+";font-style:"+s.style)&&((r=s.match(/(normal|oblique|italic)/i))&&r[1]&&(i=r[1].substr(0,1).toLowerCase()),r=s.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?n=7:/[1-9]00/.test(r[1])&&(n=parseInt(r[1].substr(0,1),10))),i+n)))}l(u.a)},i(this.c,P(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+((e=this.c).m.location.hostname||e.a.location.hostname)+"/"+t+".js",function(t){t&&l([])})):l([])};var t=new B(window),L=(t.a.c.custom=function(t,e){return new W(e,t)},t.a.c.fontdeck=function(t,e){return new tt(e,t)},t.a.c.monotype=function(t,e){return new U(e,t)},t.a.c.typekit=function(t,e){return new Q(e,t)},t.a.c.google=function(t,e){return new K(e,t)},{load:p(t.load,t)});"function"==typeof define&&define.amd?define(function(){return L}):"undefined"!=typeof module&&module.exports?module.exports=L:(window.WebFont=L,window.WebFontConfig&&t.load(window.WebFontConfig))}();
(()=>{var i={423:()=>{var t,i;fabric.Canvas.prototype.initialize=(t=fabric.Canvas.prototype.initialize,function(...e){return t.call(this,...e),this._historyInit(),this}),fabric.Canvas.prototype.dispose=(i=fabric.Canvas.prototype.dispose,function(...e){return i.call(this,...e),this._historyDispose(),this}),fabric.Canvas.prototype._historyNext=function(){return JSON.stringify(this.toDatalessJSON(this.extraProps))},fabric.Canvas.prototype._historyEvents=function(){return{"object:added":this._historySaveAction,"object:removed":this._historySaveAction,"object:modified":this._historySaveAction,"object:skewing":this._historySaveAction}},fabric.Canvas.prototype._historyInit=function(){this.historyUndo=[],this.historyRedo=[],this.extraProps=["selectable","editable"],this.historyNextState=this._historyNext(),this.on(this._historyEvents())},fabric.Canvas.prototype._historyDispose=function(){this.off(this._historyEvents())},fabric.Canvas.prototype._historySaveAction=function(){var e;this.historyProcessing||(e=this.historyNextState,this.historyUndo.push(e),this.historyNextState=this._historyNext(),this.fire("history:append",{json:e}))},fabric.Canvas.prototype.undo=function(e){this.historyProcessing=!0;var t=this.historyUndo.pop();t?(this.historyRedo.push(this._historyNext()),this.historyNextState=t,this._loadHistory(t,"history:undo",e)):this.historyProcessing=!1},fabric.Canvas.prototype.redo=function(e){this.historyProcessing=!0;var t=this.historyRedo.pop();t?(this.historyUndo.push(this._historyNext()),this.historyNextState=t,this._loadHistory(t,"history:redo",e)):this.historyProcessing=!1},fabric.Canvas.prototype._loadHistory=function(e,t,i){var s=this;this.loadFromJSON(e,function(){s.renderAll(),s.fire(t),s.historyProcessing=!1,i&&"function"==typeof i&&i()})},fabric.Canvas.prototype.clearHistory=function(){this.historyUndo=[],this.historyRedo=[],this.fire("history:clear")},fabric.Canvas.prototype.onHistory=function(){this.historyProcessing=!1,this._historySaveAction()},fabric.Canvas.prototype.offHistory=function(){this.historyProcessing=!0}},561:()=>{class e extends HTMLElement{constructor(){super()}connectedCallback(){}}customElements.define("fpd-actions-bar",e)}},s={};function ee(e){var t=s[e];return void 0!==t||(t=s[e]={exports:{}},i[e](t,t.exports,ee)),t.exports}(()=>{"use strict";const d=(e="",t=!1,i="",s=document.body)=>{s===document.body&&s.classList.add("fpd-overflow-hidden"),"prompt"===i?e=`
            <input type="text" placeholder="${e}" />
            <span class="fpd-btn"></span>
        `:"confirm"===i&&(e=`
            <div class="fpd-confirm-msg">${e}</div>
            <span class="fpd-btn fpd-confirm"></span>
        `);e=`
        <div class="fpd-modal-wrapper fpd-shadow-3">
            <div class="fpd-modal-close">
                <span class="fpd-icon-close"></span>
            </div>
            <div class="fpd-modal-content">${e}</div>
        </div>
    `;const n=document.createElement("div");return n.className="fpd-modal-internal fpd-modal-overlay "+(t?"fpd-fullscreen":""),n.innerHTML=e,n.dataset.type=i,s.append(n),c(n.querySelector(".fpd-modal-close"),["click"],e=>{n.remove()}),n},n=e=>"[object Object]"===Object.prototype.toString.call(e),p=(e,t)=>{var i={...e,...t};if(Object.keys(t).length)for(const s of Object.keys(i))n(i[s])&&e[s]&&t[s]&&(i[s]=p(e[s],t[s]));return i},l=e=>/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e),h=e=>0===e||"string"==typeof e&&"0"===e,c=(e,t=[],i=()=>{})=>{(t="string"==typeof t?[t]:t).forEach(t=>{!(e instanceof HTMLElement)&&Array.from(e).length?e.forEach(e=>{e.addEventListener(t,i)}):e.addEventListener(t,i)})},r=(t=[],e=[])=>(t&&(t instanceof HTMLElement?e.forEach(e=>{t.classList.add(e)}):t.forEach(t=>{e.forEach(e=>{t.classList.add(e)})})),t),u=(t=[],e=[])=>(t&&(t instanceof HTMLElement?e.forEach(e=>{t.classList.remove(e)}):t.forEach(t=>{e.forEach(e=>{t.classList.remove(e)})})),t),m=(t=[],e=[],i=!0)=>(t&&(t instanceof HTMLElement?e.forEach(e=>{t.classList.toggle(e,i)}):t.forEach(t=>{e.forEach(e=>{t.classList.toggle(e,i)})})),t),g=e=>void 0===e||null==e||("string"==typeof e?!e.trim().length:Array.isArray(e)?!e.length:"object"==typeof e&&!Object.keys(e).length),o=()=>{var t=!0;try{window.localStorage.length,window.localStorage.setItem("fpd-storage","just-testing")}catch(e){t=!1}return t},s=(e={})=>{if(e.url){var t=document.createElement("div");t.className="fpd-item",t.dataset.source=e.url,e.title&&(t.dataset.title=e.title);const i=document.createElement("picture");if(i.dataset.img=e.thumbnailUrl||e.url,t.append(i),e.price){const i=document.createElement("span");i.className="fpd-price",i.innerHTML=e.price,t.append(i)}if(e.removable){const e=document.createElement("span");e.className="fpd-delete fpd-icon-remove",t.append(e)}return t}};class a{static defaults={imageLoadTimestamp:!1,stageWidth:900,stageHeight:600,editorMode:!1,editorBoxParameters:["left","top","angle","fill","width","height","fontSize","price"],fonts:[{name:"Arial"},{name:"Lobster",url:"google"}],facebookAppId:"",instagramClientId:"",instagramRedirectUri:"",instagramTokenUri:"",zoomStep:.2,maxZoom:3,hexNames:{},selectedColor:"#f5f5f5",boundingBoxColor:"#2185d0",outOfBoundaryColor:"#990000",replaceInitialElements:!1,customImageAjaxSettings:{url:"php/custom-image-handler.php",data:{saveOnServer:0,uploadsDir:"./uploads",uploadsDirURL:"http://yourdomain.com/uploads"}},improvedResizeQuality:!1,responsive:!0,cornerIconColor:"#000000",langJSON:"lang/default.json",colorPickerPalette:[],actions:{top:[],right:[],bottom:[],left:[]},mainBarModules:["products","images","text","designs","manage-layers"],initialActiveModule:"",maxValues:{},watermark:!1,priceFormat:{currency:"&#36;%d",decimalSep:".",thousandSep:","},mainBarContainer:!1,modalMode:!1,keyboardControl:!0,deselectActiveOnOutside:!0,uploadZonesTopped:!0,loadFirstProductInStage:!0,unsavedProductAlert:!1,hideDialogOnAdd:!0,toolbarPlacement:"smart",snapGridSize:[50,50],fabricCanvasOptions:{},namesNumbersDropdown:[],namesNumbersEntryPrice:0,colorSelectionPlacement:"",colorSelectionDisplayType:"grid",bulkVariationsPlacement:"",bulkVariations:{},toolbarDynamicContext:"body",boundingBoxProps:{strokeWidth:1},fitImagesInCanvas:!1,maxPrice:-1,inCanvasTextEditing:!0,openTextInputOnSelect:!1,designCategories:[],optionalView:!1,saveActionBrowserStorage:!0,pricingRules:[],uploadAgreementModal:!1,imageEditorSettings:{masks:[]},printingBox:null,printingBox:{},autoOpenInfo:!1,guidedTour:null,replaceColorsInColorGroup:!1,allowedImageTypes:["jpeg","png","svg","pdf"],pixabayApiKey:"",pixabayHighResImages:!1,pixabayLang:"en",openModalInDesigner:!1,imageSizeTooltip:!1,highlightEditableObjects:"",applyFillWhenReplacing:!0,layouts:[],dynamicViewsOptions:{unit:"mm",formats:[],pricePerArea:0,minWidth:0,minHeight:0,maxWidth:1e4,maxHeight:1e4},disableTextEmojis:!1,smartGuides:!1,usePrintingBoxAsBounding:!1,productsJSON:null,designsJSON:null,customizationRequiredRule:"any",swapProductConfirmation:!1,setTextboxWidth:!1,textLinkGroupProps:[],textTemplates:[],multiSelection:!1,maxCanvasHeight:.8,mobileGesturesBehaviour:"none",imageQualityRatings:null,splitMultiSVG:!1,cornerControlsStyle:"advanced",downloadFilename:"Product",autoFillUploadZones:!1,dragDropImagesToUploadZones:!1,responsiveBreakpoints:{small:768,medium:1024},dynamicDesigns:{},elementParameters:{objectCaching:!1,z:-1,price:0,colors:!1,removable:!1,draggable:!1,rotatable:!1,resizable:!1,copyable:!1,zChangeable:!1,boundingBox:!1,boundingBoxMode:"clipping",autoCenter:!1,replace:"",replaceInAllViews:!1,autoSelect:!1,topped:!1,colorPrices:{},colorLinkGroup:!1,patterns:[],sku:"",excludeFromExport:!1,showInColorSelection:!1,locked:!1,uniScalingUnlockable:!1,fixed:!1,originX:"center",originY:"center",cornerSize:24,fill:!1,lockUniScaling:!0,pattern:!1,top:0,left:0,angle:0,flipX:!1,flipY:!1,opacity:1,scaleX:1,scaleY:1},textParameters:{maxLength:0,curved:!1,curvable:!1,curveSpacing:10,curveRadius:80,curveReverse:!1,maxLines:0,textBox:!1,textPlaceholder:!1,numberPlaceholder:!1,letterSpacing:0,chargeAfterEditing:!1,minFontSize:1,textTransform:"none",widthFontSize:0,maxFontSize:200,shadowColor:"",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textLinkGroup:"",strokeColors:[],editable:!0,fontFamily:"Arial",fontSize:18,lineHeight:1,fontWeight:"normal",fontStyle:"normal",textDecoration:"normal",padding:10,textAlign:"left",stroke:null,strokeWidth:0,charSpacing:0},imageParameters:{uploadZone:!1,filter:null,scaleMode:"fit",resizeToW:0,resizeToH:0,advancedEditing:!1,uploadZoneMovable:!1,uploadZoneRemovable:!1,padding:0,minScaleLimit:.01},customImageParameters:{minW:100,minH:100,maxW:1500,maxH:1500,minDPI:72,maxSize:10},customTextParameters:{},customAdds:{designs:!0,uploads:!0,texts:!0,drawing:!0},qrCodeProps:{autoCenter:!0,draggable:!0,removable:!0,resizable:!0}};static merge(e={},t={}){return p(e,t)}static getParameterKeys(){var e=Object.keys(this.defaults.elementParameters),t=Object.keys(this.defaults.imageParameters),i=Object.keys(this.defaults.textParameters);return(e=e.concat(t)).concat(i)}}window.FPDOptions=a,ee(423);const f=e=>"text"===e||"i-text"===e||"curvedText"===e||"textbox"===e?"text":"image",v=e=>null!==e&&("group"===e.type||void 0!==e.d||e.source&&e.source.split(".").includes("svg")),y=(e,t,i,s,n="fit")=>{var a=1,o=0!==(i="number"!=typeof i?0:i),r=0!==(s="number"!=typeof s?0:s),a="cover"===n?i-e<s-t?o?Math.max(i/e,s/t):1:r?Math.max(i/e,s/t):1:t<e?o?Math.min(i/e,s/t):1:r?Math.min(i/e,s/t):1;return parseFloat(a.toFixed(10))},b=e=>e&&("object"==typeof e.colors||!0===e.colors||1==e.colors||e.removable||e.draggable||e.resizable||e.rotatable||e.zChangeable||e.advancedEditing||e.editable||e.uploadZone||e.colorLinkGroup&&0<e.colorLinkGroup.length||e.__editorMode);class x extends EventTarget{fabricOptions={};options={};canvasElem=null;fabricCanvas=null;elements=[];initialElementsLoaded=!1;undos=[];redos=[];responsiveScale=1;isCustomized=!1;constructor(e,t={},i={}){super(),this.fabricOptions=t,this.options=i,this.canvasElem=document.createElement("canvas"),e.append(this.canvasElem),this.fabricCanvas=new fabric.Canvas(this.canvasElem,t),this.fabricCanvas.setDimensions({width:this.options.stageWidth,height:this.options.stageHeight})}addElements(i,e){let t=0;const s=()=>{if(++t<i.length){const e=i[t];n(e)||this.addElement(e.type,e.source,e.title,e.parameters)}else this.undos=[],this.redos=[],this.dispatchEvent(new CustomEvent("undoRedoSet")),this.removeEventListener("elementAdd",s),void 0!==e&&e.call(e,this),this.initialElementsLoaded=!0},n=e=>{if(void 0===e.type||void 0===e.source||void 0===e.title){var t=i.indexOf(e);if(-1!==t)return console.log("Element index "+t+" from elements removed, its not a valid element object!","info"),s(),!0}else this.elements.push(e);return!1};var a=i[0];a?(c(this,"elementAdd",s),n(a)||this.addElement(a.type,a.source,a.title,a.parameters)):(void 0!==e&&e.call(e,instance),this.initialElementsLoaded=!0)}addElement(a,s,e,o={}){if(void 0!==a&&void 0!==s&&void 0!==e){var t;this.dispatchEvent(new CustomEvent("beforeElementAdd",{detail:{type:a,source:s,title:e,params:o}})),"text"===a&&(s=(s=s.replace(/(<([^>]+)>)/gi,"")).replace(FancyProductDesigner.forbiddenTextChars,""),e=e.replace(/(<([^>]+)>)/gi,"")),"string"==typeof o.fill||Array.isArray(o.fill)||(o.fill=!1),r="text"===f(a)?p(this.options.elementParameters,this.options.textParameters):p(this.options.elementParameters,this.options.imageParameters),(o=p(r,o)).colors&&"string"==typeof o.colors&&0==o.colors.indexOf("#")&&(r=o.colors.replace(/\s+/g,"").split(","),o.colors=r),o._isInitial=!this.initialElementsLoaded,"text"===f(a)&&(r=o.colors[0]||"#000000",o.fill=o.fill||r);let n={source:s,title:e,id:String((new Date).getTime()),cornerColor:this.options.selectedColor,cornerIconColor:this.options.cornerIconColor};if(this.options.editorMode?(o.__editorMode=this.options.editorMode,n.selectable=n.evented=!0):n=p(n,{selectable:!1,lockRotation:!0,hasRotatingPoint:!1,lockScalingX:!0,lockScalingY:!0,lockMovementX:!0,lockMovementY:!0,hasControls:!1,evented:!1,lockScalingFlip:!0}),(n=p(o,n)).isCustom&&(this.isCustomized=!0),this.options.usePrintingBoxAsBounding&&!n.boundingBox&&((t,i)=>{if(t&&"object"==typeof t){let e=!0;for(var s=0;s<i.length;++s)if(!t.hasOwnProperty(i[s])){e=!1;break}return e}return!1})(this.options.printingBox,["left","top","width","height"])&&(n.boundingBox={x:this.options.printingBox.left-1,y:this.options.printingBox.top-1,width:this.options.printingBox.width+1,height:this.options.printingBox.height+1}),"image"==a||"path"==a||"group"==a){n.crossOrigin="",n.lockUniScaling=!this.options.editorMode&&!n.uniScalingUnlockable,-1===s.search("<svg ")&&(r=s.split("?"),s=n.source=r[0]);const a=(e,t,i,s={})=>{e?(t.originParams=p(t,s),e.setOptions(t),this.fabricCanvas.add(e),this.setElementParameters(t,e,!1),e.originParams.angle=e.angle,e.originParams.z=this.getZIndex(e),e._isInitial||e._ignore||this.#e({element:e,parameters:t,interaction:"add"})):this.dispatchEvent(new CustomEvent("imageFail",{detail:{url:t.source}})),this.dispatchEvent(new CustomEvent("elementAdd",{detail:{element:e}}))};if(void 0===s||0===s.length)console.log("No image source set for: "+e);else if(-1!==s.search("<svg"))fabric.loadSVGFromString(s,(e,t)=>{t=fabric.util.groupSVGElements(e,t);if(n.fill)n.svgFill||(n.svgFill=n.fill),delete n.fill;else if(!n.fill&&!n.svgFill){if(e){o.colors=[];for(var i=0;i<e.length;++i){var s=0<e[i].fill.length?tinycolor(e[i].fill).toHexString():"transparent";o.colors.push(s)}o.svgFill=o.colors}n.svgFill=o.svgFill}delete n.clippingRect,delete n.boundingBox,delete n.originParams,delete n.colors,delete n.svgFill,delete n.width,delete n.height,delete n.originX,delete n.originY,delete n.objectCaching,a(t,n,0,{svgFill:o.svgFill})});else if(s.split(".").includes("svg")){let e=Date.now().toString(),t=this.options._loadFromScript||"",i=l(s)?new URL(t+s):s;!s.includes(".cloudfront.net/")&&!this.options.imageLoadTimestamp||this.options._loadFromScript||i.searchParams.append("t",e),"object"==typeof i&&(i=i.toString()),fabric.loadSVGFromURL(i,(e,t)=>{t=e?fabric.util.groupSVGElements(e,t):null;if(n.fill)n.svgFill||(n.svgFill=n.fill),delete n.fill;else if(!n.fill&&!n.svgFill){if(e){o.colors=[];for(var i=0;i<e.length;++i){var s=0<e[i].fill.length?tinycolor(e[i].fill).toHexString():"transparent";o.colors.push(s)}o.svgFill=o.colors}n.svgFill=o.svgFill}a(t,n,0,{svgFill:o.svgFill})})}else{var i,r=Date.now().toString(),e=this.options._loadFromScript||"";-1==s.indexOf("data:image/")?(i=l(s)?new URL(e+s):s,this.options.imageLoadTimestamp&&!this.options._loadFromScript&&i.searchParams.append("t",r),"object"==typeof i&&(i=i.toString())):i=s,new fabric.Image.fromURL(i,function(e){e=""===e.getSrc()?null:e,a(e,n)},{crossOrigin:"anonymous"})}}else"text"===f(a)?(s=s.replace(/\\n/g,"\n"),o.text=o.text||s,n._initialText=o.hasOwnProperty("_initialText")?o._initialText:o.text,n=p(n,{spacing:o.curveSpacing,radius:o.curveRadius,reverse:o.curveReverse,originParams:{...o}}),o.originParams&&o.originParams.text&&(n.originParams.text=n._initialText),o.curved&&void 0!==fabric.CurvedText?(e=n.text,t=new fabric.CurvedText(s,n),n.text=e):(o.textBox?(n.lockUniScaling=!this.options.editorMode,this.options.setTextboxWidth&&(n.lockUniScaling=!1,n.lockScalingX=!1),n.lockScalingY=!0,(t=new fabric.Textbox(s,n)).setControlVisible("bl",!0)):t=new fabric.IText(s,n),this.options.inCanvasTextEditing||t.on({"editing:entered":function(){this.exitEditing()}})),(n.textPlaceholder||n.numberPlaceholder)&&(n.textPlaceholder&&(this.textPlaceholder=t,n.removable=!1,n.editable=!1),n.numberPlaceholder)&&(this.numberPlaceholder=t,n.removable=!1,n.editable=!1),this.fabricCanvas.add(t),this.setElementParameters(n,t,!1),t.originParams=p(t.toJSON(),t.originParams),delete t.originParams.clipTo,t.originParams.z=this.getZIndex(t),t._isInitial||t._ignore||this.#e({element:t,parameters:n,interaction:"add"}),this.dispatchEvent(new CustomEvent("elementAdd",{detail:{element:t}}))):console.log("Sorry. This type of element is not allowed!")}}setElementParameters(e,t,i=0){if(!(t=void 0===t?this.fabricCanvas.getActiveObject():t)||void 0===e)return!1;"string"==typeof t&&(t=this.getElementByTitle(t));var s,n,a,o,r=f(t.type);"image"!=f(t.type)||t._isInitial||t._addToUZ||1!==t.scaleX||(o=null,h(t.resizeToW)&&h(t.resizeToH)?t.boundingBox?(s=this.getBoundingBoxCoords(t),o=y(t.width,t.height,s.width,s.height,t.scaleMode)):this.options.fitImagesInCanvas&&(s=3*t.cornerSize,t.width*t.scaleX+s>this.options.stageWidth||t.height*t.scaleY+s>this.options.stageHeight)&&(o=y(t.width,t.height,this.options.stageWidth-s,this.options.stageHeight-s)):(s=t.resizeToW,n=t.resizeToH,s=isNaN(s)?parseFloat(s)/100*this.options.stageWidth:parseInt(s),n=isNaN(n)?parseFloat(n)/100*this.options.stageHeight:parseInt(n),o=y(t.width,t.height,s,n,t.scaleMode)),null!==o&&(e=p(e,{scaleX:o,scaleY:o}))),t._addToUZ&&""!=t._addToUZ&&(e.z=-1,s=this.getElementByTitle(t._addToUZ),o=1,"image"==f(t.type)&&(o=y(t.width,t.height,s.width*s.scaleX,s.height*s.scaleY,s.scaleMode)),(e=p(e,{boundingBox:t._addToUZ,boundingBoxMode:"clipping",scaleX:o,scaleY:o,autoCenter:!0,removable:!0,zChangeable:!1,autoSelect:!1,copyable:!1,hasUploadZone:!0,z:this.getZIndex(this.getElementByTitle(t._addToUZ)),rotatable:s.rotatable,draggable:s.draggable,resizable:s.resizable,price:s.price||e.price,replace:t._addToUZ,lockUniScaling:s.lockUniScaling,uniScalingUnlockable:s.uniScalingUnlockable,advancedEditing:s.advancedEditing,originX:s.originX,originY:s.originY,angle:s.angle})).originParams=p(e.originParams,{boundingBox:e.boundingBox,replace:e.replace,rotatable:e.rotatable,draggable:e.draggable,resizable:e.resizable,lockUniScaling:e.lockUniScaling,uniScalingUnlockable:e.uniScalingUnlockable,price:e.price,scaleX:e.scaleX,scaleY:e.scaleY,hasUploadZone:!0,autoCenter:!0,originX:e.originX,originY:e.originY,angle:e.angle}),delete e[""],delete t._addToUZ),e.topped&&(e.zChangeable=!1),b(e)&&(e.isEditable=e.evented=e.selectable=!0),(!e.uploadZone||this.options.editorMode)&&(e.draggable&&(e.lockMovementX=e.lockMovementY=!1),e.rotatable&&(e.lockRotation=!1,e.hasRotatingPoint=!0),e.resizable&&(e.lockScalingX=e.lockScalingY=!1),e.resizable||e.rotatable||e.removable)&&(e.hasControls=!0),e.uploadZone&&(this.options.editorMode||(e.uploadZoneMovable&&(e.lockMovementX=e.lockMovementY=!1),e.uploadZoneRemovable&&(e.removable=!0,e.copyable=!1,e.hasControls=!0)),"3.0.0"!==fabric.version&&(e.lockRotation=!0,e.hasRotatingPoint=!1),e.excludeFromExport=!0),e.fixed&&g(e.replace)&&(e.replace=t.title),e.replace&&""!=e.replace&&null!==(n=this.getElementByReplace(e.replace))&&n!==t&&(e.z=this.getZIndex(n),e.left=t.originParams.left=n.left,e.top=t.originParams.top=n.top,e.autoCenter=!1,this.options.applyFillWhenReplacing&&(e.fill=n.fill),this.removeElement(n)),"string"==typeof e.text&&(a=(a=e.text).replace(FancyProductDesigner.forbiddenTextChars,""),this.options.disableTextEmojis&&(a=(a=a.replace(FPDEmojisRegex,"")).replace(String.fromCharCode(65039),"")),0!=t.maxLength&&a.length>t.maxLength&&(a=a.substr(0,t.maxLength),t.selectionStart=t.maxLength),0!=t.maxLines&&("textbox"==t.type&&t.__lineHeights?a=_maxTextboxLines(t,a):a.split("\n").length>t.maxLines&&(a=a.replace(/([\s\S]*)\n/,"$1"),t.exitEditing())),t.set("text",a),e.text=a,this.initialElementsLoaded)&&t.chargeAfterEditing&&(t._isPriced||(t._isPriced=!0),t._initialText===a)&&t._isPriced&&(t._isPriced=!1),"text"===r&&(e.hasOwnProperty("textDecoration")&&(e.underline="underline"===e.textDecoration),void 0!==e.letterSpacing&&(e.charSpacing=100*e.letterSpacing),e.fontSize&&e.fontSize<t.minFontSize?e.fontSize=t.minFontSize:e.fontSize&&e.fontSize>t.maxFontSize&&(e.fontSize=t.maxFontSize),e.text&&("uppercase"===t.textTransform?a=a.toUpperCase():"lowercase"===t.textTransform&&(a=a.toLowerCase()),t.set("text",a),e.text=a),e.textTransform&&(a=t.text,"uppercase"===e.textTransform?a=a.toUpperCase():"lowercase"===e.textTransform&&(a=a.toLowerCase()),t.set("text",a),e.text=a),(e.shadowColor||e.shadowBlur||e.shadowOffsetX||e.shadowOffsetY)&&!t.shadow&&(o={color:e.shadowColor||"rgba(0,0,0,0)"},t.setShadow(o)),t.shadow&&e.hasOwnProperty("shadowColor")&&(e.shadowColor?t.shadow.color=e.shadowColor:t.setShadow(null)),t.shadow)&&(e.shadowBlur&&(t.shadow.blur=e.shadowBlur),e.shadowOffsetX&&(t.shadow.offsetX=e.shadowOffsetX),e.shadowOffsetY)&&(t.shadow.offsetY=e.shadowOffsetY),delete e.paths,t.setOptions(e),"i-text"==t.type&&t.widthFontSize&&0<t.text.length&&((s=t.width>t.widthFontSize?t.fontSize*(t.widthFontSize/(t.width+1)):t.fontSize*(t.widthFontSize/(t.width-1)))<t.minFontSize?s=t.minFontSize:s>t.maxFontSize&&(s=t.maxFontSize),s=parseInt(s),e.fontSize=s,t.set("fontSize",s)),t.boundingBox&&"clipping"===e.boundingBoxMode||e.hasUploadZone,e.autoCenter,void 0===e.fill&&void 0===e.svgFill||(void 0!==e.svgFill?e.svgFill:e.fill,t.pattern=void 0),e.pattern,e.filter,t.canvas&&0<=e.z&&t.moveTo(e.z),t.curved&&(e.curveRadius&&t.set("radius",e.curveRadius),e.curveSpacing&&t.set("spacing",e.curveSpacing),void 0!==e.curveReverse)&&t.set("reverse",e.curveReverse),t.uploadZone?t.evented=0!==t.opacity:t.isEditable&&!this.options.editorMode&&(t.evented=!e.locked),"basic"==this.options.cornerControlsStyle&&t.lockScalingX&&t.lockScalingY;for(var d=this.fabricCanvas.getObjects(),l=0;l<d.length;++l){var c=d[l];c.uploadZone&&c.title==e.replace&&(c.opacity=0,c.evented=!1)}t.setCoords(),this.fabricCanvas.renderAll().calcOffset(),e.autoSelect&&t.isEditable&&!this.options.editorMode&&$(this.fabricCanvas.getElement()).is(":visible")&&setTimeout(function(){this.stage.setActiveObject(t),this.fabricCanvas.renderAll()},350)}removeElement(e){"string"==typeof e&&(e=this.getElementByTitle(e)),setTimeout(()=>{this.fabricCanvas.remove(e)},1)}getElementByReplace(e){for(var t=this.fabricCanvas.getObjects(),i=0;i<t.length;++i){var s=t[i];if(s.replace===e)return s}return null}getBoundingBoxCoords(e){if(e.boundingBox||e.uploadZone){if("object"==typeof e.boundingBox)return!!(e.boundingBox.hasOwnProperty("x")&&e.boundingBox.hasOwnProperty("y")&&e.boundingBox.width&&e.boundingBox.height)&&{left:e.boundingBox.x,top:e.boundingBox.y,width:e.boundingBox.width,height:e.boundingBox.height};for(var t=this.fabricCanvas.getObjects(),i=0;i<t.length;++i){var s,n=t[i];if(e.boundingBox==n.title)return{left:(s=n.getPointByOrigin("left","top")).x,top:s.y,width:n.width*n.scaleX,height:n.height*n.scaleY,angle:n.angle||0,cp:n.getCenterPoint()}}}return!1}getZIndex(e){return e=void 0===e?this.fabricCanvas.getActiveObject():e,this.fabricCanvas.getObjects().indexOf(e)}getElementByTitle(e){for(var t=this.fabricCanvas.getObjects(),i=0;i<t.length;++i)if(t[i].title===e)return t[i]}getElementByID(e){for(var t=this.fabricCanvas.getObjects(),i=0;i<t.length;++i)if(t[i].id==e)return t[i];return!1}reset(e=!0){this.undos=[],this.redos=[],instance.elements=[],instance.totalPrice=instance.truePrice=instance.additionalPrice=0,instance.stage.clear(),e&&instance.stage.wrapperEl.remove(),$this.trigger("clear"),$this.trigger("priceChange",[0,0])}#e(e,t,i=0){}}class w extends EventTarget{static relevantOptions=["stageWidth","stageHeight","customAdds","elementParameters","imageParameters","textParameters","customImageParameters","customTextParameters","maxPrice","optionalView","designCategories","printingBox","output","layouts","usePrintingBoxAsBounding","threeJsPreviewModel","editorMode","imageLoadTimestamp","_loadFromScript","fitImagesInCanvas","setTextboxWidth","inCanvasTextEditing","applyFillWhenReplacing","disableTextEmojis","cornerControlsStyle","responsive","maxCanvasHeight"];viewData;onCreatedCallback;title;thumbnail;options;fpdCanvas=null;canvasElem=null;fabricCanvas=null;responsiveScale=1;constructor(e,t={},i,s={}){super(),this.viewData=t,this.onCreatedCallback=i,this.title=t.title,this.thumbnail=t.thumbnail,this.options=t.options;i="rgba(84,223,230,1.00)",t=p({containerClass:"fpd-view-stage fpd-hidden",selection:this.options.multiSelection,selectionBorderColor:i,selectionColor:i,hoverCursor:"pointer",controlsAboveOverlay:!0,centeredScaling:!0,allowTouchScrolling:!0,preserveObjectStacking:!0},s);this.fpdCanvas=new x(e,t,this.options),c(this.fpdCanvas,"imageFail",e=>{d(`
                    <p>The image with the URL<br /><i style='font-size: 10px;'>${e.detail.url}</i><br />can not be loaded into the canvas.</p>
                    <p><b>Troubleshooting</b>
                        <ul>
                            <li>The URL is not correct!</li>
                            <li>The image has been blocked by <a href='https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS' target='_blank'>CORS policy</a>. You need to host the image under the same protocol and domain or enable 'Access-Control-Allow-Origin' on the server where you host the image. <a href='http://enable-cors.org/' target='_blank'>Read more about it here.</a><
                            /li>
                        </ul>
                    </p>
                `)}),this.canvasElem=this.fpdCanvas.canvasElem,this.fabricCanvas=this.fpdCanvas.fabricCanvas}init(){this.loadElements(this.viewData.elements,this.#t.bind(this))}loadElements(e,t){this.fpdCanvas.initialElementsLoaded&&this.fpdCanvas.reset(!1),this.fpdCanvas.addElements(e,t)}resetSize(){const e=this.fabricCanvas.wrapperEl.clientWidth;if(this.responsiveScale=e<this.options.stageWidth?e/this.options.stageWidth:1,!isNaN(this.options.maxCanvasHeight)&&1!==this.options.maxCanvasHeight){const e=window.innerHeight*parseFloat(this.options.maxCanvasHeight);this.options.stageHeight>this.options.stageWidth&&this.options.stageHeight*this.responsiveScale>e&&(this.responsiveScale=e/this.options.stageHeight)}return this.responsiveScale=parseFloat(Number(this.responsiveScale.toFixed(7))),this.responsiveScale=Math.min(this.responsiveScale,1),this.options.responsive||(this.responsiveScale=1),this.fabricCanvas.setDimensions({width:e,height:this.options.stageHeight*this.responsiveScale}).setZoom(this.responsiveScale).calcOffset().renderAll(),this.dispatchEvent(new CustomEvent("sizeUpdate",{detail:{}})),this.responsiveScale}#t(){this.onCreatedCallback(this)}}window.FancyProductDesigner=w;const E=t=>{let e=t.url;t.params&&(e+="?"+new URLSearchParams(t.params).toString());const i=new XMLHttpRequest;return i.responseType="json",i.open("GET",e),i.onreadystatechange=e=>{4==i.readyState&&200==i.status?t.onSuccess&&t.onSuccess(i.response):200!==i.status&&t.onError&&t.onError(i)},i.send(),i};class i extends EventTarget{langJSON=null;constructor(){super()}loadLangJSON(t=null,i=()=>{}){!1!==t?"object"==typeof t?(this.langJSON=t,i.call(this)):E({url:t,onSuccess:e=>{this.langJSON=e,i.call(this)},onError:e=>{alert('Language JSON "'+t+'" could not be loaded or is not valid. Make sure you set the correct URL in the options and the JSON is valid!'),i.call(this)}}):i.call(this)}translateElement(e){let t="";var i,s;return this.langJSON&&(i=(e.getAttribute("placeholder")?e.getAttribute("placeholder"):e.getAttribute("title")?e.getAttribute("title"):e.dataset.title||e.innerText).split("."),s=this.langJSON[i[0]])&&void 0!==(t=s[i[1]])||(t=e.dataset.defaulttext),e.getAttribute("placeholder")?(e.setAttribute("placeholder",t),e.innerText=""):e.getAttribute("title")?e.setAttribute("title",t):e.dataset.title?e.dataset.title=t:e.innerText=t,t}getTranslation(e,t,i=""){return this.langJSON&&(e=this.langJSON[e])&&e[t]?e[t]:i}}class e extends HTMLElement{placeholder="";value="";searchable=!1;constructor(){super(),this.innerHTML='<input type="text" class="fpd-dropdown-current"/> <div class="fpd-dropdown-arrow"><span class="fpd-icon-arrow-dropdown"></span></div> <div class="fpd-dropdown-list"> <div class="fpd-scroll-area"></div> </div> '}connectedCallback(){this.addEventListener("click",()=>{this.classList.toggle("fpd-active")}),this.querySelector("input.fpd-dropdown-current").addEventListener("keyup",e=>{if(this.searchable){const t=e.currentTarget.value;this.querySelectorAll(".fpd-dropdown-list .fpd-item").forEach(e=>{0==t.length?e.classList.remove("fpd-hidden"):e.classList.toggle("fpd-hidden",!e.innerText.toLowerCase().includes(t.toLowerCase()))})}})}static get observedAttributes(){return["searchable","placeholder","value"]}attributeChangedCallback(e,t,i){t!==i&&("placeholder"===e?this.querySelector("input.fpd-dropdown-current").setAttribute("placeholder",i):"value"===e?this.querySelector("input.fpd-dropdown-current").value=i:"searchable"===e&&(this.searchable=this.hasAttribute("searchable")))}}customElements.define("fpd-dropdown",e);class t extends HTMLElement{constructor(){super()}connectedCallback(){var e=document.createElement("template");e.innerHTML='<div class="fpd-navigation fpd-scrollbar-hidden"></div> <div class="fpd-module-content"></div> <div class="fpd-close-off-canvas"> <span class="fpd-icon-close"></span> </div> <div class="fpd-draggable-dialog fpd-container fpd-shadow-2"> <div class="fpd-dialog-head"> <div class="fpd-dialog-drag-handle"> <div> <span class="fpd-icon-drag"></span><span class="fpd-dialog-title"></span> </div> </div> <div class="fpd-close-dialog"> <span class="fpd-icon-close"></span> </div> </div> </div> ',this.append(e.content.cloneNode(!0))}}customElements.define("fpd-main-bar",t);class I extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-grid" data-defaulttext="Swap Product" data-title="modules.products"> <fpd-dropdown class="fpd-product-categories" searchable></fpd-dropdown> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain fpd-padding"> </div> </div> </div>'}}customElements.define("fpd-module-products",I);class S extends EventTarget{currentCategoryIndex=0;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-products"),t.append(this.container),e.addEventListener("productsSet",e=>{const s=this.container.querySelector(".fpd-dropdown-list > .fpd-scroll-area");s.innerHTML="",this.fpdInstance.products&&0<this.fpdInstance.products.length&&(void 0!==this.fpdInstance.products[0].category&&1<this.fpdInstance.products.length&&(this.container.classList.add("fpd-categories-enabled"),this.fpdInstance.products.forEach((e,t)=>{var i=document.createElement("span");i.className="fpd-item",i.dataset.index=t,i.innerText=e.category,i.addEventListener("click",e=>{this.selectCategory(e.currentTarget.dataset.index)}),s.append(i)})),this.#i(),this.selectCategory(0))}),e.addEventListener("productAdd",(e,t,i,s)=>{s==this.currentCategoryIndex&&this.#s(t)})}#i(){if(!this.fpdInstance.mainOptions.editorMode){let e=this.fpdInstance.products[0],t=void 0===e;void 0!==e&&(t=!!(!e.hasOwnProperty("category")&&this.fpdInstance.products.length<2||e.hasOwnProperty("category")&&e.products.length<2&&this.fpdInstance.products.length<2)),this.fpdInstance.container.classList.toggle("fpd-products-module-hidden",t)}}#s(e,i){var t=e[0].productThumbnail||e[0].thumbnail,e=e[0].productTitle||e[0].title,s=document.createElement("div"),e=(s.className="fpd-item",s.dataset.title=e,s.dataset.source=t,s.dataset.index=i,s.addEventListener("click",e=>{if(e.preventDefault(),this.fpdInstance.mainOptions.swapProductConfirmation){var t=d(this.fpdInstance.translator.getTranslation("modules","products_confirm_replacement"),!1,"confirm",this.fpdInstance.container);const e=t.querySelector(".fpd-confirm");e.innerText=this.fpdInstance.translator.getTranslation("modules","products_confirm_button"),c(e,["click"],()=>{this.fpdInstance.selectProduct(i,this.currentCategoryIndex),t.remove()})}else this.fpdInstance.selectProduct(Number(e.currentTarget.dataset.index),this.currentCategoryIndex)}),this.container.querySelector(".fpd-grid").append(s),document.createElement("picture"));e.dataset.img=t,s.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e)}selectCategory(t=0){if(this.currentCategoryIndex=t,this.container.querySelector(".fpd-grid").innerHTML="",this.fpdInstance.products&&0<this.fpdInstance.products.length){let e;void 0!==this.fpdInstance.products[0].category?(e=this.fpdInstance.products[t].products,this.container.querySelector(".fpd-dropdown-current").value=this.fpdInstance.products[t].category):e=this.fpdInstance.products.products,e.forEach((e,t)=>{this.#s(e,t)})}}}class C extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-text-secondary" data-defaulttext="Add Text" data-title="modules.text"> <div class="fpd-add-text"> <textarea data-defaulttext="Enter some text" placeholder="modules.text_input_placeholder"></textarea> <div class="fpd-textbox-wrapper"> <span class="fpd-section-title" data-defaulttext="Optional: Enter a fixed width"> modules.enter_textbox_width </span> <input type="number" class="fpd-textbox-width" value="" step="1" min="0"> </div> <div class="fpd-btn"> <span data-defaulttext="Add Text">modules.text_add_btn</span> <span class="fpd-price"></span> </div> </div> <div class="fpd-text-templates fpd-scroll-area"> <div class="fpd-grid"></div> </div> </div>'}}customElements.define("fpd-module-text",C);class T extends EventTarget{#n;constructor(n,e){var a;super(),this.fpdInstance=n,this.container=document.createElement("fpd-module-text"),e.append(this.container),Boolean(n.mainOptions.setTextboxWidth)||this.container.querySelector(".fpd-textbox-wrapper").classList.add("fpd-hidden"),this.container.querySelector(".fpd-btn").addEventListener("click",e=>{let t=this.container.querySelector("textarea"),i=t.value;if(n.currentViewInstance&&0<i.length){const e=this.container.querySelector(".fpd-textbox-width"),t=parseInt(e.value);e.value="";var s=p(currentViewOptions.customTextParameters,{isCustom:!0,_addToUZ:n.currentViewInstance.currentUploadZone});isNaN(t)||(s.textBox=!0,s.width=t,s.resizable=!0),n.addElement("text",i,i,s)}t.value=""}),c(this.container.querySelector("textarea"),["input","change"],e=>{let t=e.currentTarget.value,i=this.#n?this.#n.customTextParameters.maxLength:0,s=this.#n?this.#n.customTextParameters.maxLines:0;t=t.replace(FancyProductDesigner.forbiddenTextChars,""),n.mainOptions.disableTextEmojis&&(t=(t=t.replace(FPDEmojisRegex,"")).replace(String.fromCharCode(65039),"")),0!=i&&t.length>i&&(t=t.substr(0,i)),0!=s&&t.split("\n").length>s&&(t=t.replace(/([\s\S]*)\n/,"$1")),e.currentTarget.value=t}),Array.isArray(n.mainOptions.textTemplates)&&(a=this.container.querySelector(".fpd-text-templates .fpd-grid"),n.mainOptions.textTemplates.forEach(e=>{var t=e.properties,i="font-family:"+(t.fontFamily||"Arial"),t=(i+="; text-align:"+(t.textAlign||"left"),document.createElement("div")),s=(t.className="fpd-item",t.dataset.props=JSON.stringify(e.properties),t.dataset.text=e.text,t.addEventListener("click",e=>{n.currentViewInstance&&((e=JSON.parse(e.currentTarget.dataset.props)).isCustom=!0,e._addToUZ=n.currentViewInstance.currentUploadZone,e=p(currentViewOptions.customTextParameters,e),n.addElement("text",this.dataset.text,this.dataset.text,e))}),document.createElement("div"));s.setAttribute("style",i),s.innerHTML=e.text.replace(/(?:\r\n|\r|\n)/g,"<br>"),t.append(s),a.append(t)})),n.addEventListener("viewSelect",e=>{})}}class L extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-design-library" data-defaulttext="Add Designs" data-title="modules.designs"> <div class="fpd-head"> <div class="fpd-input-back-search"> <div class="fpd-back fpd-btn"> <span class="fpd-icon-back"></span> </div> <div class="fpd-input-search"> <input type="text"/> <span class="fpd-icon-magnify"></span> </div> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain"></div> </div> </div>'}}customElements.define("fpd-module-designs",L);class k extends EventTarget{#a="";#o=!1;#r=[];#d=null;#l=null;constructor(i,e,t=null){super(),this.#a=i.translator.getTranslation("modules","designs_search_in").toUpperCase(),this.fpdInstance=i,this.#l=t,this.container=document.createElement("fpd-module-designs"),e.append(this.container),t&&(this.container.dataset.dynamicDesignsId=t),this.headElem=this.container.querySelector(".fpd-head"),this.gridElem=this.container.querySelector(".fpd-grid"),this.headElem.querySelector(".fpd-input-search input").addEventListener("keyup",e=>{var t=e.currentTarget,i=this.gridElem.querySelectorAll(".fpd-item");if(""==t.value)for(var s of i)s.classList.remove("fpd-hidden");else{const e=t.value.toLowerCase().trim();for(var n of i)n.classList.add("fpd-hidden"),n.dataset.search.includes(e)&&n.classList.remove("fpd-hidden")}}),this.headElem.querySelector(".fpd-back").addEventListener("click",e=>{0<this.gridElem.querySelectorAll(".fpd-category").length&&this.#r.pop();let t,i=this.fpdInstance.designs;this.#r.forEach(e=>{t=i[e],i=t.category}),(this.#d=i)&&this.#c(this.#d,t),void 0===t&&this.toggleCategories()}),i.addEventListener("designsSet",e=>{var t=i.designs;Array.isArray(t)&&0!==t.length&&(t[0].hasOwnProperty("source")?(this.container.classList.add("fpd-single-cat"),this.#p(t)):1<t.length||t[0].category?(this.#o=!0,this.toggleCategories()):1===t.length&&t[0].designs&&(this.container.classList.add("fpd-single-cat"),this.#p(t[0].designs)))})}#c(e,t){this.gridElem.innerHTML="",this.gridElem.classList.remove("fpd-padding"),this.headElem.querySelector(".fpd-input-search input").value="",this.container.classList.remove("fpd-designs-active"),this.container.classList.add("fpd-categories-active"),e.forEach((e,t)=>{this.#h(e)}),t&&(this.headElem.querySelector(".fpd-input-search input").setAttribute("placeholder",this.#a+" "+t.title.toUpperCase()),this.container.classList.add("fpd-head-visible"))}#h(e){var t,i=document.createElement("div");i.className="fpd-category fpd-item",i.dataset.search=e.title.toLowerCase(),e.thumbnail?((t=document.createElement("picture")).dataset.img=e.thumbnail,i.append(t),this.fpdInstance.lazyBackgroundObserver.observe(t),(t=document.createElement("span")).innerText=e.title,i.append(t)):i.innerHTML="<span>"+e.title+"</span>",i.addEventListener("click",e=>{var e=e.currentTarget,t=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(e),i=this.#d[t];i.category?(this.#r.push(t),this.#d=i.category,this.#c(this.#d,i)):this.#p(i.designs,i.parameters),this.headElem.querySelector(".fpd-input-search input").setAttribute("placeholder",this.#a+" "+e.dataset.search.toUpperCase())}),this.gridElem.append(i)}#p(e,t={}){this.gridElem.innerHTML="",this.gridElem.classList.add("fpd-padding"),this.headElem.querySelector(".fpd-input-search input").value="",this.container.classList.remove("fpd-categories-active"),this.container.classList.add("fpd-designs-active","fpd-head-visible"),e.forEach(e=>{e.parameters=p(t,e.parameters),this.#u(e)})}#u(e){e.thumbnail=void 0===e.thumbnail?e.source:e.thumbnail;var t=s({url:e.source,thumbnailUrl:e.thumbnail,title:e.title,price:this.fpdInstance.formatPrice(e.parameters.price)});t.dataset.search=e.title.toLowerCase(),t.dataset.parameters=e.parameters,t.addEventListener("click",e=>{e=e.currentTarget;this.fpdInstance._addCanvasDesign(e.dataset.source,e.dataset.title,e.dataset.parameters)}),this.gridElem.append(t),this.fpdInstance.lazyBackgroundObserver.observe(t.querySelector("picture"))}toggleCategories(){if(this.#o){this.#r=[],this.container.classList.remove("fpd-head-visible","fpd-single-cat"),this.#d=this.fpdInstance.designs,this.#c(this.#d);let e=[];this.#l&&(e=this.fpdInstance.mainOptions.dynamicDesigns[this.#l].categories),this.fpdInstance.currentViewInstance&&(t=this.fpdInstance.currentViewInstance.currentElement,e=(t&&t.uploadZone&&t.designCategories?this.fpdInstance.currentViewInstance.currentElement:this.fpdInstance.currentViewInstance.options).designCategories);var t,i=this.container.querySelectorAll(".fpd-category");if(0<e.length){const t=[];for(var s of i)e.includes(s.dataset.search)?(s.classList.remove("fpd-hidden"),t.push(s)):s.classList.add("fpd-hidden");1===t.length&&(this.container.classList.add("fpd-single-cat"),t[0].click())}else for(var n of i)n.classList.remove("fpd-hidden")}}}class O extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-design-library" data-defaulttext="Text to Image" data-title="modules.text_to_image"> <div class="fpd-head"> <textarea></textarea> <div class="fpd-btn"> <span data-defaulttext="Generate">modules.text_to_image_generate</span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover"></div> </div> </div>'}}customElements.define("fpd-module-text-to-image",O);class P extends EventTarget{#g="https://radykal.dep/fpd-js/server/php/sd-api.php";#m=!1;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-text-to-image"),t.append(this.container),this.inputElem=this.container.querySelector(".fpd-head textarea"),this.gridElem=this.container.querySelector(".fpd-grid"),this.container.querySelector(".fpd-head .fpd-btn").addEventListener("click",e=>{const t=e.currentTarget;g(this.inputElem.value)||this.#m||(this.#m=!0,t.classList.add("fpd-loading"),e={action:"text2img",prompt:this.inputElem.value,numOfImg:2},fetch(this.#g,{method:"POST",redirect:"follow",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e=JSON.parse(e),console.log(e),e&&e.output&&this.#f(e.output),this.#m=!1,t.classList.remove("fpd-loading")}).catch(e=>{this.#m=!1,t.classList.remove("fpd-loading")}))})}#f(e=[]){e.forEach(e=>{var t=document.createElement("div");t.className="fpd-item",t.dataset.source=e,t.innerHTML='<picture data-img="'+e+'"></picture><span class="fpd-price"></span>',this.gridElem.append(t),t.addEventListener("click",e=>{e=e.currentTarget;this.fpdInstance._addCanvasDesign(e.dataset.source,e.dataset.title,e.dataset.parameters)}),this.fpdInstance.lazyBackgroundObserver.observe(t.querySelector("picture"))})}}class _ extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-photo" data-defaulttext="Add Image" data-title="modules.images"> <div class="fpd-module-tabs"> <div data-context="upload" class="fpd-active"> <span class="fpd-icon-cloud-upload"></span> </div> <div data-context="facebook" class="fpd-hidden" title="Facebook"> <span class="fpd-icon-facebook"></span> </div> <div data-context="instagram" class="fpd-hidden" title="Instagram"> <span class="fpd-icon-instagram"></span> </div> <div data-context="pixabay" class="fpd-hidden" title="Pixabay"> <span class="fpd-icon-pixabay"></span> </div> </div> <div class="fpd-module-tabs-content"> <div data-context="upload" class="fpd-active"></div> <div data-context="facebook"></div> <div data-context="instagram"></div> <div data-context="pixabay"></div> </div> </div>'}}customElements.define("fpd-module-images",_);class M extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-upload-zone"> <div> <span class="fpd-icon-file-upload"></span> <span data-defaulttext="Click or drop images here">modules.upload_zone</span> <span class="fpd-price"></span> </div> </div> <input type="file" multiple="multiple" class="fpd-upload-input fpd-hidden" name="files[]" accept="image/jpeg,image/jpg,image/png,image/svg+xml,application/pdf"/> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-uploads",M);const A=(e="",t=!0)=>{let i=document.body.querySelector(".fpd-snackbar-wrapper");i||((i=document.createElement("div")).className="fpd-snackbar-wrapper",document.body.append(i));const s=document.createElement("div");return s.className="fpd-snackbar fpd-shadow-1",s.innerHTML="<p>"+e+"</p>",s.addEventListener("click",e=>{s.remove()}),i.append(s),t&&setTimeout(function(){s.remove()},5e3),s};class q extends EventTarget{#v;#b=0;#y=!1;#x=[];#w=0;constructor(t,e){super();var i=(this.fpdInstance=t).mainOptions.customImageAjaxSettings,i=(this.postUrl=i.url,this.uploadsDir=i.data&&i.data.uploadsDir?i.data.uploadsDir:"",this.uploadsDirURL=i.data&&i.data.uploadsDirURL?i.data.uploadsDirURL:"",this.container=document.createElement("fpd-module-uploads"),e.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid"),this.container.querySelector(".fpd-upload-zone"));this.#v=t.mainOptions.allowedImageTypes,this.#v.includes("jpeg")&&!this.#v.includes("jpg")&&this.#v.push("jpg");const s=this.container.querySelector(".fpd-upload-input");let n=[];if(this.#v.forEach(e=>{"pdf"==e?n.push("application/pdf"):("svg"==e&&(e+="+xml"),n.push("image/"+e))}),s.setAttribute("accept",n.join()),c(i,"click",async e=>{e.preventDefault(),s.click()}),c(s,"change",e=>{this.#E(e.currentTarget.files)}),c(i,["dragover","dragleave"],e=>{e.stopPropagation(),e.preventDefault(),e.currentTarget.classList.toggle("fpd-hover","dragover"===e.type)}),c(i,"drop",e=>{e.stopPropagation(),e.preventDefault();e=e.target.files||e.dataTransfer.files;this.#E(e)}),c(t,"productCreate",e=>{this.#y=!1}),o,window.localStorage.getItem("fpd_uploaded_images")){const t=JSON.parse(window.localStorage.getItem("fpd_uploaded_images"));t.forEach(e=>{this.#I(e.url,e.title);var s=new Image;s.src=e.url,s.onerror=function(){var i=null;t.forEach(function(e,t){e.url==s.src&&(i=t)}),null!=i&&(t.splice(i,1),window.localStorage.setItem("fpd_uploaded_images",JSON.stringify(t)))}})}}#E(e){var t,i;this.fpdInstance.mainOptions.uploadAgreementModal?((i=(t=d(this.fpdInstance.translator.getTranslation("modules","images_agreement"),!1,"confirm",this.fpdInstance.container)).querySelector(".fpd-confirm")).innerText=this.fpdInstance.translator.getTranslation("modules","images_confirm_button"),c(i,["click"],()=>{this.#S(e),t.remove()})):this.#S(e)}#S(e){this.#b=0,this.#w=e.length,this.fpdInstance.loadingCustomImage=!0,Array.from(e).forEach((e,t)=>{this.#v.includes(e.name.split(".").pop().toLowerCase().split("?")[0])&&this.#C(e,0==t)}),this.container.querySelector(".fpd-upload-zone").classList.remove("fpd-hover")}#C(e,t){var i=1024*this.fpdInstance.mainOptions.customImageParameters.maxSize*1024;e.size>i?(A(this.fpdInstance.translator.getTranslation("misc","maximum_size_info").replace("%filename",e.name).replace("%mb",this.fpdInstance.mainOptions.customImageParameters.maxSize)),this.fpdInstance.loadingCustomImage=!1):"application/pdf"===e.type?this.#T(e,t):this.#L(e,t)}#L(n,a=!1){const o=this.fpdInstance.mainOptions,e=o.customImageAjaxSettings,r=e.data&&e.data.saveOnServer?1:0,t=new FileReader;t.onload=t=>{t=t.currentTarget.result;if("image/jpeg"===n.type&&o.customImageParameters.minDPI){const a=new JpegMeta.JpegFile(atob(t.replace(/^.*?,/,"")),n.name);let e=null;if(a.tiff&&a.tiff.XResolution&&a.tiff.XResolution.value?(i=a.tiff.XResolution.value.den,e=a.tiff.XResolution.value.num/i):a.jfif&&a.jfif.Xdensity&&a.jfif.Xdensity.value&&(e=a.jfif.Xdensity.value),null!==e){if(console.log(n.name+" Real Resolution: "+e),e<o.customImageParameters.minDPI){let e=this.fpdInstance.translator.getTranslation("misc","minimum_dpi_info");return e=e.replace("%dpi",o.customImageParameters.minDPI),d(e,!1,"",this.fpdInstance.container),this.fpdInstance.loadingCustomImage=!1}}else console.log(n.name+": Resolution is not accessible.")}const s=this.#I(t,n.name);r&&(s.classList.add("fpd-loading"),s.insertAdjacentHTML("beforeend",'<div class="fpd-loading-bar"><div class="fpd-loading-progress"></div></div>'));var i=new Image;i.onload=e=>{var e=e.currentTarget,t=e.height,i=e.width;if(this.fpdInstance.currentViewInstance.options.customImageParameters,((t,e,i)=>{console.log(e);var s=t.currentViewInstance,n=s.options.customImageParameters;if(e>n.maxW||e<n.minW||i>n.maxH||i<n.minH){t.loadingCustomImage=!1,console.log(t.mainBar),t.mainBar&&(t.mainBar.toggleContentDisplay(!1),s.currentUploadZone)&&t.mainBar.toggleUploadZonePanel(!1);let e=t.translator.getTranslation("misc","uploaded_image_size_alert");return e=e.replace("%minW",n.minW).replace("%minH",n.minH).replace("%maxW",n.maxW).replace("%maxH",n.maxH),d(e),!1}return!0})(this.fpdInstance,i,t))if(r){i=new FormData;i.append("uploadsDir",this.uploadsDir),i.append("uploadsDirURL",this.uploadsDirURL),i.append("images[]",n);const d=new XMLHttpRequest;d.responseType="json",d.onreadystatechange=e=>{if(d.readyState===XMLHttpRequest.DONE){const e=d.status;if(0===e||200<=e&&e<400){const e=d.response;e.image_src&&(this.#k(e.image_src,e.filename),s.dataset.source=e.image_src,s.classList.remove("fpd-loading"),s.querySelector(".fpd-loading-bar").remove(),this.#O(s,a),this.#b++,s.xhr=null),this.fpdInstance.loadingCustomImage=!1}}},d.upload.onprogress=e=>{var t=e.total,e=e.loaded,e=parseInt(100*e/t);s.querySelector(".fpd-loading-progress").style.width=e+"%"},d.upload.onerror=e=>{this.fpdInstance.loadingCustomImage=!1,s.remove(),A("Upload failed. Please try again or check your web console!")},d.open("POST",this.postUrl),d.send(i),s.xhr=d}else this.#k(e,n.name),this.#O(s,a),this.#b++;else s.remove(),this.fpdInstance.currentViewInstance.currentUploadZone=null},i.src=t},t.readAsDataURL(n)}#T(e,t=0){this.fpdInstance.mainOptions;const i=A(this.fpdInstance.translator.getTranslation("modules","images_pdf_upload_info"),!1),s=new FormData,n=(s.append("uploadsDir",this.uploadsDir),s.append("uploadsDirURL",this.uploadsDirURL),s.append("pdf",e),new XMLHttpRequest);n.responseType="json",n.onreadystatechange=e=>{if(n.readyState===XMLHttpRequest.DONE){const e=n.status;if(0===e||200<=e&&e<400){const e=n.response;this.#w--,e.pdf_images.forEach((e,t)=>{var i=this.#I(e.image_url,e.filename);this.#O(i,0==t),this.#k(e.image_url,e.filename),this.#b++}),i.remove(),this.#w++,this.fpdInstance.loadingCustomImage=!1}}},n.upload.onerror=()=>{this.fpdInstance.loadingCustomImage=!1,i.remove(),A("Upload failed. Please try again or check your web console!")},n.open("POST",this.postUrl),n.send(s)}#k(e,t){o;var i=window.localStorage.getItem("fpd_uploaded_images")?JSON.parse(window.localStorage.getItem("fpd_uploaded_images")):[];i.push({url:e,title:t}),window.localStorage.setItem("fpd_uploaded_images",JSON.stringify(i))}#I(e,t){const i=s({url:e,title:t,price:this.fpdInstance.formatPrice(this.fpdInstance.currentViewInstance.options.customImageParameters.price),removable:!0});return this.gridElem.append(i),this.fpdInstance.lazyBackgroundObserver.observe(i.querySelector("picture")),c(i,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),c(i.querySelector(".fpd-delete"),"click",e=>{e.stopPropagation(),e.preventDefault();var t,e=Array.from(this.gridElem.children).indexOf(i);i.classList.contains("fpd-loading")||((t=JSON.parse(window.localStorage.getItem("fpd_uploaded_images"))).splice(e,1),window.localStorage.setItem("fpd_uploaded_images",JSON.stringify(t)),i.xhr&&i.xhr.abort(),i.remove())}),i}#O(e,t){if(!this.#y&&this.fpdInstance.mainOptions.autoFillUploadZones){const t=this.#x[this.#b]||null;t&&this.fpdInstance._addGridItemToCanvas(e,{_addToUZ:t.uz},t.viewIndex)}else t&&this.fpdInstance._addGridItemToCanvas(e);this.#b==this.#w-1&&(this.#y=!0)}#P(s,e){var n,a,o,r,d,t=this.fpdInstance.mainOptions.imageQualityRatings;t&&"object"==typeof t&&(n=t.low||null,a=t.mid||null,o=t.high||null,r="fpd-icon-star",d="fpd-icon-star-outline",(t=new Image).onload=function(){var e,t,i=s.append('<div class="fpd-image-quality-ratings"></div>').children(".fpd-image-quality-ratings");n&&2==n.length&&(t=this.width<Number(n[0])||this.height<Number(n[1])?d:r,i.append('<span class="'+t+'"></span>'),t==r)&&(e=fpdInstance.getTranslation("misc","image_quality_rating_low")),a&&2==a.length&&(t=this.width<Number(a[0])||this.height<Number(a[1])?d:r,i.append('<span class="'+t+'"></span>'),t==r)&&(e=fpdInstance.getTranslation("misc","image_quality_rating_mid")),(e=o&&2==o.length&&(t=this.width<Number(o[0])||this.height<Number(o[1])?d:r,i.append('<span class="'+t+'"></span>'),t==r)?fpdInstance.getTranslation("misc","image_quality_rating_high"):e)&&i.data("quality-label",e)},t.src=e)}}class H extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-head"> <div class="fpd-facebook-login"> <fb:login-button data-max-rows="1" data-show-faces="false" data-scope="user_photos"> </fb:login-button> </div> <fpd-dropdown class="fpd-facebook-albums" placeholder="Select An Album" searchable></fpd-dropdown> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-facebook-images",H);class B extends EventTarget{constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-facebook-images"),t.append(this.container),this.dropdown=this.container.querySelector("fpd-dropdown"),this.dropdownList=this.container.querySelector(".fpd-dropdown-list"),this.gridElem=this.container.querySelector(".fpd-grid"),this.#_()}#_(){var e=document.createElement("script");e.src="//connect.facebook.com/en_US/sdk.js",e.addEventListener("load",()=>{FB.init({appId:this.fpdInstance.mainOptions.facebookAppId,autoLogAppEvents:!0,xfbml:!0,version:"v16.0"}),FB.getLoginStatus(this.#D.bind(this)),FB.Event.subscribe("auth.statusChange",this.#D.bind(this))}),document.body.appendChild(e)}#D(e){"connected"===e.status&&(r(this.container,["fpd-facebook-logged-in"]),FB.api("/me/albums?fields=name,count,id",e=>{e.data.forEach(e=>{var t=document.createElement("span");t.className="fpd-item",t.dataset.albumid=e.id,t.innerText=e.name,t.addEventListener("click",e=>{this.dropdown.setAttribute("value",e.currentTarget.innerText),this.#A(e.currentTarget.dataset.albumid)}),this.dropdownList.append(t)}),u(this.dropdown,["fpd-on-loading"])}))}#A(t){this.gridElem.innerHTML="",r(this.dropdown,["fpd-on-loading"]),FB.api("/"+t+"?fields=count",e=>{e=e.count;FB.api("/"+t+"?fields=photos.limit("+e+").fields(source,images)",e=>{u(this.dropdown,["fpd-on-loading"]),e.error||e.photos.data.forEach(e=>{var t=(e.images[0]||e).source,i=(e.images[e.images.length-1]?e.images[e.images.length-1]:e).source,t=s({url:t,thumbnailUrl:i,title:e.id,price:this.fpdInstance.formatPrice(this.fpdInstance.currentViewInstance.options.customImageParameters.price)});c(t,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),this.gridElem.append(t),this.fpdInstance.lazyBackgroundObserver.observe(t.querySelector("picture"))}),this.fpdInstance.toggleSpinner(!1)})})}}class N extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-instagram-images",N);class z extends EventTarget{accessToken=null;nextStack=null;loadingStack=!1;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-instagram-images"),t.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid");const i=this.container.querySelector(".fpd-scroll-area");i.addEventListener("scroll",e=>{var t=i.scrollHeight;i.clientHeight+i.scrollTop+100>t&&(null===this.nextStack||this.loadingStack||this.#M(this.nextStack,!1))})}authenticate(){const e=this.fpdInstance.mainOptions;if(o()){const e=window.localStorage.getItem("fpd_insta_access_token");if(!g(e))return this.accessToken=e,void this.#M()}var t=(window.screen.width-700)/2,i=(window.screen.height-500)/2,s={app_id:e.instagramClientId,redirect_uri:e.instagramRedirectUri,scope:"user_profile,user_media",response_type:"code"},s=new URLSearchParams(s).toString(),n=window.open("https://api.instagram.com/oauth/authorize?"+s,"","width=700,height=500,left="+t+",top="+i),a=setInterval(()=>{n.closed&&clearInterval(a);try{var e;n.location&&n.location.href&&(e=new URL(n.location.href).searchParams.get("code"))&&(e=e.replace("#_",""),this.#U(e),n.close())}catch(e){}},500)}#U(e){var t=this.fpdInstance.mainOptions;this.fpdInstance.toggleSpinner(!0),E({url:t.instagramTokenUri,params:{code:e,client_app_id:t.instagramClientId,redirect_uri:t.instagramRedirectUri},onSuccess:e=>{e.access_token?(o()&&window.localStorage.setItem("fpd_insta_access_token",e.access_token),this.accessToken=e.access_token,this.#M()):e.error_message&&(console.log(e),this.fpdInstance.toggleSpinner(!1))},onError:e=>{console.log(e),this.fpdInstance.toggleSpinner(!1)}})}#M(e="https://graph.instagram.com/me/media",t=!0){this.loadingStack=!0,this.fpdInstance.toggleSpinner(!0);e={url:e,onSuccess:e=>{e.data&&(this.nextStack=e.paging&&e.paging.next?e.paging.next:null,e.data.forEach(e=>{"VIDEO"!==e.media_type&&(e=s({url:e.media_url,thumbnailUrl:e.thumbnail_url||e.media_url,title:e.id,price:this.fpdInstance.formatPrice(this.fpdInstance.currentViewInstance.options.customImageParameters.price)}),c(e,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),this.gridElem.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture")))})),this.fpdInstance.toggleSpinner(!1),this.loadingStack=!1},onError:e=>{e.response&&e.response.error&&e.response.error.code&&o()&&190==e.response.error.code&&(window.localStorage.removeItem("fpd_insta_access_token"),this.accessToken=null,this.authenticate()),this.fpdInstance.toggleSpinner(!1),this.loadingStack=!1}};t&&(this.gridElem.innerHTML="",e.params={fields:"id,caption,media_url,media_type",access_token:this.accessToken}),E(e)}}class U extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-loader-wrapper"> <div class="fpd-loader"> <div class="fpd-loader-circle"></div> </div> </div> <div class="fpd-head"> <a href="https://pixabay.com/" target="_blank" class="fpd-pixabay-logo"> </a> <div class="fpd-input-search"> <input type="text" data-defaulttext="Search in Pixabay library" placeholder="modules.pixabay_search"/> <span class="fpd-icon-magnify"></span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-pixabay-images",U);class F extends EventTarget{loadingStack=!1;currentQuery="";pixabayPage=1;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-pixabay-images"),t.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid"),this.loader=this.container.querySelector(".fpd-loader-wrapper");const i=this.container.querySelector(".fpd-scroll-area");i.addEventListener("scroll",e=>{var t=i.scrollHeight;i.clientHeight+i.scrollTop+100>t&&(this.loadingStack||(this.pixabayPage++,this.loadImages(void 0,!1)))}),c(this.container.querySelector("input"),["keypress"],e=>{13==e.which&&(this.pixabayPage=1,this.loadImages(e.currentTarget.value))})}loadImages(e,t=!0){if(this.currentQuery===e)return!1;var i=this.fpdInstance.mainOptions,e=(this.loadingStack=!0,this.currentQuery=void 0===e?this.currentQuery:e,i.pixabayHighResImages?"&response_group=high_resolution":""),e="https://pixabay.com/api/?safesearch=true&key="+i.pixabayApiKey+"&page="+this.pixabayPage+"&per_page=40&min_width="+i.customImageParameters.minW+"&min_height="+i.customImageParameters.minH+e+"&q="+encodeURIComponent(this.currentQuery)+"&lang="+i.pixabayLang;t&&(this.gridElem.innerHTML=""),u(this.loader,["fpd-hidden"]),E({url:e,onSuccess:e=>{r(this.loader,["fpd-hidden"]),0<e.hits.length&&e.hits.forEach(e=>{e=s({url:e.imageURL||e.webformatURL,thumbnailUrl:e.webformatURL,title:e.id||e.id_hash,price:this.fpdInstance.formatPrice(this.fpdInstance.currentViewInstance.options.customImageParameters.price)});c(e,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),this.gridElem.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture"))}),this.loadingStack=!1},onError:e=>{r(this.loader,["fpd-hidden"])}})}}class D extends EventTarget{constructor(n,e){super(),this.fpdInstance=n,this.container=document.createElement("fpd-module-images"),e.append(this.container);const i=Array.from(this.container.querySelectorAll(".fpd-module-tabs > div")),s=Array.from(this.container.querySelectorAll(".fpd-module-tabs-content > div"));let a=null,o=null;c(i,"click",e=>{const t=e.currentTarget;u(i,["fpd-active"]),u(s,["fpd-active"]),r(t,["fpd-active"]),r(s.find(e=>e.dataset.context==t.dataset.context),["fpd-active"]),"instagram"==t.dataset.context&&a&&!a.accessToken?a.authenticate():"pixabay"==t.dataset.context&&o&&o.loadImages()});e=n.mainOptions;new q(n,s.find(e=>"upload"==e.dataset.context)),c(n,["viewSelect","secondaryModuleCalled"],i=>{if(n.currentViewInstance){let e=n.currentViewInstance.options,t=null;if(n.currentViewInstance.currentUploadZone){const i=n.currentViewInstance.getUploadZone(n.currentViewInstance.currentUploadZone);i&&i.price&&(t=i.price)}null==t&&e.customImageParameters&&e.customImageParameters.price&&(t=n.formatPrice(e.customImageParameters.price));var s=this.container.querySelector(".fpd-upload-zone .fpd-price");s&&(s.innerHTML=t||"")}}),g(e.facebookAppId)||(new B(n,s.find(e=>"facebook"==e.dataset.context)),i.find(e=>"facebook"==e.dataset.context).classList.remove("fpd-hidden")),g(e.instagramClientId)||(a=new z(n,s.find(e=>"instagram"==e.dataset.context)),i.find(e=>"instagram"==e.dataset.context).classList.remove("fpd-hidden")),g(e.pixabayApiKey)||(o=new F(n,s.find(e=>"pixabay"==e.dataset.context)),i.find(e=>"pixabay"==e.dataset.context).classList.remove("fpd-hidden")),i.filter(e=>!e.classList.contains("fpd-hidden")).length<2&&this.container.classList.add("fpd-hide-tabs")}}class R extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-layers" data-defaulttext="Manage Layers" data-title="modules.manage_layers"> <div class="fpd-scroll-area"> <div class="fpd-list"></div> </div> </div>'}}customElements.define("fpd-module-manage-layers",R);class j extends EventTarget{#F=null;constructor(t,e){super(),this.fpdInstance=t,this.container=document.createElement("fpd-module-manage-layers"),e.append(this.container),this.listElem=this.container.querySelector(".fpd-list"),c(t,"viewSelect",()=>{this.#H()}),c(t,"elementAdd",e=>{t.productCreated&&this.#H()})}#H(){this.listElem.innerHTML="",this.fpdInstance.getElements(this.fpdInstance.currentViewIndex).forEach(e=>{b(e)&&this.#z(e)}),this.#F&&this.#F.dispose();let i;this.#F=AreaSortable("vertical",{container:this.listElem,handle:"fpd-icon-reorder",item:"fpd-list-row",placeholder:"fpd-sortable-placeholder",activeItem:"fpd-sortable-dragged",closestItem:"fpd-sortable-closest",autoscroll:!0,animationMs:0,onStart:e=>{const t=window.pageYOffset||document.documentElement.scrollTop||0;window.onscroll=()=>{window.scrollTo({top:t})},i=e.offsetTop},onChange:e=>{var t=this.fpdInstance.currentViewInstance.fpdCanvas,i=t.getElementByID(e.id),s=this.listElem.querySelector(".fpd-sortable-closest"),e=t.getElementByID((s||e).id);let n=t.getZIndex(e);s||n++,t.setElementParameters({z:n},i)},onEnd:e=>{window.onscroll=()=>{},Array.from(this.listElem.querySelectorAll(".fpd-list-row")).indexOf(e),console.log(e.offsetTop)}})}#z(t){const i=document.createElement("div");i.className="fpd-list-row",i.id=t.id;let e=document.createElement("span"),s=null;if(r=t,(Array.isArray(r.colors)||Boolean(r.colors)||r.colorLinkGroup||r.__editorMode)&&!1!==(r=r,"text"===f(r.type)?"text":!!r.source&&(1==(o=r.source.split(".")).length?-1==o[0].search("data:image/png;")?r.fill=r.colors=!1:"dataurl":(o=r.source.split("?")[0].split(".")).includes("png")||v(r)?v(r)?"svg":"png":r.fill=r.colors=!1))){s=((e,t)=>{var i=[];if("group"==e.type){console.log(e);const t=e.getObjects();if(1===t.length)i=e.colors;else for(var i=[],s=0;s<t.length;++s){var n=t[s],n=tinycolor(n.fill);i.push(n.toHexString())}}else i=(e.colorLinkGroup&&t.colorLinkGroups[e.colorLinkGroup]?t.colorLinkGroups[e.colorLinkGroup]:e).colors;return i})(t,this.fpdInstance);const n=(e=>{let t=e.fill;return"string"==typeof t?t:"object"==typeof t?t.source?"url("+(t=t.source.src)+")":t[0]:!0===e.colors&&"group"===e.type?tinycolor(e.getObjects()[0].fill):!1===t&&e.colors&&e.colors[0]?e.colors[0]:void 0})(t);e.style.background=n,e.className="fpd-current-color",i.colors=s}const n=document.createElement("div");n.className="fpd-cell-0",n.append(e),i.append(n);let a=t.title;"text"===f(t.type)&&t.editable&&((a=document.createElement("textarea")).innerText=t.text);var o=document.createElement("div"),r=(o.className="fpd-cell-1",o.append(a),i.append(o),document.createElement("div"));if(r.className="fpd-cell-2",i.append(r),t.zChangeable){const t=document.createElement("span");t.className="fpd-icon-reorder",r.append(t)}var d=t.locked?"fpd-icon-locked-full":"fpd-icon-unlocked",l=document.createElement("span");if(l.className="fpd-lock-element",l.innerHTML=`<span class="${d}"></span>`,r.append(l),c(l,"click",e=>{e.stopPropagation(),u(i,["fpd-show-colors"]),t.evented=!t.evented,t.locked=!t.evented;e=e.currentTarget.querySelector("span");console.log(e),m(e,["fpd-icon-unlocked"],t.evented),m(e,["fpd-icon-locked-full"],!t.evented),m(i,["fpd-locked"],!t.evented),console.log(t)}),m(i,["fpd-locked"],t.locked),t.removable||t.__editorMode){const e=document.createElement("span");e.className="fpd-remove-element",e.innerHTML='<span class="fpd-icon-remove"></span>',r.append(e),c(e,"click",e=>{e.stopPropagation(),this.fpdInstance.currentViewInstance.fpdCanvas.removeElement(t),i.remove()})}if(this.listElem.append(i),s){const t=document.createElement("div");if(t.className="fpd-cell-full",i.append(t),1===s.length){const i=document.createElement("div");i.className="fpd-colorpicker-wrapper",t.append(i),new Picker({parent:i,popup:!1,alpha:!1,color:s[0],onChange:e=>{console.log(e.rgbaString)}})}c(i.querySelector(".fpd-current-color"),"click",e=>{m(i,["fpd-show-colors"],!i.classList.contains("fpd-show-colors"))})}c(i,"click",e=>{var t=e.currentTarget;t.classList.contains("fpd-locked")||"TEXTAREA"==e.target.nodeName||(e=this.fpdInstance.getElementByID(t.id))&&e.canvas.setActiveObject(e).renderAll()})}}class V extends EventTarget{constructor(t,i,s){let n;if(super(),"products"===s)n=new S(t,i);else if("text"===s)n=new T(t,i);else if("text-to-image"===s)n=new P(t,i);else if(s.includes("designs")){let e=null;if(s.includes("designs_")&&!g(t.mainOptions.dynamicDesigns)){if(!(e=s.split("_").pop())||!t.mainOptions.dynamicDesigns[e])return;{var a=t.mainOptions.dynamicDesigns[e];const i={};i["data-dynamic-designs-id"]=e,!g(a.icon)&&a.icon.includes(".svg")&&(this.configs={icon:a.icon,defaultText:a.name,attrs:i})}}n=new k(t,i,e)}else"images"===s?n=new D(t,i):"manage-layers"===s&&(n=new j(t,i));if(n&&(this.moduleInstance=n,t["moduleInstance_"+s]=n,!s.includes("designs_"))){const t=n.container.querySelector("div");this.configs={icon:t.dataset.moduleicon,langId:t.dataset.title,langKeys:t.dataset.title.split("."),defaultText:t.dataset.defaulttext}}}}class W extends EventTarget{#B=null;#q=null;#N=!1;#R=0;#j=0;#V=0;#W=0;#Z=!1;#X=!1;contentElem=null;navElem=null;currentModuleKey="";constructor(e){super();var t=(this.fpdInstance=e).container;if(this.container=document.createElement("fpd-main-bar"),t.append(this.container),this.contentElem=this.container.querySelector(".fpd-module-content"),this.navElem=this.container.querySelector(".fpd-navigation"),this.currentModules=e.mainOptions.mainBarModules,this.#B=document.querySelector(this.fpdInstance.mainOptions.modalMode?".fpd-modal-product-designer":"body"),this.#q=document.querySelector(".fpd-draggable-dialog"),this.#B.append(this.#q),c(this.#q,["mousedown","touchstart"],this.#J.bind(this)),c(this.#q,["mouseup","touchend"],this.#G.bind(this)),c(document,["mousemove","touchmove"],this.#Y.bind(this)),c(this.#q.querySelector(".fpd-close-dialog"),["click","touchstart"],this.#$.bind(this)),c(this.container.querySelector(".fpd-close-off-canvas"),"click",this.#$.bind(this)),c(e,"viewSelect",()=>{this.toggleContentDisplay(!1)}),t.classList.contains("fpd-off-canvas")){let t=0,i=0;this.contentElem.addEventListener("touchstart",e=>{t=e.touches[0].pageX,r(this.container,["fpd-is-dragging"])}),this.contentElem.addEventListener("touchmove",e=>{e.preventDefault();e=e.touches[0].pageX;i=t-e,i=Math.abs(i)<0?0:Math.abs(i),this.contentElem.style.left=-i+"px",this.contentElem.previousElementSibling.style.left=this.contentElem.clientWidth-i+"px"}),this.contentElem.addEventListener("touchend",e=>{100<Math.abs(i)?this.toggleContentDisplay(!1):(this.contentElem.style.left="0px",this.contentElem.previousElementSibling.style.left=this.contentElem.clientWidth+"px"),i=0,u(this.container,["fpd-is-dragging"])})}this.updateContentWrapper(),this.setup(this.currentModules)}#J(e){this.#q.querySelector(".fpd-dialog-drag-handle").contains(e.target)&&(e.preventDefault(),this.#N=!0,this.#R=(e.touches?event.touches[0]:e).clientX,this.#j=(e.touches?event.touches[0]:e).clientY,this.#V=this.#R-this.#q.offsetLeft,this.#W=this.#j-this.#q.offsetTop)}#Y(i){if(this.#N){var s=this.#B.clientWidth<window.innerWidth?window.innerWidth:this.#B.clientWidth,n=this.#B.clientHeight<window.innerHeight?window.innerHeight:this.#B.clientHeight,s=s-this.#q.clientWidth,n=n-this.#q.clientHeight,a=(i.touches?event.touches[0]:i).clientX;let e=(i.touches?event.touches[0]:i).clientY-this.#W,t=a-this.#V;t<0&&(t=0),e<0&&(e=0),t>s&&(t=s),e>n&&(e=n),this.#q.style.top=e+"px",this.#q.style.left=t+"px"}}#G(e){this.#N=!1}#K(e){e.stopPropagation(),this.fpdInstance.deselectElement(),this.fpdInstance.currentViewInstance&&(this.fpdInstance.currentViewInstance.currentUploadZone=null),e.currentTarget.classList.contains("fpd-active")&&this.contentClosable?this.toggleContentDisplay(!1):this.callModule(e.currentTarget.dataset.module,e.currentTarget.dataset.dynamicDesignsId)}#$(){this.fpdInstance.currentViewInstance&&this.fpdInstance.currentViewInstance.currentUploadZone&&this.fpdInstance.currentViewInstance.deselectElement(),this.toggleContentDisplay(!1)}callModule(e,t=null){let i;u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),u(Array.from(this.contentElem.children),["fpd-active"]),t?(i=r(this.navElem.querySelector('.fpd-nav-item[data-dynamic-designs-id="'+t+'"]'),["fpd-active"]),r(this.contentElem.querySelector('[data-dynamic-designs-id="'+t+'"]'),["fpd-active"])):(i=r(this.navElem.querySelector('.fpd-nav-item[data-module="'+e+'"]'),["fpd-active"]),r(this.contentElem.querySelector("fpd-module-"+e),["fpd-active"])),this.toggleContentDisplay(),this.currentModuleKey=e}get contentClosable(){var e=this.fpdInstance.container;return this.#X||this.#Z||e.classList.contains("fpd-layout-small")}callSecondary(){this.callModule("secondary")}toggleContentDisplay(e=!0){var t=this.fpdInstance.container;m(t,["fpd-module-visible"],e),this.contentClosable&&!e&&u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),this.#X?(!e&&this.currentModuleKey.length&&this.fpdInstance.deselectElement(),this.contentElem.style.removeProperty("left"),this.contentElem.previousElementSibling.style.removeProperty("left"),this.contentElem.style.height=this.fpdInstance.mainWrapper.container.clientHeight+"px",this.container.classList.toggle("fpd-show",e)):this.#Z&&(e&&(this.#q.querySelector(".fpd-dialog-title").innerText=this.navElem.querySelector(".fpd-nav-item.fpd-active .fpd-label").innerText),this.#q.classList.toggle("fpd-show",e)),e||(this.currentModuleKey="")}updateContentWrapper(){var e=this.fpdInstance.container;this.toggleContentDisplay(!1),this.#X=!1,this.#Z=!1,u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),(e.classList.contains("fpd-off-canvas")?(this.#X=!0,this.container):e.classList.contains("fpd-sidebar")?this.container:(this.#Z=!0,this.#q)).append(this.contentElem)}toggleUploadZonePanel(e=!0){this.fpdInstance.loadingCustomImage||(e?this.callSecondary("fpd-upload-zone-adds-panel"):(this.fpdInstance.currentViewInstance.currentUploadZone=null,this.toggleContentDisplay(!1)))}toggleUploadZoneAdds(e){}setup(e=[]){let t=this.fpdInstance.mainOptions.initialActiveModule||"";const o=this.container.querySelector(".fpd-navigation");this.currentModules.length<=1&&!this.fpdInstance.container.classList.contains("fpd-topbar")?(t=this.currentModules[0]||"",o.classList.add("fpd-hidden")):this.fpdInstance.container.classList.contains("fpd-sidebar")&&""==t?t=this.currentModules[0]||"":o.classList.remove("fpd-hidden"),o.innerHTML=this.contentElem.innerHTML="",e.forEach(e=>{let i="";var s=new V(this.fpdInstance,this.contentElem,e);if(s.moduleInstance){var n,a=document.createElement("div");a.classList.add("fpd-nav-item"),a.dataset.module=e,a.addEventListener("click",this.#K.bind(this)),o.appendChild(a);let t=document.createElement("span");if(s.configs.icon.includes(".svg")?(n={url:s.configs.icon,onSuccess:e=>{t.innerHTML=e},onError:e=>{console.log(e)}},fetch(n.url).then(e=>{e.ok?e.text().then(e=>{n.onSuccess&&n.onSuccess(e)}):e.text().then(e=>{n.onError&&n.onError(e)})})):(t.classList.add("fpd-nav-icon"),t.classList.add(s.configs.icon)),a.append(t),s.configs.langKeys){const e=s.configs.langKeys;i=this.fpdInstance.translator.getTranslation(e[0],e[1],this.fpdInstance.mainOptions.langJson,s.configs.defaultText)}else s.configs.defaultText&&(i=s.configs.defaultText);e=document.createElement("span");if(e.className="fpd-label",e.innerText=i,a.append(e),s.configs.attrs)for(const[e,i]of Object.entries(s.configs.attrs))a.setAttribute(e,i)}}),this.contentClosable||o.querySelector(`[data-module="${t}"]`).click()}}class Z extends HTMLElement{constructor(){super()}connectedCallback(){var e=document.createElement("template");e.innerHTML='<div class="fpd-snap-line-h"></div> <div class="fpd-snap-line-v"></div> <div class="fpd-product-stage"></div>',this.append(e.content.cloneNode(!0))}}customElements.define("fpd-main-wrapper",Z);class X{constructor(e){this.container=document.createElement("fpd-main-wrapper"),e.container.append(this.container)}}ee(561);class J extends EventTarget{constructor(e){super(),this.container=document.createElement("fpd-actions-bar"),e.container.append(this.container)}}class G extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<span class="fpd-view-prev"> <span class="fpd-icon-forward"></span> </span> <div class="fpd-views-selection"></div> <span class="fpd-view-next"> <span class="fpd-icon-forward"></span> </span> '}}customElements.define("fpd-views-wrapper",G);class Y extends EventTarget{constructor(e){super(),this.container=document.createElement("fpd-views-wrapper"),e.container.classList.contains("fpd-views-outside")||e.mainOptions.modalMode?e.container.after(this.container):e.mainWrapper.container.append(this.container)}}class K extends EventTarget{#Q=0;constructor(e){super(),this.fpdInstance=e}init(){this.#ee(),this.fpdInstance.container.classList.add("fpd-container"),this.fpdInstance.container.classList.add("fpd-wrapper");var e=document.createElement("div");e.innerHTML='<div class="fpd-loader-wrapper"> <div class="fpd-loader"> <div class="fpd-loader-circle"></div> <span class="fpd-loader-text" data-defaulttext="Initializing Product Designer">misc.initializing</span> </div> </div>',this.fpdInstance.container.appendChild(e.firstChild.cloneNode(!0)),this.fpdInstance.mainLoader=this.fpdInstance.container.querySelector(".fpd-loader-wrapper"),this.fpdInstance.actionsBar=new J(this.fpdInstance),this.fpdInstance.mainBar=new W(this.fpdInstance),this.fpdInstance.mainWrapper=new X(this.fpdInstance),this.fpdInstance.productStage=this.fpdInstance.mainWrapper.container.querySelector(".fpd-product-stage"),this.fpdInstance.viewsWrapper=new Y(this.fpdInstance),Array.from(this.fpdInstance.container.querySelectorAll("[data-defaulttext]")).forEach(e=>{this.fpdInstance.translator.translateElement(e,this.fpdInstance.mainOptions.langJson)}),this.dispatchEvent(new CustomEvent("ready")),window.addEventListener("resize",this.#ee.bind(this))}#ee(){var e=this.fpdInstance.mainOptions.responsiveBreakpoints;this.#Q=window.innerWidth,this.#Q<e.small?(this.fpdInstance.container.classList.remove("fpd-layout-medium"),this.fpdInstance.container.classList.remove("fpd-layout-large"),this.fpdInstance.container.classList.add("fpd-layout-small")):this.#Q<e.medium?(this.fpdInstance.container.classList.remove("fpd-layout-small"),this.fpdInstance.container.classList.remove("fpd-layout-large"),this.fpdInstance.container.classList.add("fpd-layout-medium")):(this.fpdInstance.container.classList.remove("fpd-layout-medium"),this.fpdInstance.container.classList.remove("fpd-layout-small"),this.fpdInstance.container.classList.add("fpd-layout-large"))}}class Q extends EventTarget{static forbiddenTextChars=/<|>/g;container=null;mainOptions={};currentViewInstance=null;currentViewIndex=0;products=[];designs=[];modalContainer=document.body;currentCategoryIndex=0;currentProductIndex=0;viewInstances=[];currentViews=null;productCreated=!1;colorLinkGroups={};globalCustomElements=[];doUnsavedAlert=!1;loadingCustomImage=!1;lazyBackgroundObserver=null;#te=[];#ie=0;#se=0;#ne=!1;constructor(e,t={}){super(),this.lazyBackgroundObserver=new IntersectionObserver((e,t)=>{e.forEach(e=>{var t,i,s;e.isIntersecting&&(t=e.target,i=null,t&&(t.classList.add("fpd-on-loading"),(s=new Image).src=i||t.dataset.img,s.onload=function(){t.dataset.originwidth=this.width,t.dataset.originheight=this.height,t.classList.remove("fpd-on-loading"),t.style.backgroundImage='url("'+this.src+'")'},s.onerror=function(){t.parentNode.remove()}),this.lazyBackgroundObserver.unobserve(e.target))})}),this.container=e,(this.container.instance=this).mainOptions=a.merge(a.defaults,t),this.currentViewInstance={options:{...this.mainOptions}},this.translator=new i,this.translator.loadLangJSON(this.mainOptions.langJson,this.#ae.bind(this))}#ae(){this.uiManager=new K(this),this.uiManager.addEventListener("ready",e=>{this.#oe()}),this.uiManager.init()}#oe(){(class{static parseFontsToEmbed(e,t=""){var i="";if(e.hasOwnProperty("url")){e.name;var s=-1!==e.url.search(".woff")?"woff":"TrueType",n=t?t+e.url:e.url;if(i+='@font-face {font-family:"'+e.name+'"; font-style: normal; font-weight: normal; src:url("'+n+'") format("'+s+'");}\n',e.variants){for(const a in e.variants)n=t+e.variants[a],i+='@font-face {font-family:"'+e.name+'"; '+{n7:"font-style: normal; font-weight: bold;",i4:"font-style: italic; font-weight: normal;",i7:"font-style: italic; font-weight: bold;"}[a]+' src:url("'+n+'") format("'+s+'");}\n';Object.keys(e.variants).toString()}}return i}static load(i,o){var e=i.mainOptions.fonts;if(e&&0<e.length&&"object"==typeof e[0]){e.sort((e,t)=>{e=e.name.toUpperCase(),t=t.name.toUpperCase();return e<t?-1:t<e?1:0});let s=[],n=[],a=0;const d=document.createElement("style");d.id="fpd-fonts",i.container.before(d),e.forEach(e=>{var t;e.hasOwnProperty("url")&&("google"==e.url?s.push(e.name+":400,400i,700,700i"):(t=e.name,t+=":n4",e.variants&&(t+=","+Object.keys(e.variants).toString()),n.push(t),d.append(this.parseFontsToEmbed(e,i.mainOptions._loadFromScript))))});var r=function(e,t,i){"inactive"==e&&console.log(t+" font could not be loaded."),a==s.length+n.length-1&&o(),a++},e={fontactive:function(e,t){r("active",e)},fontinactive:function(e,t){r("inactive",e)},timeout:3e3};0<s.length&&(e.google={families:s}),0<n.length&&(e.custom={families:n}),"undefined"!=typeof WebFont&&(0<s.length||0<n.length)?WebFont.load(e):o()}else o()}}).load(this,()=>{this.#re()})}#re(){setTimeout(()=>{this.dispatchEvent(new CustomEvent("uiSet"))},1),this.#de()}#de(){this.dispatchEvent(new CustomEvent("ready")),this.mainOptions.productsJSON&&("object"==typeof this.mainOptions.productsJSON?this.setupProducts(this.mainOptions.productsJSON):E({url:this.mainOptions.productsJSON,onSuccess:e=>{this.setupProducts(e)},onError:()=>{alert("Products JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.productsJSON)}})),this.mainOptions.designsJSON&&("object"==typeof this.mainOptions.productsJSON?this.setupDesigns(this.mainOptions.designsJSON):E({url:this.mainOptions.designsJSON,onSuccess:e=>{this.setupDesigns(e)},onError:()=>{alert("Design JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.designsJSON)}}));let t=0;c(window,"resize",e=>{window.innerWidth===t||this.#ne||(t=window.innerWidth,this.currentViewInstance&&this.currentViewInstance.resetSize())})}#le(t){var e=this.products.findIndex(e=>e.category===t);return-1!==e&&e}setupProducts(e=[]){this.products=[],e.forEach(t=>{t.hasOwnProperty("category")?t.products.forEach(e=>{this.addProduct(e,t.category)}):this.addProduct(t)}),this.mainOptions.loadFirstProductInStage&&0<e.length?this.selectProduct(0):this.toggleSpinner(!1),this.toggleSpinner(!1),this.dispatchEvent(new CustomEvent("productsSet"))}setupDesigns(e){this.designs=e,this.dispatchEvent(new CustomEvent("designsSet"))}addProduct(e,t){var i=this.#le(t);(void 0===t?this:(!1===i&&(i=this.products.length,this.products[i]={category:t,products:[]}),this.products[i])).products.push(e),this.dispatchEvent(new CustomEvent("productAdd",{detail:{views:e,category:t,catIndex:i}}))}selectProduct(e,t){this.currentCategoryIndex=void 0===t?this.currentCategoryIndex:t,t=(this.products&&this.products.length&&this.products[0].category?this.products[this.currentCategoryIndex]:instance).products,(this.currentProductIndex=e)<0?this.currentProductIndex=0:e>t.length-1&&(this.currentProductIndex=t.length-1);e=t[this.currentProductIndex];this.dispatchEvent(new CustomEvent("productSelect",{detail:{product:e}})),this.loadProduct(e,this.mainOptions.replaceInitialElements)}loadProduct(e,t=!1,i=!1){e&&(this.toggleSpinner(!0),this.#te=[],this.viewInstances.forEach(e=>{}),this.productCreated=!1,this.colorLinkGroups={},this.globalCustomElements=[],t?this.globalCustomElements=this.getCustomElements():this.doUnsavedAlert=!1,this.fixedElements=this.getFixedElements(),this.reset(),i&&e.forEach((e,t)=>{e.options=a.merge(this.mainOptions,e.options)}),this.currentViews=e,this.#ie=this.#se=0,e.forEach((e,t)=>{this.#ie+=e.elements.length}),c(this,"viewCreate",this.#ce),e)&&this.addView(e[0])}addView(e){const t=this.mainOptions._loadFromScript?this.mainOptions._loadFromScript+e.thumbnail:e.thumbnail,i=document.createElement("div");i.className="fpd-shadow-1 fpd-item fpd-tooltip",i.title=e.title,i.innerHTML='<picture style="background-image: url('+t+');"></picture>',this.viewsWrapper.container.querySelector(".fpd-views-selection").append(i),c(i,"click",e=>{var t=Array.from(this.viewsWrapper.container.querySelectorAll(".fpd-views-selection > div")).indexOf(i);this.selectView(t)});let s={};w.relevantOptions.forEach(e=>{var t=this.mainOptions[e];s[e]=n(t)?{...t}:t}),e.options=n(e.options)?p(s,e.options):s;e=new w(this.productStage,e,e=>{this.viewInstances.length,this.viewInstances.push(e),c(e,"sizeUpdate",e=>{e=e.currentTarget.fabricCanvas.height+"px";this.productStage.style.height=e,this.container.classList.contains("fpd-sidebar")&&(this.mainBar.container.style.height=e)}),this.dispatchEvent(new CustomEvent("viewCreate",{detail:{viewInstance:e}}))},this.mainOptions.fabricCanvasOptions);c(e.fpdCanvas,"elementAdd",e=>{e=e.detail.element;e?this.dispatchEvent(new CustomEvent("elementAdd",{detail:{element:e}})):this.toggleSpinner(!1)}),e.init()}toggleSpinner(e=!0,t=""){return this.mainLoader.querySelector(".fpd-loader-text").innerText=t,this.mainLoader.classList.toggle("fpd-hidden",!e),this.mainLoader}selectView(e=0){this.viewInstances.length<=0||(this.currentViewIndex=e,this.currentViewInstance,this.currentViewInstance=this.viewInstances[this.currentViewIndex],this.deselectElement(),e=this.productStage.querySelectorAll(".fpd-view-stage"),r(e,["fpd-hidden"]),u(e.item(this.currentViewIndex),["fpd-hidden"]),this.currentViewInstance.resetSize(),this.dispatchEvent(new CustomEvent("viewSelect")))}getElements(e,t="all",i=!0){e=void 0===e||isNaN(e)?-1:e,i&&this.deselectElement();let s=[];if(-1===e)for(var n=0;n<this.viewInstances.length;++n)s=s.concat(this.viewInstances[n].fabricCanvas.getObjects());else{if(!this.viewInstances[e])return[];s=this.viewInstances[e].fabricCanvas.getObjects()}var a,o;return s=s.filter(e=>!e._ignore),"text"===t?(a=[],s.forEach(e=>{"text"===f(e.type)&&a.push(e)}),a):"image"===t?(o=[],s.forEach(function(e){"image"===f(e.type)&&o.push(e)}),o):s}getCustomElements(e=0,t,i){return[]}getFixedElements(e=0,t,i){return[]}getElementByID(e,t){return t=void 0===t?this.currentViewIndex:t,this.viewInstances[t]?this.viewInstances[t].fpdCanvas.getElementByID(e):null}reset(){this.currentViews}deselectElement(){}formatPrice(n){var a=this.mainOptions.priceFormat;if(n&&"object"==typeof a){var o=a.thousandSep,r=a.decimalSep;let e=n.toString().split("."),t=e[0],i=e[1],s="";if(void 0!==t){for(var d=t.length-1;0<=d;d--)s+=t.charAt(d);for((s=s.replace(/(\d{3})/g,"$1"+o)).slice(-o.length)==o&&(s=s.slice(0,-o.length)),t="",d=s.length-1;0<=d;d--)t+=s.charAt(d);void 0!==i&&0<i.length&&(1==i.length&&(i+="0"),t+=r+i)}return t=a.currency.replace("%d",t.toString())}return n=n&&a.priceFormat.replace("%d",n)}#ce(){this.viewInstances.length<this.currentViews.length?this.addView(this.currentViews[this.viewInstances.length]):(this.removeEventListener("viewCreate",this.#ce),this.toggleSpinner(!1),this.selectView(0))}_addGridItemToCanvas(e,t=0,i){i=void 0===i?this.currentViewIndex:i,this.currentViewInstance}_addCanvasImage(e,t,i={},s=!1,n){var a;n=void 0===n?this.currentViewIndex:n,this.currentViewInstance&&((a=this.mainOptions.customImageAjaxSettings).data&&a.data.saveOnServer&&s?_downloadRemoteImage(e,t,i):(this.loadingCustomImage=!0,this.addCustomImage(e,t,i,n)),this.productCreated)&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleDialog(!1)}}window.FancyProductDesigner=Q})()})();