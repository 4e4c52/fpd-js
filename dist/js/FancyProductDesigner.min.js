function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function createPngDataTable(){for(var t=new Int32Array(256),e=0;e<256;e++){for(var n=e,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}function calcCrc(t){var e=-1;pngDataTable=pngDataTable||createPngDataTable();for(var n=0;n<t.length;n++)e=pngDataTable[255&(e^t[n])]^e>>>8;return-1^e}!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.AreaSortable=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var rt="$areaSortable",ot="rect",at="scroll",st="style",lt="margin",ht="padding",ut="left",ct="right",ft="width",dt="top",pt="bottom",gt="height",mt="nextElementSibling",bt="previousElementSibling",vt="scrollTop",_t="scrollLeft",yt=1,wt=2,St=yt+wt,Ct=Math,Pt=String,_=parseInt,i=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n=/^\s+|\s+$/g,P=/mousedown|pointerdown/,l=Pt.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(n,"")},r=null;function At(t,e){return t<0?-1:0<t?1:e||0}function y(t){return"function"==typeof t}function w(t){return"[object String]"===e.call(t)}function h(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function S(t,e,n,i){null==r&&(r=h()),t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,r?i:"object"==typeof i?!!i.capture:!!i)}function a(t,e,n,i){null==r&&(r=h()),t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,r?i:"object"==typeof i?!!i.capture:!!i)}function C(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function xt(t,e){t.classList?t.classList.add(e):C(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function Mt(t,e){t.classList?t.classList.remove(e):t.className=l((" "+t.className+" ").replace(" "+e+" "," "))}function Et(t,e){return 0!==t[e]||(t[e]=1)===t[e]&&(t[e]=0,1)}function Tt(t){return(y(window.getComputedStyle)?window.getComputedStyle(t,null):t.currentStyle)||{}}function Dt(t,e,n){return t.elementsFromPoint(e,n)}function Lt(n,t){return t.reduce(function(t,e){return t[e]=n[st].getPropertyValue(e),t},{})}function Rt(e,t,n){n=n||e[rt][st],t.forEach(function(t){i.call(n,t)&&""!==n[t]?e[st][t]=n[t]:e[st].removeProperty(t)})}function It(e,t,n){var i,r,o,a;0<t&&(e[rt]&&e[rt].animation&&e[rt].animation.stop(),i="transform "+Pt(t)+"ms",r="translate3d(0,0,0)",o=null,a=function t(){o&&clearTimeout(o),o=null,e[rt]&&e[rt].animation&&t===e[rt].animation.stop&&(e[rt].animation=null),e[st].transform===r&&e[st].transition===i&&(e[st].transition="none",e[st].transform="none")},e[st].transition="none",e[st].transform="translate3d("+Pt(-(n[ut]||0))+"px,"+Pt(-(n[dt]||0))+"px,0)",e.offsetWidth,e[st].transform=r,e[st].transition=i,o=setTimeout(a,t),e[rt].animation={stop:a})}function kt(t,e,n,i,r){return t=t[rt].r,e=e[rt][ot],Ct.max(0,Ct.min(1,Ct.max(0,Ct.min(t[i]+t[r],e[i]-n[i]+e[r])-Ct.max(t[i],e[i]-n[i]))/Ct.min(t[r],e[r])))}function Ft(t,e,n,i,r){var t=t[rt].r,e=e[rt][ot],o=Ct.max(0,Ct.min(t[ut]+t[ft],e[ut]-n[ut]+e[ft])-Ct.max(t[ut],e[ut]-n[ut])),n=Ct.max(0,Ct.min(t[dt]+t[gt],e[dt]-n[dt]+e[gt])-Ct.max(t[dt],e[dt]-n[dt]));return Ct.max(0,Ct.min(1,o*n/(Ct.min(t[ft],e[ft])*Ct.min(t[gt],e[gt]))))}function o(A,x){function E(t,e,n){n<0?(k===e&&(k=t),L===t&&(L=T[bt]),O.insertBefore(t,e)):0<n&&(k===t&&(k=t[mt]),e[mt]?O.insertBefore(t,e[mt]):(O.appendChild(t),L=t)),t[rt].index=e[rt].index,O.insertBefore(T,t),y(A.options.onChange)&&A.options.onChange(t)}function t(t){if(f&&!b&&A.options.container&&(!P.test(t.type)||0===t.button))if(g(),(u=t.target)&&C(u,A.options.handle||"dnd-sortable-handle"))if(M=function(t,e){if(t.closest)return t.closest("."+e);for(;t;){if(C(t,e))return t;t=t.parentNode}}(u,A.options.item||"dnd-sortable-item"))if(!(O=M.parentNode)||w(A.options.container)&&O.id!==A.options.container||!w(A.options.container)&&O!==A.options.container)g();else if(y(A.options.onStart)&&A.options.onStart(M),y(A.options.itemFilter)&&!(M=A.options.itemFilter(M)))g();else{b=!0,Y=M.ownerDocument||document,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),d=t.touches&&t.touches.length;var e,r=0,o=0,a=ut,s=ft,l=ct,n=(O.tagName||"").toLowerCase();if(I=(e=Y).scrollingElement||e.documentElement||e.body,F=null,A.options.autoscroll)for(F=O;F&&!(I===F||wt!==x&&F.scrollHeight>F.clientHeight&&Et(F,vt)||yt!==x&&F.scrollWidth>F.clientWidth&&Et(F,_t));)F=F.parentNode;O[rt]={rect:O.getBoundingClientRect(),scroll:{top:O[vt]||0,left:O[_t]||0,width:O.scrollWidth,height:O.scrollHeight,top0:O[vt]||0,left0:O[_t]||0},$:Tt(O),style:Lt(O,["width","height","max-width","max-height","box-sizing","padding-left","padding-top","padding-right","padding-bottom"])},O[rt][ht]={left:_(O[rt].$.paddingLeft)||0,right:_(O[rt].$.paddingRight)||0},F&&F!==O&&(F[rt]={rect:F.getBoundingClientRect(),scroll:{top:F[vt]||0,left:F[_t]||0,width:F.scrollWidth,height:F.scrollHeight,top0:F[vt]||0,left0:F[_t]||0}}),(c=[].map.call(O.children,function(t,e){var n=t.getBoundingClientRect(),i=Tt(t);return t[rt]={index:e,line:0,prev:{},rect:{top:n[dt],left:n[ut],width:n[ft],height:n[gt]},r:{top:n[dt],left:n[ut],width:n[ft],height:n[gt]},margin:{top:_(i.marginTop)||0,right:_(i.marginRight)||0,bottom:_(i.marginBottom)||0,left:_(i.marginLeft)||0},$:i,style:Lt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),animation:null},e=t[rt][lt][a]+t[rt][ot][s]+t[rt][lt][l],0<o&&O[rt][ht][a]+o+e+O[rt][ht][l]>O[rt][ot][s]&&(r++,o=0),t[rt].line=r,o+=e,t})).length&&(k=c[0],L=c[c.length-1]),a=dt,s=gt,l=pt,R=new Array(c.length),c.forEach(function(t){var e=t[rt].line,t=t[rt][ot][a]-t[rt][lt][a]-O[rt][ot][a]+O[rt][at][a];R[e]=null==R[e]?t:Ct.min(t,R[e])}),xt(O,A.options.activeArea||"dnd-sortable-area"),O[st].boxSizing="border-box",O[st][ft]=Pt(O[rt][ot][ft])+"px",O[st][gt]=Pt(O[rt][ot][gt])+"px",O[st].maxWidth=Pt(O[rt][ot][ft])+"px",O[st].maxHeight=Pt(O[rt][ot][gt])+"px",M.draggable=!1,xt(M,A.options.activeItem||"dnd-sortable-dragged"),et=!0,c.forEach(function(t){var e=c[0];t[st].position="absolute",t[st].boxSizing="border-box",t[st].overflow="hidden",t[st][dt]=Pt(t[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt]-t[rt][lt][dt])+"px",t[st][ut]=Pt(t[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut]-t[rt][lt][ut])+"px",t[st][ft]=Pt(t[rt][ot][ft])+"px",t[st][gt]=Pt(t[rt][ot][gt])+"px",t[rt][ot][ft]===e[rt][ot][ft]&&t[rt][ot][gt]===e[rt][ot][gt]&&t[rt][lt][dt]===e[rt][lt][dt]&&t[rt][lt][pt]===e[rt][lt][pt]&&t[rt][lt][ut]===e[rt][lt][ut]&&t[rt][lt][ct]===e[rt][lt][ct]||(et=!1)}),xt(T=Y.createElement("ul"===n||"ol"===n?"li":"tr"===n?"td":"tbody"===n||"thead"===n||"tfoot"===n||"table"===n?"tr":"span"),A.options.placeholder||"dnd-sortable-placeholder"),T[st].position="absolute",T[st].display="block",T[st].boxSizing="border-box",T[st].margin="0",O===F&&(O[st].paddingLeft=Pt(O[rt][at][ft]-O[rt][ot][ft])+"px",O[st].paddingTop=Pt(O[rt][at][gt]-O[rt][ot][gt])+"px",O[st].paddingRight="0px",O[st].paddingBottom="0px",O[_t]=O[rt][at][ut],O[vt]=O[rt][at][dt]),d?(S(Y,"touchmove",i,!1),S(Y,"touchend",h,!1),S(Y,"touchcancel",h,!1)):(S(Y,"mousemove",i,!1),S(Y,"mouseup",h,!1)),v=setInterval(m,60),K=G=(d?t.touches[0]:t).clientX,Q=J=(d?t.touches[0]:t).clientY,N=G,B=J,W=U=j=H=0,O.insertBefore(T,M),T[st][ft]=Pt(M[rt][ot][ft])+"px",T[st][gt]=Pt(M[rt][ot][gt])+"px",T[st][dt]=Pt(M[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt])+"px",T[st][ut]=Pt(M[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut])+"px",wt!==x&&(M[st][dt]=Pt(J-B+M[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt]-M[rt][lt][dt])+"px"),yt!==x&&(M[st][ut]=Pt(G-N+M[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut]-M[rt][lt][ut])+"px")}else g();else g()}function i(){r||(n.apply(this,arguments),r=!0,setTimeout(function(){r=!1},60))}function m(){var t,e,n,i,r,o,a,s,l,h,u,c,f,d,p,g,m=0,b=dt,v=gt,_=ut,y=ft,w=0,S=0,C=!1,P=!1;yt===x&&(_=dt,y=gt),n=(e=K)-G,i=(t=Q)-J,H=0===H?n:H,j=0===j?i:j,U=0!=n?At(n):0!==H?At(H):U,W=0!=i?At(i):0!==j?At(j):W,G=e,J=t,X=(s=F)?{top:s[vt]-s[rt][at].top0||0,left:s[_t]-s[rt][at].left0||0}:{top:0,left:0},wt!==x&&(M[rt].r[dt]=J-B+M[rt][ot][dt],M[st][dt]=Pt(M[rt].r[dt]-O[rt][ot][dt]+O[rt][at][dt]-M[rt][lt][dt]+X[dt])+"px",P=i*j<0),yt!==x&&(M[rt].r[ut]=G-N+M[rt][ot][ut],M[st][ut]=Pt(M[rt].r[ut]-O[rt][ot][ut]+O[rt][at][ut]-M[rt][lt][ut]+X[ut])+"px",C=n*H<0),A.options.autoscroll&&F&&(!$||C||P)&&($&&(clearInterval($),$=null),C=s=I===F?(l=F[rt][ot][ft],o=F[rt][ot][gt],a=r=0,1.5):(l=F[rt][ot][ct],r=F[rt][ot][ut],o=F[rt][ot][pt],a=F[rt][ot][dt],1.2),yt!==x&&(0<U&&F[_t]+F[rt][ot][ft]<F[rt][at][ft]&&M[rt].r[ut]+M[rt].r[ft]>=l||U<0&&0<F[_t]&&M[rt].r[ut]<=r)&&(w=Ct.round(U*s*M[rt].r[ft])),wt!==x&&(0<W&&F[vt]+F[rt][ot][gt]<F[rt][at][gt]&&M[rt].r[dt]+M[rt].r[gt]>=o||W<0&&0<F[vt]&&M[rt].r[dt]<=a)&&(S=Ct.round(W*C*M[rt].r[gt])),w||S)&&(P=Ct.abs(w)>Ct.abs(S)?w:0,l=Ct.abs(S)>=Ct.abs(w)?S:0,h=A.options.scrollAnimationMs||0,u=1e3/60,c=F[vt]||0,f=F[_t]||0,d=0,p=P/(h||u),g=l/(h||u),$=setInterval(function(){d+=u,c+=g*u,f+=p*u,F[vt]=Ct.min(Ct.max(0,c),F[rt][at][gt]-F[rt][ot][gt]),F[_t]=Ct.min(Ct.max(0,f),F[rt][at][ft]-F[rt][ot][ft]),$&&h<=d&&(clearInterval($),$=null)},u)),H=n,j=i,r=M[rt].r[ut]+M[rt].r[ft]/2,s=M[rt].r[dt]+M[rt].r[gt]/2,o=M[rt].r[_],a=function(t){for(var e=1,n=arguments,i=n.length;e<i;++e)t.push.apply(t,n[e]);return t}(Dt(Y,e,t),yt===x?[]:Dt(Y,M[rt].r[ut]+2,s),yt===x?[]:Dt(Y,M[rt].r[ut]+M[rt].r[ft]-2,s),wt===x?[]:Dt(Y,r,M[rt].r[dt]+2),wt===x?[]:Dt(Y,r,M[rt].r[dt]+M[rt].r[gt]-2)).reduce(function(t,e){var n;return e!==M&&e!==T&&e.parentNode===O&&(n=it(M,e,X,z,V),m<n)&&(m=n,t=e),t},null),C=St===x?(a=!(a=!a&&M!==k&&0<=k[rt][ot][_]-X[_]-(o+M[rt][ot][y])&&k[rt][ot][_]-X[_]-(o+M[rt][ot][y])<25&&.7<(m=kt(M,k,X,b,v))?k:a)&&M!==L&&0<=o-(L[rt][ot][_]-X[_]+L[rt][ot][y])&&o-(L[rt][ot][_]-X[_]+L[rt][ot][y])<25&&.7<(m=kt(M,L,X,b,v))?L:a)?a[rt].index-M[rt].index:Ct.abs(W)>=Ct.abs(U)?W:U:(!(a=!a&&M!==k&&k[rt][ot][_]-X[_]>o+M[rt][ot][y]?k:a)&&M!==L&&o>L[rt][ot][_]-X[_]+L[rt][ot][y]&&(a=L),wt===x?U:W),D&&(Z<0&&0<C&&q<.5||0<Z&&C<0&&q<.5||a&&D!==a&&q<m||!it(M,D,X,z,V))&&(Mt(D,A.options.closestItem||"dnd-sortable-closest"),q=0,D=null),!D&&a&&m&&(D=a,Z=0<C?1:-1,q=m,tt=!1),D&&((m=m||it(M,D,X,z,V))?.2<(q=m)?(xt(D,A.options.closestItem||"dnd-sortable-closest"),.5<m&&!tt&&(N-=M[rt][ot][ut],B-=M[rt][ot][dt],tt=!0,nt(M,D,Z,A.options.animationMs||0),N+=M[rt][ot][ut],B+=M[rt][ot][dt])):Mt(D,A.options.closestItem||"dnd-sortable-closest"):(Mt(D,A.options.closestItem||"dnd-sortable-closest"),q=0,D=null))}function h(t){var e=M;o(),g(),y(A.options.onEnd)&&A.options.onEnd(e)}var T,M,u,D,k,L,c,R,I,F,O,N,B,G,J,H,j,U,W,K,Q,X,Z,q,tt,Y,n,r,e=!1,f=!1,b=!1,d=!1,v=null,$=null,et=!1,V=wt===x?ft:gt,z=wt===x?ut:dt,p=ut===z?ct:pt,g=function(){Y=R=c=O=F=I=L=k=D=u=M=T=null,tt=!1,q=0},o=function(){b&&($&&(clearInterval($),$=null),d?(a(Y,"touchmove",i,!1),a(Y,"touchend",h,!1),a(Y,"touchcancel",h,!1)):(a(Y,"mousemove",i,!1),a(Y,"mouseup",h,!1)),v&&(clearInterval(v),v=null),T&&T.parentNode&&(T.parentNode.removeChild(T),T[rt]=null),Mt(O,A.options.activeArea||"dnd-sortable-area"),Rt(O,["width","height","max-width","max-height","box-sizing","padding-left","padding-top","padding-right","padding-bottom"],O[rt].style),D&&Mt(D,A.options.closestItem||"dnd-sortable-closest"),Mt(M,A.options.activeItem||"dnd-sortable-dragged"),c.forEach(function(t){Rt(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[rt]=null}),O[rt]=null,F&&(F[rt]=null),b=!1)},nt=St===x?function(t,e,n,i){var r,o=e;if(et){if(n<0){for(a=t[mt],E(t,e,n),t[rt].prev.line=t[rt].line,t[rt].prev[dt]=t[rt][ot][dt],t[rt].prev[ut]=t[rt][ot][ut],t[rt].line=e[rt].line,t[rt][ot][dt]=e[rt][ot][dt],t[rt][ot][ut]=e[rt][ot][ut],T[st][dt]=Pt(t[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt])+"px",T[st][ut]=Pt(t[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut])+"px";(r=e[mt])&&r!==a;)e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev.line=e[rt].line,e[rt].prev[dt]=e[rt][ot][dt],e[rt].prev[ut]=e[rt][ot][ut],e[rt].line=r[rt].line,e[rt][ot][dt]=r[rt][ot][dt],e[rt][ot][ut]=r[rt][ot][ut],e[st][dt]=Pt(e[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt]-e[rt][lt][dt])+"px",e[st][ut]=Pt(e[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut]-e[rt][lt][ut])+"px",e=r;e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev.line=e[rt].line,e[rt].prev[dt]=e[rt][ot][dt],e[rt].prev[ut]=e[rt][ot][ut],e[rt].line=t[rt].prev.line,e[rt][ot][dt]=t[rt].prev[dt],e[rt][ot][ut]=t[rt].prev[ut],e[st][dt]=Pt(e[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt]-e[rt][lt][dt])+"px",e[st][ut]=Pt(e[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut]-e[rt][lt][ut])+"px"}else if(0<n){for(a=t[mt],E(t,e,n),e=a,(r=t)[rt].prev.line=r[rt].line,r[rt].prev[dt]=r[rt][ot][dt],r[rt].prev[ut]=r[rt][ot][ut];e[rt].animation&&e[rt].animation.stop(),e[rt].index--,e[rt].prev.line=e[rt].line,e[rt].prev[dt]=e[rt][ot][dt],e[rt].prev[ut]=e[rt][ot][ut],e[rt].line=r[rt].prev.line,e[rt][ot][dt]=r[rt].prev[dt],e[rt][ot][ut]=r[rt].prev[ut],e[st][dt]=Pt(e[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt]-e[rt][lt][dt])+"px",e[st][ut]=Pt(e[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut]-e[rt][lt][ut])+"px",(e=(r=e)[mt])&&e!==T;);t[rt].line=r[rt].prev.line,t[rt][ot][dt]=r[rt].prev[dt],t[rt][ot][ut]=r[rt].prev[ut],T[st][dt]=Pt(t[rt][ot][dt]-O[rt][ot][dt]+O[rt][at][dt])+"px",T[st][ut]=Pt(t[rt][ot][ut]-O[rt][ot][ut]+O[rt][at][ut])+"px"}}else{n<0?(r=T[bt],a=e[bt]||e,E(t,e,n)):0<n&&(r=t[mt],a=T[bt]||t[mt],E(t,e,n)),function(t,e,n,i){for(t=t[n<0?mt:bt];t;){if(t!==i&&(t[rt].index+=n<0?1:-1),t===e)return;t=t[n<0?mt:bt]}}(t,r,n,T);for(var a,s,l=a=function(t,e){for(var n;(n=t[bt])&&n[rt]&&n[rt].line>=e;)t=n;return t}(a,n=a[rt].line),h=n,u=O,c=t,f=T,d=ut,p=ft,g=ct,m=0;l;)l!==f&&(l[rt]&&l[rt].animation&&l[rt].animation.stop(),s=l[rt][lt][d]+l[rt][ot][p]+l[rt][lt][g],0<m&&u[rt][ht][d]+m+s+u[rt][ht][g]>u[rt][ot][p]&&(h++,m=0),l[rt].line=h,l[rt].prev[d]=l[rt][ot][d],l[rt][ot][d]=u[rt][ot][d]-u[rt][at][d]+u[rt][ht][d]+m+l[rt][lt][d],(l===c?f:l)[st][d]=Pt(l[rt][ot][d]-u[rt][ot][d]+u[rt][at][d]-(l===c?0:l[rt][lt][d]))+"px",m+=s),l=l[mt];for(var b,v,_,y=a,w=R,S=O,C=t,P=T,A=dt,x=gt,M=pt,n=y,D=y[rt].line,k=0;y;)y!==P&&(b=y[rt].line,_=y[rt][lt][A]+y[rt][ot][x]+y[rt][lt][M],k=b===D?Ct.max(k,_):(w[b]=w[D]+k,D=b,_)),y=y[mt];for(0<k&&(w[D+1]=w[D]+k),y=n;y;)y!==P&&(v=w[b=y[rt].line],y[rt].prev[A]=y[rt][ot][A],"bottom"===y[rt].$.verticalAlign?y[rt][ot][A]=S[rt][ot][A]-S[rt][at][A]+w[b+1]-y[rt][ot][x]-y[rt][lt][M]:y[rt][ot][A]=S[rt][ot][A]-S[rt][at][A]+v+y[rt][lt][A],(y===C?P:y)[st][A]=Pt(y[rt][ot][A]-(y===C?0:y[rt][lt][A])-S[rt][ot][A]+S[rt][at][A])+"px"),y=y[mt]}It(o,i,{top:o[rt][ot][dt]-o[rt].prev[dt],left:o[rt][ot][ut]-o[rt].prev[ut]})}:function(t,e,n,i){var r,o,a=e,s=0,l=0;if(n<0){for(o=t[mt],E(t,e,n),t[rt].prev[z]=t[rt][ot][z],l=t[rt][lt][z]-e[rt][lt][z],t[rt][ot][z]=e[rt][ot][z]+l,T[st][z]=Pt(t[rt][ot][z]-O[rt][ot][z]+O[rt][at][z])+"px",s=t[rt][ot][V]-e[rt][ot][V],l+=t[rt][lt][p]-e[rt][lt][p];(r=e[mt])&&r!==o;)e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev[z]=e[rt][ot][z],l+=e[rt][lt][z]-r[rt][lt][z],e[rt][ot][z]=r[rt][ot][z]+s+l,l+=e[rt][lt][p]-r[rt][lt][p],e[st][z]=Pt(e[rt][ot][z]-O[rt][ot][z]+O[rt][at][z]-e[rt][lt][z])+"px",s+=e[rt][ot][V]-r[rt][ot][V],e=r;e[rt].animation&&e[rt].animation.stop(),e[rt].index++,e[rt].prev[z]=e[rt][ot][z],e[rt][ot][z]=t[rt].prev[z]+s+l-t[rt][lt][z]+e[rt][lt][z],e[st][z]=Pt(e[rt][ot][z]-O[rt][ot][z]+O[rt][at][z]-e[rt][lt][z])+"px"}else if(0<n){for(o=t[mt],E(t,e,n),e=o,s=l=0,(r=t)[rt].prev[z]=r[rt][ot][z];e[rt].animation&&e[rt].animation.stop(),e[rt].index--,e[rt].prev[z]=e[rt][ot][z],l+=e[rt][lt][z]-r[rt][lt][z],e[rt][ot][z]=r[rt].prev[z]+s+l,e[st][z]=Pt(e[rt][ot][z]-O[rt][ot][z]+O[rt][at][z]-e[rt][lt][z])+"px",s+=-(r[rt][ot][V]-e[rt][ot][V]),l+=e[rt][lt][p]-r[rt][lt][p],(e=(r=e)[mt])&&e!==T;);t[rt][ot][z]=r[rt].prev[z]+s+l-r[rt][lt][z]+t[rt][lt][z],T[st][z]=Pt(t[rt][ot][z]-O[rt][ot][z]+O[rt][at][z])+"px"}(n={})[z]=a[rt][ot][z]-a[rt].prev[z],It(a,i,n)},it=St===x?Ft:kt;r=!(n=function(t){K=(d?t.touches[0]:t).clientX,Q=(d?t.touches[0]:t).clientY});A.start=A.options.callable?function(){f||(f=!(e=!1),A.handle=t)}:function(){f||(f=!0,e)||(e=!0,S(document,"touchstart",t,{capture:!0,passive:!1}),S(document,"mousedown",t,{capture:!0,passive:!1}))},A.stop=function(){A.handle=null,f=!1,e&&(a(document,"touchstart",t,{capture:!0,passive:!1}),a(document,"mousedown",t,{capture:!0,passive:!1}),e=!1),o(),g()}}function s(t,e){var n=this;if(!(n instanceof s))return new s(t,e);switch(n.options=e||{},(t=Pt(t)).toLowerCase()){case"unrestricted":o(n,St);break;case"horizontal":o(n,wt);break;case"vertical":o(n,yt);break;default:throw new TypeError("AreaSortable invalid sort mode:"+t)}n.start()}return window.Element&&!i.call(window.Element.prototype,rt)&&(window.Element.prototype[rt]=null),s.VERSION="1.2.2",s.prototype={constructor:s,options:null,start:null,handle:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.options=null,t.start=null,t.handle=null,t.stop=null,t}},s});var pngDataTable=void 0,PNG="image/png",JPEG="image/jpeg",b64PhysSignature1="AAlwSFlz",b64PhysSignature2="AAAJcEhZ",b64PhysSignature3="AAAACXBI",_P="p".charCodeAt(0),_H="H".charCodeAt(0),_Y="Y".charCodeAt(0),_S="s".charCodeAt(0);function changeDpiBlob(r,o){var e=r.slice(0,33);return new Promise(function(n,t){var i=new FileReader;i.onload=function(){var t=new Uint8Array(i.result),e=r.slice(33),t=changeDpiOnArray(t,o,r.type);n(new Blob([t,e],{type:r.type}))},i.readAsArrayBuffer(e)})}function changeDpiDataUrl(t,e){for(var n=(t=t.split(","))[0],t=t[1],i=void 0,r=void 0,o=!1,a=(-1!==n.indexOf(PNG)&&(i=PNG,0<=(a=detectPhysChunkFromDataUrl(t))?(r=4*Math.ceil((a+28)/3),o=!0):r=44),-1!==n.indexOf(JPEG)&&(i=JPEG,r=24),t.substring(0,r)),t=t.substring(r),s=atob(a),l=new Uint8Array(s.length),h=0;h<l.length;h++)l[h]=s.charCodeAt(h);return r=changeDpiOnArray(l,e,i,o),[n,",",btoa(String.fromCharCode.apply(String,_toConsumableArray(r))),t].join("")}function detectPhysChunkFromDataUrl(t){var e=t.indexOf(b64PhysSignature1);return-1===(e=-1===e?t.indexOf(b64PhysSignature2):e)?t.indexOf(b64PhysSignature3):e}function searchStartOfPhys(t){for(var e=t.length-1;4<=e;e--)if(9===t[e-4]&&t[e-3]===_P&&t[e-2]===_H&&t[e-1]===_Y&&t[e]===_S)return e-3}function changeDpiOnArray(t,e,n,i){var r;return n===JPEG?(t[13]=1,t[14]=e>>8,t[15]=255&e,t[16]=e>>8,t[17]=255&e,t):n===PNG?(e*=39.3701,(n=new Uint8Array(13))[0]=_P,n[1]=_H,n[2]=_Y,n[3]=_S,n[4]=e>>>24,n[5]=e>>>16,n[6]=e>>>8,n[7]=255&e,n[8]=n[4],n[9]=n[5],n[10]=n[6],n[11]=n[7],n[12]=1,e=calcCrc(n),(r=new Uint8Array(4))[0]=e>>>24,r[1]=e>>>16,r[2]=e>>>8,r[3]=255&e,i?(e=searchStartOfPhys(t),t.set(n,e),t.set(r,e+13),t):((i=new Uint8Array(4))[0]=0,i[1]=0,i[2]=0,i[3]=9,(e=new Uint8Array(54)).set(t,0),e.set(i,33),e.set(n,37),e.set(r,50),e)):void 0}if(!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.download=e()}(this,function(){return function e(t,n,i){function r(t){return String(t)}var o=window,a="application/octet-stream",s=i||a,i=!n&&!i&&t,l=document.createElement("a"),h=o.Blob||o.MozBlob||o.WebKitBlob||r,u=n||"download",h=h.call?h.bind(o):Blob;if("true"===String(this)&&(s=(t=[t,s])[0],t=t[1]),i&&i.length<2048){var c,u=i.split("/").pop().split("?")[0];if(l.href=i,-1!==l.href.indexOf(i))return(c=new XMLHttpRequest).open("GET",i,!0),c.responseType="blob",c.onload=function(t){e(t.target.response,u,a)},setTimeout(function(){c.send()},0),c}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(t)){if(!(2096103.424<t.length&&h!==r))return navigator.msSaveBlob?navigator.msSaveBlob(f(t),u):d(t);s=(t=f(t)).type||a}function f(t){for(var e=(t=t.split(/[:;,]/))[1],n=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),i=n.length,r=0,o=new Uint8Array(i);r<i;++r)o[r]=n.charCodeAt(r);return new h([o],{type:e})}function d(t,e){var n;return"download"in l?(l.href=t,l.setAttribute("download",u),l.className="download-js-link",l.innerHTML="downloading...",l.style.display="none",document.body.appendChild(l),setTimeout(function(){l.click(),document.body.removeChild(l),!0===e&&setTimeout(function(){o.URL.revokeObjectURL(l.href)},250)},66),!0):/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)?(t=t.replace(/^data:([\w\/\-\+]+)/,a),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0):(n=document.createElement("iframe"),document.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,a)),n.src=t,void setTimeout(function(){document.body.removeChild(n)},333))}if(n=t instanceof h?t:new h([t],{type:s}),navigator.msSaveBlob)return navigator.msSaveBlob(n,u);if(o.URL)d(o.URL.createObjectURL(n),!0);else{if("string"==typeof n||n.constructor===r)try{return d("data:"+s+";base64,"+o.btoa(n))}catch(t){return d("data:"+s+","+encodeURIComponent(n))}(i=new FileReader).onload=function(t){d(this.result)},i.readAsDataURL(n)}return!0}}),this.JpegMeta)throw Error("Library included multiple times");var QRCode,JpegMeta={stringIsClean:function(t){for(var e=0;e<t.length;e++)if(t.charCodeAt(e)<32)return!1;return!0},parseNum:function(t,e,n,i){var r,o,a=">"===t;for(void 0===n&&(n=0),void 0===i&&(i=e.length-n),r=a?n:n+i-1;a?r<n+i:n<=r;a?r++:r--)o=(o<<=8)+e.charCodeAt(r);return o},parseSnum:function(t,e,n,i){var r,o,a,s=">"===t;for(void 0===n&&(n=0),void 0===i&&(i=e.length-n),r=s?n:n+i-1;s?r<n+i:n<=r;s?r++:r--)o=(o<<=8)+((a=void 0===a?128==(128&e.charCodeAt(r)):a)?255&~e.charCodeAt(r):e.charCodeAt(r));return a?-1*(o+1):o},Rational:function(t,e){return this.num=t,this.den=e||1,this}};JpegMeta.Rational.prototype.toString=function(){return 0===this.num||1===this.den?""+this.num:1===this.num?this.num+" / "+this.den:this.num/this.den},JpegMeta.Rational.prototype.asFloat=function(){return this.num/this.den},JpegMeta.MetaGroup=function(t,e){return this.fieldName=t,this.description=e,this.metaProps={},this},JpegMeta.MetaGroup.prototype._addProperty=function(t,e,n){this[(t=new JpegMeta.MetaProp(t,e,n)).fieldName]=t,this.metaProps[t.fieldName]=t},JpegMeta.MetaGroup.prototype.toString=function(){return"[MetaGroup "+this.description+"]"},JpegMeta.MetaProp=function(t,e,n){return this.fieldName=t,this.description=e,this.value=n,this},JpegMeta.MetaProp.prototype.toString=function(){return""+this.value},this.JpegMeta.JpegFile=function(t,e){var n,i,r,o=this._SOS,a=(this.metaGroups={},this._binary_data=t,this.filename=e,0);if(this._binary_data.slice(0,2)!==this._SOI_MARKER)throw new Error("Doesn't look like a JPEG file. First two bytes are "+this._binary_data.charCodeAt(0)+","+this._binary_data.charCodeAt(1)+".");for(a+=2;a<this._binary_data.length&&(r=this._binary_data.charCodeAt(a++),i=this._binary_data.charCodeAt(a++),n=a,r==this._DELIM)&&i!==o;){for(a+=JpegMeta.parseNum(">",this._binary_data,a,2);a<this._binary_data.length;)if(this._binary_data.charCodeAt(a++)==this._DELIM&&0!=this._binary_data.charCodeAt(a++)){a-=2;break}(r=this._markers[i]?(this._markers[i][0],this._markers[i][1]):void 0)&&this[r](i,n+2,a-n-2)}if(void 0===this.general)throw Error("Invalid JPEG file.");return this},this.JpegMeta.JpegFile.prototype.toString=function(){return"[JpegFile "+this.filename+" "+this.general.type+" "+this.general.pixelWidth+"x"+this.general.pixelHeight+" Depth: "+this.general.depth+"]"},this.JpegMeta.JpegFile.prototype._SOI_MARKER="ÿØ",this.JpegMeta.JpegFile.prototype._DELIM=255,this.JpegMeta.JpegFile.prototype._EOI=217,this.JpegMeta.JpegFile.prototype._SOS=218,this.JpegMeta.JpegFile.prototype._sofHandler=function(t,e){if(void 0!==this.general)throw Error("Unexpected multiple-frame image");this._addMetaGroup("general","General"),this.general._addProperty("depth","Depth",JpegMeta.parseNum(">",this._binary_data,e,1)),this.general._addProperty("pixelHeight","Pixel Height",JpegMeta.parseNum(">",this._binary_data,e+1,2)),this.general._addProperty("pixelWidth","Pixel Width",JpegMeta.parseNum(">",this._binary_data,e+3,2)),this.general._addProperty("type","Type",this._markers[t][2])},this.JpegMeta.JpegFile.prototype._commentHandler=function(t,e,n){var i,r;for(n--,i=++e,r="";i<e+n;)r+=String.fromCharCode(this._binary_data.charCodeAt(i)),i++;this._addMetaGroup("comment","Comment"),this.comment._addProperty("comment","Comment",r)},this.JpegMeta.JpegFile.prototype._JFIF_IDENT="JFIF\0",this.JpegMeta.JpegFile.prototype._JFXX_IDENT="JFXX\0",this.JpegMeta.JpegFile.prototype._EXIF_IDENT="Exif\0",this.JpegMeta.JpegFile.prototype._types={1:["BYTE",1],2:["ASCII",1],3:["SHORT",2],4:["LONG",4],5:["RATIONAL",8],6:["SBYTE",1],7:["UNDEFINED",1],8:["SSHORT",2],9:["SLONG",4],10:["SRATIONAL",8],11:["FLOAT",4],12:["DOUBLE",8]},this.JpegMeta.JpegFile.prototype._tifftags={256:["Image width","ImageWidth"],257:["Image height","ImageLength"],258:["Number of bits per component","BitsPerSample"],259:["Compression scheme","Compression",{1:"uncompressed",6:"JPEG compression"}],262:["Pixel composition","PhotmetricInerpretation",{2:"RGB",6:"YCbCr"}],274:["Orientation of image","Orientation",{1:"Normal",2:"Reverse?",3:"Upside-down",4:"Upside-down Reverse",5:"90 degree CW",6:"90 degree CW reverse",7:"90 degree CCW",8:"90 degree CCW reverse"}],277:["Number of components","SamplesPerPixel"],284:["Image data arrangement","PlanarConfiguration",{1:"chunky format",2:"planar format"}],530:["Subsampling ratio of Y to C","YCbCrSubSampling"],531:["Y and C positioning","YCbCrPositioning",{1:"centered",2:"co-sited"}],282:["X Resolution","XResolution"],283:["Y Resolution","YResolution"],296:["Resolution Unit","ResolutionUnit",{2:"inches",3:"centimeters"}],273:["Image data location","StripOffsets"],278:["Number of rows per strip","RowsPerStrip"],279:["Bytes per compressed strip","StripByteCounts"],513:["Offset to JPEG SOI","JPEGInterchangeFormat"],514:["Bytes of JPEG Data","JPEGInterchangeFormatLength"],301:["Transfer function","TransferFunction"],318:["White point chromaticity","WhitePoint"],319:["Chromaticities of primaries","PrimaryChromaticities"],529:["Color space transformation matrix coefficients","YCbCrCoefficients"],532:["Pair of black and white reference values","ReferenceBlackWhite"],306:["Date and time","DateTime"],270:["Image title","ImageDescription"],271:["Make","Make"],272:["Model","Model"],305:["Software","Software"],315:["Person who created the image","Artist"],316:["Host Computer","HostComputer"],33432:["Copyright holder","Copyright"],34665:["Exif tag","ExifIfdPointer"],34853:["GPS tag","GPSInfoIfdPointer"]},this.JpegMeta.JpegFile.prototype._exiftags={36864:["Exif Version","ExifVersion"],40960:["FlashPix Version","FlashpixVersion"],40961:["Color Space","ColorSpace"],37121:["Meaning of each component","ComponentsConfiguration"],37122:["Compressed Bits Per Pixel","CompressedBitsPerPixel"],40962:["Pixel X Dimension","PixelXDimension"],40963:["Pixel Y Dimension","PixelYDimension"],37500:["Manufacturer notes","MakerNote"],37510:["User comments","UserComment"],40964:["Related audio file","RelatedSoundFile"],36867:["Date Time Original","DateTimeOriginal"],36868:["Date Time Digitized","DateTimeDigitized"],37520:["DateTime subseconds","SubSecTime"],37521:["DateTimeOriginal subseconds","SubSecTimeOriginal"],37522:["DateTimeDigitized subseconds","SubSecTimeDigitized"],33434:["Exposure time","ExposureTime"],33437:["FNumber","FNumber"],34850:["Exposure program","ExposureProgram"],34852:["Spectral sensitivity","SpectralSensitivity"],34855:["ISO Speed Ratings","ISOSpeedRatings"],34856:["Optoelectric coefficient","OECF"],37377:["Shutter Speed","ShutterSpeedValue"],37378:["Aperture Value","ApertureValue"],37379:["Brightness","BrightnessValue"],37380:["Exposure Bias Value","ExposureBiasValue"],37381:["Max Aperture Value","MaxApertureValue"],37382:["Subject Distance","SubjectDistance"],37383:["Metering Mode","MeteringMode"],37384:["Light Source","LightSource"],37385:["Flash","Flash"],37386:["Focal Length","FocalLength"],37396:["Subject Area","SubjectArea"],41483:["Flash Energy","FlashEnergy"],41484:["Spatial Frequency Response","SpatialFrequencyResponse"],41486:["Focal Plane X Resolution","FocalPlaneXResolution"],41487:["Focal Plane Y Resolution","FocalPlaneYResolution"],41488:["Focal Plane Resolution Unit","FocalPlaneResolutionUnit"],41492:["Subject Location","SubjectLocation"],41493:["Exposure Index","ExposureIndex"],41495:["Sensing Method","SensingMethod"],41728:["File Source","FileSource"],41729:["Scene Type","SceneType"],41730:["CFA Pattern","CFAPattern"],41985:["Custom Rendered","CustomRendered"],41986:["Exposure Mode","Exposure Mode"],41987:["White Balance","WhiteBalance"],41988:["Digital Zoom Ratio","DigitalZoomRatio"],41989:["Focal length in 35 mm film","FocalLengthIn35mmFilm"],41990:["Scene Capture Type","SceneCaptureType"],41991:["Gain Control","GainControl"],41992:["Contrast","Contrast"],41993:["Saturation","Saturation"],41994:["Sharpness","Sharpness"],41995:["Device settings description","DeviceSettingDescription"],41996:["Subject distance range","SubjectDistanceRange"],42016:["Unique image ID","ImageUniqueID"],40965:["Interoperability tag","InteroperabilityIFDPointer"]},this.JpegMeta.JpegFile.prototype._gpstags={0:["GPS tag version","GPSVersionID"],1:["North or South Latitude","GPSLatitudeRef"],2:["Latitude","GPSLatitude"],3:["East or West Longitude","GPSLongitudeRef"],4:["Longitude","GPSLongitude"],5:["Altitude reference","GPSAltitudeRef"],6:["Altitude","GPSAltitude"],7:["GPS time (atomic clock)","GPSTimeStamp"],8:["GPS satellites usedd for measurement","GPSSatellites"],9:["GPS receiver status","GPSStatus"],10:["GPS mesaurement mode","GPSMeasureMode"],11:["Measurement precision","GPSDOP"],12:["Speed unit","GPSSpeedRef"],13:["Speed of GPS receiver","GPSSpeed"],14:["Reference for direction of movement","GPSTrackRef"],15:["Direction of movement","GPSTrack"],16:["Reference for direction of image","GPSImgDirectionRef"],17:["Direction of image","GPSImgDirection"],18:["Geodetic survey data used","GPSMapDatum"],19:["Reference for latitude of destination","GPSDestLatitudeRef"],20:["Latitude of destination","GPSDestLatitude"],21:["Reference for longitude of destination","GPSDestLongitudeRef"],22:["Longitude of destination","GPSDestLongitude"],23:["Reference for bearing of destination","GPSDestBearingRef"],24:["Bearing of destination","GPSDestBearing"],25:["Reference for distance to destination","GPSDestDistanceRef"],26:["Distance to destination","GPSDestDistance"],27:["Name of GPS processing method","GPSProcessingMethod"],28:["Name of GPS area","GPSAreaInformation"],29:["GPS Date","GPSDateStamp"],30:["GPS differential correction","GPSDifferential"]},this.JpegMeta.JpegFile.prototype._iptctags={0:["Record Version","recordVersion"],3:["Object Type Reference","objectType"],4:["Object Attribute Reference","objectAttribute"],5:["Object Name","objectName"],7:["Edit Status","editStatus"],8:["Editorial Update","editorialUpdate"],10:["Urgency","urgency"],12:["Subject Reference","subjectRef"],15:["Category","category"],20:["Supplemental Category","supplCategory"],22:["Fixture Identifier","fixtureID"],25:["Keywords","keywords"],26:["Content Location Code","contentLocCode"],27:["Content Location Name","contentLocName"],30:["Release Date","releaseDate"],35:["Release Time","releaseTime"],37:["Expiration Date","expirationDate"],38:["Expiration Time","expirationTime"],40:["Special Instructions","specialInstructions"],42:["Action Advised","actionAdvised"],45:["Reference Service","refService"],47:["Reference Date","refDate"],50:["Reference Number","refNumber"],55:["Date Created","dateCreated"],60:["Time Created","timeCreated"],62:["Digital Creation Date","digitalCreationDate"],63:["Digital Creation Time","digitalCreationTime"],65:["Originating Program","originatingProgram"],70:["Program Version","programVersion"],75:["Object Cycle","objectCycle"],80:["By-line","byline"],85:["By-line Title","bylineTitle"],90:["City","city"],92:["Sub-location","sublocation"],95:["Province/State","state"],100:["Country Code","countryCode"],101:["Country Name","countryName"],103:["Original Transmission Reference","origTransRef"],105:["Headline","headline"],110:["Credit","credit"],115:["Source","source"],116:["Copyright Notice","copyrightNotice"],118:["Contact","contact"],120:["Caption/Abstract","caption"],122:["Writer/Editor","writerEditor"],125:["Rasterized Caption","rasterizedCaption"],130:["Image Type","imageType"],131:["Image Orientation","imageOrientation"],135:["Language Identifier","languageID"],150:["Audio Type","audioType"],151:["Audio Sampling Rate","audioSamplingRate"],152:["Audio Sampling Resolution","audioSamplingRes"],153:["Audio Duration","audioDuration"],154:["Audio Outcue","audioOutcue"],200:["Preview File Format","previewFileFormat"],201:["Preview File Format Version","previewFileFormatVer"],202:["Preview Data","previewData"]},this.JpegMeta.JpegFile.prototype._markers={192:["SOF0","_sofHandler","Baseline DCT"],193:["SOF1","_sofHandler","Extended sequential DCT"],194:["SOF2","_sofHandler","Progressive DCT"],195:["SOF3","_sofHandler","Lossless (sequential)"],197:["SOF5","_sofHandler","Differential sequential DCT"],198:["SOF6","_sofHandler","Differential progressive DCT"],199:["SOF7","_sofHandler","Differential lossless (sequential)"],200:["JPG",null,"Reserved for JPEG extensions"],201:["SOF9","_sofHandler","Extended sequential DCT"],202:["SOF10","_sofHandler","Progressive DCT"],203:["SOF11","_sofHandler","Lossless (sequential)"],205:["SOF13","_sofHandler","Differential sequential DCT"],206:["SOF14","_sofHandler","Differential progressive DCT"],207:["SOF15","_sofHandler","Differential lossless (sequential)"],196:["DHT",null,"Define Huffman table(s)"],204:["DAC",null,"Define arithmetic coding conditioning(s)"],208:["RST0",null,"Restart with modulo 8 count �0�"],209:["RST1",null,"Restart with modulo 8 count �1�"],210:["RST2",null,"Restart with modulo 8 count �2�"],211:["RST3",null,"Restart with modulo 8 count �3�"],212:["RST4",null,"Restart with modulo 8 count �4�"],213:["RST5",null,"Restart with modulo 8 count �5�"],214:["RST6",null,"Restart with modulo 8 count �6�"],215:["RST7",null,"Restart with modulo 8 count �7�"],216:["SOI",null,"Start of image"],217:["EOI",null,"End of image"],218:["SOS",null,"Start of scan"],219:["DQT",null,"Define quantization table(s)"],220:["DNL",null,"Define number of lines"],221:["DRI",null,"Define restart interval"],222:["DHP",null,"Define hierarchical progression"],223:["EXP",null,"Expand reference component(s)"],224:["APP0","_app0Handler","Reserved for application segments"],225:["APP1","_app1Handler"],226:["APP2",null],227:["APP3",null],228:["APP4",null],229:["APP5",null],230:["APP6",null],231:["APP7",null],232:["APP8",null],233:["APP9",null],234:["APP10",null],235:["APP11",null],236:["APP12",null],237:["IPTC","_iptcHandler","IPTC Photo Metadata"],238:["APP14",null],239:["APP15",null],240:["JPG0",null],241:["JPG1",null],242:["JPG2",null],243:["JPG3",null],244:["JPG4",null],245:["JPG5",null],246:["JPG6",null],247:["JPG7",null],248:["JPG8",null],249:["JPG9",null],250:["JPG10",null],251:["JPG11",null],252:["JPG12",null],253:["JPG13",null],254:["COM","_commentHandler","Comment"],1:["JPG13",null]},this.JpegMeta.JpegFile.prototype._addMetaGroup=function(t,e){return this[(t=new JpegMeta.MetaGroup(t,e)).fieldName]=t,this.metaGroups[t.fieldName]=t},this.JpegMeta.JpegFile.prototype._parseIfd=function(t,e,n,i,r,o,a){for(var s,l,h,u,c,f,d,p,g,m=JpegMeta.parseNum(t,e,n+i,2),b=this._addMetaGroup(o,a),v=0;v<m;v++)if(l=JpegMeta.parseNum(t,e,s=n+i+2+12*v,2),u=JpegMeta.parseNum(t,e,s+2,2),f=JpegMeta.parseNum(t,e,s+4,4),d=JpegMeta.parseNum(t,e,s+8,4),void 0!==this._types[u]){if(h=this._types[u][0],d=(c=this._types[u][1])*f<=4?s+8:n+d,"UNDEFINED"==h)_=void 0;else if("ASCII"==h)_=(_=e.slice(d,d+f)).split("\0")[0],JpegMeta.stringIsClean(_)||(_="");else{for(var _=new Array,y=0;y<f;y++,d+=c)"BYTE"!=h&&"SHORT"!=h&&"LONG"!=h||_.push(JpegMeta.parseNum(t,e,d,c)),"SBYTE"!=h&&"SSHORT"!=h&&"SLONG"!=h||_.push(JpegMeta.parseSnum(t,e,d,c)),"RATIONAL"==h&&(p=JpegMeta.parseNum(t,e,d,4),g=JpegMeta.parseNum(t,e,d+4,4),_.push(new JpegMeta.Rational(p,g))),"SRATIONAL"==h&&(p=JpegMeta.parseSnum(t,e,d,4),g=JpegMeta.parseSnum(t,e,d+4,4),_.push(new JpegMeta.Rational(p,g))),_.push();1===f&&(_=_[0])}r.hasOwnProperty(l)?b._addProperty(r[l][1],r[l][0],_):console.log("WARNING(jpegmeta.js): Unknown tag: ",l)}},this.JpegMeta.JpegFile.prototype._jfifHandler=function(t,e){if(void 0!==this.jfif)throw Error("Multiple JFIF segments found");this._addMetaGroup("jfif","JFIF"),this.jfif._addProperty("version_major","Version Major",this._binary_data.charCodeAt(e+5)),this.jfif._addProperty("version_minor","Version Minor",this._binary_data.charCodeAt(e+6)),this.jfif._addProperty("version","JFIF Version",this.jfif.version_major.value+"."+this.jfif.version_minor.value),this.jfif._addProperty("units","Density Unit",this._binary_data.charCodeAt(e+7)),this.jfif._addProperty("Xdensity","X density",JpegMeta.parseNum(">",this._binary_data,e+8,2)),this.jfif._addProperty("Ydensity","Y Density",JpegMeta.parseNum(">",this._binary_data,e+10,2)),this.jfif._addProperty("Xthumbnail","X Thumbnail",JpegMeta.parseNum(">",this._binary_data,e+12,1)),this.jfif._addProperty("Ythumbnail","Y Thumbnail",JpegMeta.parseNum(">",this._binary_data,e+13,1))},this.JpegMeta.JpegFile.prototype._app0Handler=function(t,e){this._binary_data.slice(e,e+5)==this._JFIF_IDENT?this._jfifHandler(t,e):this._JFXX_IDENT},this.JpegMeta.JpegFile.prototype._app1Handler=function(t,e){this._binary_data.slice(e,e+5)==this._EXIF_IDENT&&this._exifHandler(t,e+6)},JpegMeta.JpegFile.prototype._exifHandler=function(t,e){if(void 0!==this.exif)throw new Error("Multiple JFIF segments found");var n,i=this._binary_data.slice(e,e+2);if("II"===i)n="<";else{if("MM"!==i)throw new Error("Malformed TIFF meta-data. Unknown endianess: "+i);n=">"}if(42!==(i=JpegMeta.parseNum(n,this._binary_data,e+2,2)))throw new Error("Malformed TIFF meta-data. Bad magic: "+i);i=JpegMeta.parseNum(n,this._binary_data,e+4,4),this._parseIfd(n,this._binary_data,e,i,this._tifftags,"tiff","TIFF"),this.tiff.ExifIfdPointer&&this._parseIfd(n,this._binary_data,e,this.tiff.ExifIfdPointer.value,this._exiftags,"exif","Exif"),this.tiff.GPSInfoIfdPointer&&(this._parseIfd(n,this._binary_data,e,this.tiff.GPSInfoIfdPointer.value,this._gpstags,"gps","GPS"),this.gps.GPSLatitude&&(i=this.gps.GPSLatitude.value[0].asFloat()+1/60*this.gps.GPSLatitude.value[1].asFloat()+1/3600*this.gps.GPSLatitude.value[2].asFloat(),"S"===this.gps.GPSLatitudeRef.value&&(i=-i),this.gps._addProperty("latitude","Dec. Latitude",i)),this.gps.GPSLongitude)&&(n=this.gps.GPSLongitude.value[0].asFloat()+1/60*this.gps.GPSLongitude.value[1].asFloat()+1/3600*this.gps.GPSLongitude.value[2].asFloat(),"W"===this.gps.GPSLongitudeRef.value&&(n=-n),this.gps._addProperty("longitude","Dec. Longitude",n))},this.JpegMeta.JpegFile.prototype._iptcHandler=function(t,e,n){this._addMetaGroup("iptc","IPTC");for(var i,r,o,a=JpegMeta.parseNum("<",this._binary_data,e+4,1),s=0;s<n;s++)if(2==JpegMeta.parseNum("<",this._binary_data,r=e+s,1)&&(o=JpegMeta.parseNum("<",this._binary_data,r+1,1),tag_desc=this._iptctags[o])){for(a=0,i=2;i<n&&28!=JpegMeta.parseNum("<",this._binary_data,r+i,1)&&2!=JpegMeta.parseNum("<",this._binary_data,r+i+1,1);)i++,a++;a&&(o=(o=this._binary_data.slice(e+s+2,e+s+2+a)).replace("\0","").trim(),this.iptc._addProperty(tag_desc[1],tag_desc[0],o),s+=a-1)}},function(){function e(t){this.mode=o.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,n=this.data.length;e<n;e++){var i=[],r=this.data.charCodeAt(e);65536<r?(i[0]=240|(1835008&r)>>>18,i[1]=128|(258048&r)>>>12,i[2]=128|(4032&r)>>>6,i[3]=128|63&r):2048<r?(i[0]=224|(61440&r)>>>12,i[1]=128|(4032&r)>>>6,i[2]=128|63&r):128<r?(i[0]=192|(1984&r)>>>6,i[1]=128|63&r):i[0]=r,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function l(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function m(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function u(t,e){this.totalCount=t,this.dataCount=e}function h(){this.buffer=[],this.length=0}function i(){var t=!1,e=navigator.userAgent;return/android/i.test(e)&&(t=!0,e=e.toString().match(/android ([0-9]\.[0-9])/i))&&e[1]?parseFloat(e[1]):t}e.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},l.prototype={addData:function(t){t=new e(t),this.dataList.push(t),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[n][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=b.getLostPoint(this);(0==n||i<t)&&(t=i,e=n)}return e},createMovieClip:function(t,e,n){var i=t.createEmptyMovieClip(e,n);this.make();for(var r=0;r<this.modules.length;r++)for(var o=+r,a=0;a<this.modules[r].length;a++){var s=+a;this.modules[r][a]&&(i.beginFill(0,100),i.moveTo(s,o),i.lineTo(1+s,o),i.lineTo(1+s,1+o),i.lineTo(s,1+o),i.endFill())}return i},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=b.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],r=t[n];if(null==this.modules[i][r])for(var o=-2;o<=2;o++)for(var a=-2;a<=2;a++)this.modules[i+o][r+a]=-2==o||2==o||-2==a||2==a||0==o&&0==a}},setupTypeNumber:function(t){for(var e=b.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;n<18;n++)i=!t&&1==(e>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i},setupTypeInfo:function(t,e){for(var e=this.errorCorrectLevel<<3|e,n=b.getBCHTypeInfo(e),i=0;i<15;i++){var r=!t&&1==(n>>i&1);i<6?this.modules[i][8]=r:i<8?this.modules[i+1][8]=r:this.modules[this.moduleCount-15+i][8]=r}for(i=0;i<15;i++)r=!t&&1==(n>>i&1),i<8?this.modules[8][this.moduleCount-i-1]=r:i<9?this.modules[8][15-i-1+1]=r:this.modules[8][15-i-1]=r;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,r=7,o=0,a=this.moduleCount-1;0<a;a-=2)for(6==a&&a--;;){for(var s,l,h=0;h<2;h++)null==this.modules[i][a-h]&&(s=!1,o<t.length&&(s=1==(t[o]>>>r&1)),l=b.getMask(e,i,a-h),this.modules[i][a-h]=s=l?!s:s,-1==--r)&&(o++,r=7);if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},l.PAD0=236,l.PAD1=17,l.createData=function(t,e,n){for(var i=u.getRSBlocks(t,e),r=new h,o=0;o<n.length;o++){var a=n[o];r.put(a.mode,4),r.put(a.getLength(),b.getLengthInBits(a.mode,t)),a.write(r)}for(var s=0,o=0;o<i.length;o++)s+=i[o].dataCount;if(r.getLengthInBits()>8*s)throw new Error("code length overflow. ("+r.getLengthInBits()+">"+8*s+")");for(r.getLengthInBits()+4<=8*s&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*s||(r.put(l.PAD0,8),r.getLengthInBits()>=8*s));)r.put(l.PAD1,8);return l.createBytes(r,i)},l.createBytes=function(t,e){for(var n=0,i=0,r=0,o=new Array(e.length),a=new Array(e.length),s=0;s<e.length;s++){var l=e[s].dataCount,h=e[s].totalCount-l,i=Math.max(i,l),r=Math.max(r,h);o[s]=new Array(l);for(var u=0;u<o[s].length;u++)o[s][u]=255&t.buffer[u+n];n+=l;var l=b.getErrorCorrectPolynomial(h),c=new m(o[s],l.getLength()-1).mod(l);for(a[s]=new Array(l.getLength()-1),u=0;u<a[s].length;u++){var f=u+c.getLength()-a[s].length;a[s][u]=0<=f?c.get(f):0}}for(var d=0,u=0;u<e.length;u++)d+=e[u].totalCount;for(var p=new Array(d),g=0,u=0;u<i;u++)for(s=0;s<e.length;s++)u<o[s].length&&(p[g++]=o[s][u]);for(u=0;u<r;u++)for(s=0;s<e.length;s++)u<a[s].length&&(p[g++]=a[s][u]);return p};for(var o={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},c={L:1,M:0,Q:3,H:2},b={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=b.getBCHDigit(e)-b.getBCHDigit(b.G15);)e^=b.G15<<b.getBCHDigit(e)-b.getBCHDigit(b.G15);return(t<<10|e)^b.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=b.getBCHDigit(e)-b.getBCHDigit(b.G18);)e^=b.G18<<b.getBCHDigit(e)-b.getBCHDigit(b.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return b.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case 0:return(e+n)%2==0;case 1:return e%2==0;case 2:return n%3==0;case 3:return(e+n)%3==0;case 4:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case 5:return e*n%2+e*n%3==0;case 6:return(e*n%2+e*n%3)%2==0;case 7:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new m([1],0),n=0;n<t;n++)e=e.multiply(new m([1,r.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:case o.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i++)for(var r=0;r<e;r++){for(var o=0,a=t.isDark(i,r),s=-1;s<=1;s++)if(!(i+s<0||e<=i+s))for(var l=-1;l<=1;l++)r+l<0||e<=r+l||0==s&&0==l||a!=t.isDark(i+s,r+l)||o++;5<o&&(n+=3+o-5)}for(i=0;i<e-1;i++)for(r=0;r<e-1;r++){var h=0;t.isDark(i,r)&&h++,t.isDark(i+1,r)&&h++,t.isDark(i,r+1)&&h++,t.isDark(i+1,r+1)&&h++,0!=h&&4!=h||(n+=3)}for(i=0;i<e;i++)for(r=0;r<e-6;r++)t.isDark(i,r)&&!t.isDark(i,r+1)&&t.isDark(i,r+2)&&t.isDark(i,r+3)&&t.isDark(i,r+4)&&!t.isDark(i,r+5)&&t.isDark(i,r+6)&&(n+=40);for(r=0;r<e;r++)for(i=0;i<e-6;i++)t.isDark(i,r)&&!t.isDark(i+1,r)&&t.isDark(i+2,r)&&t.isDark(i+3,r)&&t.isDark(i+4,r)&&!t.isDark(i+5,r)&&t.isDark(i+6,r)&&(n+=40);for(var u=0,r=0;r<e;r++)for(i=0;i<e;i++)t.isDark(i,r)&&u++;return n+Math.abs(100*u/e/e-50)/5*10}},r={glog:function(t){if(t<1)throw new Error("glog("+t+")");return r.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return r.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},t=0;t<8;t++)r.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)r.EXP_TABLE[t]=r.EXP_TABLE[t-4]^r.EXP_TABLE[t-5]^r.EXP_TABLE[t-6]^r.EXP_TABLE[t-8];for(t=0;t<255;t++)r.LOG_TABLE[r.EXP_TABLE[t]]=t;m.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=r.gexp(r.glog(this.get(n))+r.glog(t.get(i)));return new m(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=r.glog(this.get(0))-r.glog(t.get(0)),n=new Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<t.getLength();i++)n[i]^=r.gexp(r.glog(t.get(i))+e);return new m(n,0).mod(t)}},u.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],u.getRSBlocks=function(t,e){var n=u.getRsBlockTable(t,e);if(null==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var i=n.length/3,r=[],o=0;o<i;o++)for(var a=n[3*o+0],s=n[3*o+1],l=n[3*o+2],h=0;h<a;h++)r.push(new u(s,l));return r},u.getRsBlockTable=function(t,e){switch(e){case c.L:return u.RS_BLOCK_TABLE[4*(t-1)+0];case c.M:return u.RS_BLOCK_TABLE[4*(t-1)+1];case c.Q:return u.RS_BLOCK_TABLE[4*(t-1)+2];case c.H:return u.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},h.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var f=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],a=(d.prototype.draw=function(t){function e(t,e){var n,i=document.createElementNS("http://www.w3.org/2000/svg",t);for(n in e)e.hasOwnProperty(n)&&i.setAttribute(n,e[n]);return i}var n=this._htOption,i=this._el,r=t.getModuleCount(),o=(Math.floor(n.width/r),Math.floor(n.height/r),this.clear(),e("svg",{viewBox:"0 0 "+String(r)+" "+String(r),width:"100%",height:"100%",fill:n.colorLight}));o.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),i.appendChild(o),o.appendChild(e("rect",{fill:n.colorLight,width:"100%",height:"100%"})),o.appendChild(e("rect",{fill:n.colorDark,width:"1",height:"1",id:"template"}));for(var a,s=0;s<r;s++)for(var l=0;l<r;l++)t.isDark(s,l)&&((a=e("use",{x:String(l),y:String(s)})).setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),o.appendChild(a))},d.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},d),s="svg"===document.documentElement.tagName.toLowerCase()?a:"undefined"!=typeof CanvasRenderingContext2D?function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function e(t,e){this._bIsPainted=!1,this._android=i(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null}var u,c;return this._android&&this._android<=2.1&&(u=1/window.devicePixelRatio,c=CanvasRenderingContext2D.prototype.drawImage,CanvasRenderingContext2D.prototype.drawImage=function(t,e,n,i,r,o,a,s,l){if("nodeName"in t&&/img/i.test(t.nodeName))for(var h=arguments.length-1;1<=h;h--)arguments[h]=arguments[h]*u;else void 0===s&&(arguments[1]*=u,arguments[2]*=u,arguments[3]*=u,arguments[4]*=u);c.apply(this,arguments)}),e.prototype.draw=function(t){var e=this._elImage,n=this._oContext,i=this._htOption,r=t.getModuleCount(),o=i.width/r,a=i.height/r,s=Math.round(o),l=Math.round(a);e.style.display="none",this.clear();for(var h=0;h<r;h++)for(var u=0;u<r;u++){var c=t.isDark(h,u),f=u*o,d=h*a;n.strokeStyle=c?i.colorDark:i.colorLight,n.lineWidth=1,n.fillStyle=c?i.colorDark:i.colorLight,n.fillRect(f,d,o,a),n.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,l),n.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,l)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&function(t,e){var n=this;n._fFail=e,n._fSuccess=t,null===n._bSupportDataURI?((e=document.createElement("img")).onabort=t=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)},e.onerror=t,e.onload=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)},e.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="):!0===n._bSupportDataURI&&n._fSuccess?n._fSuccess.call(n):!1===n._bSupportDataURI&&n._fFail&&n._fFail.call(n)}.call(this,t)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(t){return t&&Math.floor(1e3*t)/1e3},e}():(n.prototype.draw=function(t){for(var e=this._htOption,n=this._el,i=t.getModuleCount(),r=Math.floor(e.width/i),o=Math.floor(e.height/i),a=['<table style="border:0;border-collapse:collapse;">'],s=0;s<i;s++){a.push("<tr>");for(var l=0;l<i;l++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+r+"px;height:"+o+"px;background-color:"+(t.isDark(s,l)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),n.innerHTML=a.join("");var n=n.childNodes[0],h=(e.width-n.offsetWidth)/2,u=(e.height-n.offsetHeight)/2;0<h&&0<u&&(n.style.margin=u+"px "+h+"px")},n.prototype.clear=function(){this._el.innerHTML=""},n);function n(t,e){this._el=t,this._htOption=e}function d(t,e){this._el=t,this._htOption=e}(QRCode=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:c.H},e="string"==typeof e?{text:e}:e)for(var n in e)this._htOption[n]=e[n];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(s=a),this._android=i(),this._el=t,this._oQRCode=null,this._oDrawing=new s(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(t){this._oQRCode=new l(function(t,e){for(var n,i=1,r=(n=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a")).length+(n.length!=t?3:0),o=0,a=f.length;o<=a;o++){var s=0;switch(e){case c.L:s=f[o][0];break;case c.M:s=f[o][1];break;case c.Q:s=f[o][2];break;case c.H:s=f[o][3]}if(r<=s)break;i++}if(f.length<i)throw new Error("Too long data");return i}(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=c}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).tinycolor=e()}(this,function(){"use strict";function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var v=/^\s+/,_=/\s+$/;function y(t,e){var n,i,r,o,a,s,l,h,u,c,f,d,p,g;return e=e||{},(t=t||"")instanceof y?t:this instanceof y?(c={r:0,g:0,b:0},d=null,g=p=!1,f=S("object"==b(n="string"==typeof(n=t)?function(t){t=t.replace(v,"").replace(_,"").toLowerCase();var e,n=!1;if(w[t])t=w[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=R.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=R.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=R.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=R.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=R.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=R.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=R.hex8.exec(t))?{r:A(e[1]),g:A(e[2]),b:A(e[3]),a:k(e[4]),format:n?"name":"hex8"}:(e=R.hex6.exec(t))?{r:A(e[1]),g:A(e[2]),b:A(e[3]),format:n?"name":"hex"}:(e=R.hex4.exec(t))?{r:A(e[1]+""+e[1]),g:A(e[2]+""+e[2]),b:A(e[3]+""+e[3]),a:k(e[4]+""+e[4]),format:n?"name":"hex8"}:!!(e=R.hex3.exec(t))&&{r:A(e[1]+""+e[1]),g:A(e[2]+""+e[2]),b:A(e[3]+""+e[3]),format:n?"name":"hex"}}(n):n)&&(I(n.r)&&I(n.g)&&I(n.b)?(h=n.r,u=n.g,f=n.b,c={r:255*C(h,255),g:255*C(u,255),b:255*C(f,255)},p=!0,g="%"===String(n.r).substr(-1)?"prgb":"rgb"):I(n.h)&&I(n.s)&&I(n.v)?(d=M(n.s),h=M(n.v),f=d,u=6*C(u=n.h,360),f=C(f,100),c={r:255*[h=C(h,100),l=h*(1-(u-=a=Math.floor(u))*f),s=h*(1-f),s,u=h*(1-(1-u)*f),h][f=a%6],g:255*[u,h,h,l,s,s][f],b:255*[s,s,u,h,h,l][f]},p=!0,g="hsv"):I(n.h)&&I(n.s)&&I(n.l)&&(u=d=M(n.s),h=a=M(n.l),s=C(s=n.h,360),u=C(u,100),h=C(h,100),0===u?i=r=o=h:(i=m(u=2*h-(h=h<.5?h*(1+u):h+u-h*u),h,s+1/3),r=m(u,h,s),o=m(u,h,s-1/3)),c={r:255*i,g:255*r,b:255*o},p=!0,g="hsl"),n.hasOwnProperty("a"))?n.a:1),l={ok:p,format:n.format||g,r:Math.min(255,Math.max(c.r,0)),g:Math.min(255,Math.max(c.g,0)),b:Math.min(255,Math.max(c.b,0)),a:f},this._originalInput=t,this._r=l.r,this._g=l.g,this._b=l.b,this._a=l.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||l.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),void(this._ok=l.ok)):new y(t,e);function m(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}function i(t,e,n){t=C(t,255),e=C(e,255),n=C(n,255);var i,r=Math.max(t,e,n),o=Math.min(t,e,n),a=(r+o)/2;if(r==o)i=l=0;else{var s=r-o,l=.5<a?s/(2-r-o):s/(r+o);switch(r){case t:i=(e-n)/s+(e<n?6:0);break;case e:i=(n-t)/s+2;break;case n:i=(t-e)/s+4}i/=6}return{h:i,s:l,l:a}}function r(t,e,n){t=C(t,255),e=C(e,255),n=C(n,255);var i,r=Math.max(t,e,n),o=Math.min(t,e,n),a=r,s=r-o,l=0===r?0:s/r;if(r==o)i=0;else{switch(r){case t:i=(e-n)/s+(e<n?6:0);break;case e:i=(n-t)/s+2;break;case n:i=(t-e)/s+4}i/=6}return{h:i,s:l,v:a}}function e(t,e,n,i){return t=[x(Math.round(t).toString(16)),x(Math.round(e).toString(16)),x(Math.round(n).toString(16))],i&&t[0].charAt(0)==t[0].charAt(1)&&t[1].charAt(0)==t[1].charAt(1)&&t[2].charAt(0)==t[2].charAt(1)?t[0].charAt(0)+t[1].charAt(0)+t[2].charAt(0):t.join("")}function o(t,e,n,i){return[x(D(i)),x(Math.round(t).toString(16)),x(Math.round(e).toString(16)),x(Math.round(n).toString(16))].join("")}function t(t,e){return e=0===e?0:e||10,(t=y(t).toHsl()).s-=e/100,t.s=P(t.s),y(t)}function n(t,e){return e=0===e?0:e||10,(t=y(t).toHsl()).s+=e/100,t.s=P(t.s),y(t)}function a(t){return y(t).desaturate(100)}function s(t,e){return e=0===e?0:e||10,(t=y(t).toHsl()).l+=e/100,t.l=P(t.l),y(t)}function l(t,e){return e=0===e?0:e||10,(t=y(t).toRgb()).r=Math.max(0,Math.min(255,t.r-Math.round(-e/100*255))),t.g=Math.max(0,Math.min(255,t.g-Math.round(-e/100*255))),t.b=Math.max(0,Math.min(255,t.b-Math.round(-e/100*255))),y(t)}function h(t,e){return e=0===e?0:e||10,(t=y(t).toHsl()).l-=e/100,t.l=P(t.l),y(t)}function u(t,e){return e=((t=y(t).toHsl()).h+e)%360,t.h=e<0?360+e:e,y(t)}function c(t){return(t=y(t).toHsl()).h=(t.h+180)%360,y(t)}function f(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=y(t).toHsl(),i=[y(t)],r=360/e,o=1;o<e;o++)i.push(y({h:(n.h+o*r)%360,s:n.s,l:n.l}));return i}function d(t){var e=y(t).toHsl(),n=e.h;return[y(t),y({h:(n+72)%360,s:e.s,l:e.l}),y({h:(n+216)%360,s:e.s,l:e.l})]}function p(t,e,n){e=e||6,n=n||30;var i=y(t).toHsl(),r=360/n,o=[y(t)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,o.push(y(i));return o}function g(t,e){e=e||6;for(var n=(t=y(t).toHsv()).h,i=t.s,r=t.v,o=[],a=1/e;e--;)o.push(y({h:n,s:i,v:r})),r=(r+a)%1;return o}y.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t=(n=this.toRgb()).r/255,e=n.g/255,n=n.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((.055+n)/1.055,2.4))},setAlpha:function(t){return this._a=S(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),t=Math.round(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+t+"%)":"hsva("+e+", "+n+"%, "+t+"%, "+this._roundA+")"},toHsl:function(){var t=i(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=i(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),t=Math.round(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+t+"%)":"hsla("+e+", "+n+"%, "+t+"%, "+this._roundA+")"},toHex:function(t){return e(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){var e=this._r,n=this._g,i=this._b,r=this._a,e=[x(Math.round(e).toString(16)),x(Math.round(n).toString(16)),x(Math.round(i).toString(16)),x(D(r))];return t&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)&&e[3].charAt(0)==e[3].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0)+e[3].charAt(0):e.join("")},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*C(this._r,255))+"%",g:Math.round(100*C(this._g,255))+"%",b:Math.round(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*C(this._r,255))+"%, "+Math.round(100*C(this._g,255))+"%, "+Math.round(100*C(this._b,255))+"%)":"rgba("+Math.round(100*C(this._r,255))+"%, "+Math.round(100*C(this._g,255))+"%, "+Math.round(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(m[e(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+o(this._r,this._g,this._b,this._a),n=e;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+e+",endColorstr="+(t?"#"+o((e=y(t))._r,e._g,e._b,e._a):n)+")"},toString:function(t){var e=!!t,n=(t=t||this._format,!1),i=this._a<1&&0<=this._a;return e||!i||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),(n="hsv"===t?this.toHsvString():n)||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return y(this.toString())},_applyModification:function(t,e){return t=t.apply(null,[this].concat([].slice.call(e))),this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},lighten:function(){return this._applyModification(s,arguments)},brighten:function(){return this._applyModification(l,arguments)},darken:function(){return this._applyModification(h,arguments)},desaturate:function(){return this._applyModification(t,arguments)},saturate:function(){return this._applyModification(n,arguments)},greyscale:function(){return this._applyModification(a,arguments)},spin:function(){return this._applyModification(u,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(p,arguments)},complement:function(){return this._applyCombination(c,arguments)},monochromatic:function(){return this._applyCombination(g,arguments)},splitcomplement:function(){return this._applyCombination(d,arguments)},triad:function(){return this._applyCombination(f,[3])},tetrad:function(){return this._applyCombination(f,[4])}},y.fromRatio=function(t,e){if("object"==b(t)){var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]="a"===n?t[n]:M(t[n]));t=i}return y(t,e)},y.equals=function(t,e){return!(!t||!e)&&y(t).toRgbString()==y(e).toRgbString()},y.random=function(){return y.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},y.mix=function(t,e,n){return n=0===n?0:n||50,t=y(t).toRgb(),e=y(e).toRgb(),y({r:(e.r-t.r)*(n/=100)+t.r,g:(e.g-t.g)*n+t.g,b:(e.b-t.b)*n+t.b,a:(e.a-t.a)*n+t.a})},y.readability=function(t,e){return t=y(t),e=y(e),(Math.max(t.getLuminance(),e.getLuminance())+.05)/(Math.min(t.getLuminance(),e.getLuminance())+.05)},y.isReadable=function(t,e,n){var i=y.readability(t,e),r=!1;switch((n={level:e="AA"!==(e=((t=n||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==e?"AA":e,size:t="small"!==(t=(t.size||"small").toLowerCase())&&"large"!==t?"small":t}).level+n.size){case"AAsmall":case"AAAlarge":r=4.5<=i;break;case"AAlarge":r=3<=i;break;case"AAAsmall":r=7<=i}return r},y.mostReadable=function(t,e,n){for(var i,r=null,o=0,a=(n=n||{}).includeFallbackColors,s=n.level,l=n.size,h=0;h<e.length;h++)(i=y.readability(t,e[h]))>o&&(o=i,r=y(e[h]));return y.isReadable(t,r,{level:s,size:l})||!a?r:(n.includeFallbackColors=!1,y.mostReadable(t,["#fff","#000"],n))};var w=y.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},m=y.hexNames=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}(w);function S(t){return t=parseFloat(t),isNaN(t)||t<0||1<t?1:t}function C(t,e){var n="string"==typeof(t="string"==typeof(n=t)&&-1!=n.indexOf(".")&&1===parseFloat(n)?"100%":t)&&-1!=t.indexOf("%");return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function P(t){return Math.min(1,Math.max(0,t))}function A(t){return parseInt(t,16)}function x(t){return 1==t.length?"0"+t:""+t}function M(t){return t<=1?100*t+"%":t}function D(t){return Math.round(255*parseFloat(t)).toString(16)}function k(t){return A(t)/255}var E,T,L,T="[\\s|\\(]+("+(E="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+E+")[,|\\s]+("+E+")\\s*\\)?",L="[\\s|\\(]+("+E+")[,|\\s]+("+E+")[,|\\s]+("+E+")[,|\\s]+("+E+")\\s*\\)?",R={CSS_UNIT:new RegExp(E),rgb:new RegExp("rgb"+T),rgba:new RegExp("rgba"+L),hsl:new RegExp("hsl"+T),hsla:new RegExp("hsla"+L),hsv:new RegExp("hsv"+T),hsva:new RegExp("hsva"+L),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function I(t){return R.CSS_UNIT.exec(t)}return y}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Picker=e()}(this,function(){"use strict";function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){var n=e,i=[],r=!0,e=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!n||i.length!==n);r=!0);}catch(t){e=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(e)throw o}}return i}throw new TypeError("Invalid attempt to destructure non-iterable instance")}String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var n=this;n.length<t;)n=e+n;return n};var e={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function r(t,e){return(0<(e=1<arguments.length&&void 0!==e?e:1)?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString())||"0"}t(c,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map(function(t,e){return r(t,3===e?3:0)});return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var n=[360,100,100,1],i=["","%","%",""],e=(t?this.hsla:this.hsla.slice(0,3)).map(function(t,e){return r(t*n[e],3===e?3:1)+i[e]});return t?"hsla("+e+")":"hsl("+e+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(this._hsla)return this._rgba=c.hslToRgb(this._hsla);throw new Error("No color is set")},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(this._rgba)return this._hsla=c.rgbToHsl(this._rgba);throw new Error("No color is set")},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map(function(t,e){return(e<3?t:Math.round(255*t)).toString(16)}).map(function(t){return t.padStart(2,"0")}).join("")},set:function(t){this.rgba=c.hexToRgb(t)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(e.match(/^([0-9a-fA-F]{8})$/))return(e=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(t){return parseInt(t,16)}))[3]=e[3]/255,e;throw new Error("Unknown hex color; "+t)}},{key:"nameToRgb",value:function(t){return t=t.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),void 0===(t=e[t])?t:c.hexToRgb(t.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=(t=u(t,4))[0],n=t[1],i=t[2],t=t[3],r=(e/=255,n/=255,i/=255,Math.max(e,n,i)),o=Math.min(e,n,i),a=void 0,s=void 0,l=(r+o)/2;if(r===o)a=s=0;else{var h=r-o,s=.5<l?h/(2-r-o):h/(r+o);switch(r){case e:a=(n-i)/h+(n<i?6:0);break;case n:a=(i-e)/h+2;break;case i:a=(e-n)/h+4}a/=6}return[a,s,l,t]}},{key:"hslToRgb",value:function(t){var e=(t=u(t,4))[0],n=t[1],i=t[2],t=t[3],r=void 0,o=void 0,a=void 0,s=(0===n?r=o=a=i:(r=(s=function(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t})(n=2*i-(i=i<.5?i*(1+n):i+n-i*n),i,e+1/3),o=s(n,i,e),a=s(n,i,e-1/3)),[255*r,255*o,255*a].map(Math.round));return s[3]=t,s}}]);var o=c;function c(t,e,n,i){h(this,c);var r,o,a,s,l;void 0!==t&&(Array.isArray(t)?this.rgba=t:void 0===n?(r=t&&""+t)&&((r=r.toLowerCase()).startsWith("hsl")?(a=r.match(/([\-\d\.e]+)/g).map(Number),s=(a=u(a,4))[0],l=a[1],o=a[2],a=a[3],this.hsla=[s/=360,l/=100,o/=100,a=void 0===a?1:a]):r.startsWith("rgb")?(s=r.match(/([\-\d\.e]+)/g).map(Number),o=(l=u(s,4))[0],a=l[1],s=l[2],l=l[3],this.rgba=[o,a,s,l=void 0===l?1:l]):r.startsWith("#")?this.rgba=c.hexToRgb(r):this.rgba=c.nameToRgb(r)||c.hexToRgb(r)):this.rgba=[t,e,n,void 0===i?1:i])}t(a,[{key:"add",value:function(t,e,n){t.addEventListener(e,n,!1),this._events.push({target:t,type:e,handler:n})}},{key:"remove",value:function(n,i,r){this._events=this._events.filter(function(t){var e=!0;return n&&n!==t.target&&(e=!1),i&&i!==t.type&&(e=!1),(e=(!r||r===t.handler)&&e)&&a._doRemove(t.target,t.type,t.handler),!e})}},{key:"destroy",value:function(){this._events.forEach(function(t){return a._doRemove(t.target,t.type,t.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(t,e,n){t.removeEventListener(e,n,!1)}}]);var n=a;function a(){h(this,a),this._events=[]}function s(t,o,a){var s=!1;function l(t,e,n){return Math.max(e,Math.min(t,n))}function n(t,e,n){var i,r;(s=!!n||s)&&(t.preventDefault(),t=(n=o.getBoundingClientRect()).width,i=n.height,r=e.clientX,e=e.clientY,r=l(r-n.left,0,t),e=l(e-n.top,0,i),a(r/t,e/i))}function e(t,e){1===(void 0===t.buttons?t.which:t.buttons)?n(t,t,e):s=!1}function i(t,e){1===t.touches.length?n(t,t.touches[0],e):s=!1}t.add(o,"mousedown",function(t){e(t,!0)}),t.add(o,"touchstart",function(t){i(t,!0)}),t.add(window,"mousemove",e),t.add(o,"touchmove",i),t.add(window,"mouseup",function(t){s=!1}),t.add(o,"touchend",function(t){s=!1}),t.add(o,"touchcancel",function(t){s=!1})}var l="keydown",f="mousedown",d="focusin";function p(t,e){return(e||document).querySelector(t)}function g(t){t.preventDefault(),t.stopPropagation()}function m(t,e,n,i,r){t.add(e,l,function(t){0<=n.indexOf(t.key)&&(r&&g(t),i(t))})}function b(t){h(this,b),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new n,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(t)}return t(b,[{key:"setOptions",value:function(t){var e=this;if(t){var n,i=this.settings;if(t instanceof HTMLElement)i.parent=t;else{i.parent&&t.parent&&i.parent!==t.parent&&(this._events.remove(i.parent),this._popupInited=!1);var r,o,a=t,s=i;for(r in a)s[r]=a[r];t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose),(o=t.color||t.colour)&&this._setColor(o)}(o=i.parent)&&i.popup&&!this._popupInited?(this._events.add(o,"click",n=function(t){return e.openHandler(t)}),m(this._events,o,[" ","Spacebar","Enter"],n),this._popupInited=!0):t.parent&&!i.popup&&this.show()}}},{key:"openHandler",value:function(t){var e;this.show()&&(t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none",e=t&&t.type===l?this._domEdit:this.domElement,setTimeout(function(){return e.focus()},100),this.onOpen)&&this.onOpen(this.colour)}},{key:"closeHandler",value:function(t){var e,n=t&&t.type,i=!1;t?n===f||n===d?(e=(this.__containedEvent||0)+100,t.timeStamp>e&&(i=!0)):(g(t),i=!0):i=!0,i&&this.hide()&&(this.settings.parent.style.pointerEvents="",n!==f&&this.settings.parent.focus(),this.onClose)&&this.onClose(this.colour)}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if(t="string"==typeof t?t.trim():t){e=e||{};var n=void 0;try{n=new o(t)}catch(t){if(e.failSilently)return;throw t}this.settings.alpha||((t=n.hsla)[3]=1,n.hsla=t),this.colour=this.color=n,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){var t,e,n;return!!this.settings.parent&&(this.domElement?(e=this._toggleDOM(!0),this._setPosition(),e):(e=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',(n=document.createElement("div")).innerHTML=e,t=n.firstElementChild,this.domElement=t,this._domH=p(".picker_hue",t),this._domSL=p(".picker_sl",t),this._domA=p(".picker_alpha",t),this._domEdit=p(".picker_editor input",t),this._domSample=p(".picker_sample",t),this._domOkay=p(".picker_done button",t),this._domCancel=p(".picker_cancel button",t),t.classList.add("layout_"+this.settings.layout),this.settings.alpha||t.classList.add("no_alpha"),this.settings.editor||t.classList.add("no_editor"),this.settings.cancelButton||t.classList.add("no_cancel"),this._ifPopup(function(){return t.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0))}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var n=this,i=this,r=this.domElement,o=this._events;function a(t,e,n){o.add(t,e,n)}function t(t){n._ifPopup(function(){return n.closeHandler(t)}),n.onDone&&n.onDone(n.colour)}a(r,"click",function(t){return t.preventDefault()}),s(o,this._domH,function(t,e){i._setHSLA(t)}),s(o,this._domSL,function(t,e){i._setHSLA(null,t,1-e)}),this.settings.alpha&&s(o,this._domA,function(t,e){i._setHSLA(null,null,null,1-e)});var e=this._domEdit;a(e,"input",function(t){i._setColor(this.value,{fromEditor:!0,failSilently:!0})}),a(e,"focus",function(t){this.selectionStart===this.selectionEnd&&this.select()}),this._ifPopup(function(){function t(t){return n.closeHandler(t)}function e(t){n.__containedEvent=t.timeStamp}a(window,f,t),a(window,d,t),m(o,r,["Esc","Escape"],t),a(r,f,e),a(r,d,e),a(n._domCancel,"click",t)}),a(this._domOkay,"click",t),m(o,r,["Enter"],t)}},{key:"_setPosition",value:function(){var n=this.settings.parent,i=this.domElement;n!==i.parentNode&&n.appendChild(i),this._ifPopup(function(t){"static"===getComputedStyle(n).position&&(n.style.position="relative");var e=!0===t?"popup_right":"popup_"+t;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(t){t===e?i.classList.add(t):i.classList.remove(t)}),i.classList.add(e)})}},{key:"_setHSLA",value:function(t,e,n,i,r){r=r||{};var o=this.colour,a=o.hsla;[t,e,n,i].forEach(function(t,e){!t&&0!==t||(a[e]=t)}),o.hsla=a,this._updateUI(r),this.onChange&&!r.silent&&this.onChange(o)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,n=e.hsla,i="hsl("+360*n[0]+", 100%, 50%)",r=e.hslString,o=e.hslaString,a=this._domH,s=this._domSL,l=this._domA,a=p(".picker_selector",a),h=p(".picker_selector",s),l=p(".picker_selector",l);f(0,a,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,f(0,h,n[1]),d(0,h,1-n[2]),s.style.color=r,d(0,l,1-n[3]);i=(a=r).replace("hsl","hsla").replace(")",", 0)");if(this._domA.style.background="linear-gradient("+[a,i]+"), linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",!t.fromEditor){var h=this.settings.editorFormat,u=this.settings.alpha,c=void 0;switch(h){case"rgb":c=e.printRGB(u);break;case"hsl":c=e.printHSL(u);break;default:c=e.printHex(u)}this._domEdit.value=c}this._domSample.style.color=o}function f(t,e,n){e.style.left=100*n+"%"}function d(t,e,n){e.style.top=100*n+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e,n=this.domElement;return!!n&&((e=n.style.display!==(t=t?"":"none"))&&(n.style.display=t),e)}}]),b}),function(){function O(t,e,n){return t.call.apply(t.bind,arguments)}function N(e,n,t){var i;if(e)return 2<arguments.length?(i=Array.prototype.slice.call(arguments,2),function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}):function(){return e.apply(n,arguments)};throw Error()}function p(t,e,n){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?O:N).apply(null,arguments)}var s=Date.now||function(){return+new Date};function B(t,e){this.a=t,this.m=e||t,this.c=this.m.document}var G=!!window.FontFace;function l(t,e,n,i){if(e=t.c.createElement(e),n)for(var r in n)n.hasOwnProperty(r)&&("style"==r?e.style.cssText=n[r]:e.setAttribute(r,n[r]));return i&&e.appendChild(t.c.createTextNode(i)),e}function h(t,e,n){(t=(t=t.c.getElementsByTagName(e)[0])||document.documentElement).insertBefore(n,t.lastChild)}function n(t){t.parentNode&&t.parentNode.removeChild(t)}function g(t,e,n){e=e||[],n=n||[];for(var i=t.className.split(/\s+/),r=0;r<e.length;r+=1){for(var o=!1,a=0;a<i.length;a+=1)if(e[r]===i[a]){o=!0;break}o||i.push(e[r])}for(e=[],r=0;r<i.length;r+=1){for(o=!1,a=0;a<n.length;a+=1)if(i[r]===n[a]){o=!0;break}o||e.push(i[r])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function o(t,e){for(var n=t.className.split(/\s+/),i=0,r=n.length;i<r;i++)if(n[i]==e)return!0;return!1}function P(t){var e;return"string"==typeof t.f?t.f:"https:"==("about:"==(e=t.m.location.protocol)?t.a.location.protocol:e)?"https:":"http:"}function A(t,e,n){function i(){a&&r&&(a(o),a=null)}e=l(t,"link",{rel:"stylesheet",href:e,media:"all"});var r=!1,o=null,a=n||null;G?(e.onload=function(){r=!0,i()},e.onerror=function(){r=!0,o=Error("Stylesheet failed to load"),i()}):setTimeout(function(){r=!0,i()},0),h(t,"head",e)}function i(t,e,n,i){var r,o,a=t.c.getElementsByTagName("head")[0];return a?(r=l(t,"script",{src:e}),o=!1,r.onload=r.onreadystatechange=function(){o||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(o=!0,n&&n(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&a.removeChild(r))},a.appendChild(r),setTimeout(function(){o||(o=!0,n&&n(Error("Script load timeout")))},i||5e3),r):null}function x(){this.a=0,this.c=null}function M(t){return t.a++,function(){t.a--,r(t)}}function D(t,e){t.c=e,r(t)}function r(t){0==t.a&&t.c&&(t.c(),t.c=null)}function a(t){this.a=t||"-"}function k(t,e){this.c=t,this.f=4,this.a="n",(t=(e||"n4").match(/^([nio])([1-9])$/i))&&(this.a=t[1],this.f=parseInt(t[2],10))}function u(t){var e=[];t=t.split(/,\s*/);for(var n=0;n<t.length;n++){var i=t[n].replace(/['"]/g,"");-1!=i.indexOf(" ")||/^\d/.test(i)?e.push("'"+i+"'"):e.push(i)}return e.join(",")}function m(t){return t.a+t.f}function c(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function J(t,e){this.c=t,this.f=t.m.document.documentElement,this.h=e,this.a=new a("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function b(t){var e,n,i;t.g&&(e=o(t.f,t.a.c("wf","active")),n=[],i=[t.a.c("wf","loading")],e||n.push(t.a.c("wf","inactive")),g(t.f,n,i)),v(t,"inactive")}function v(t,e,n){t.j&&t.h[e]&&(n?t.h[e](n.c,m(n)):t.h[e]())}function H(){this.c={}}function f(t,e){this.c=t,this.f=e,this.a=l(this.c,"span",{"aria-hidden":"true"},this.f)}function d(t){h(t.c,"body",t.a)}function _(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+u(t.c)+";font-style:"+c(t)+";font-weight:"+t.f+"00;"}function y(t,e,n,i,r,o){this.g=t,this.j=e,this.a=i,this.c=n,this.f=r||3e3,this.h=o||void 0}function w(t,e,n,i,r,o,a){this.v=t,this.B=e,this.c=n,this.a=i,this.s=a||"BESbswy",this.f={},this.w=r||3e3,this.u=o||null,this.o=this.j=this.h=this.g=null,this.g=new f(this.c,this.s),this.h=new f(this.c,this.s),this.j=new f(this.c,this.s),this.o=new f(this.c,this.s),t=_(t=new k(this.a.c+",serif",m(this.a))),this.g.a.style.cssText=t,t=_(t=new k(this.a.c+",sans-serif",m(this.a))),this.h.a.style.cssText=t,t=_(t=new k("serif",m(this.a))),this.j.a.style.cssText=t,t=_(t=new k("sans-serif",m(this.a))),this.o.a.style.cssText=t,d(this.g),d(this.h),d(this.j),d(this.o)}a.prototype.c=function(t){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},y.prototype.start=function(){var r=this.c.m.document,o=this,a=s(),t=new Promise(function(n,i){!function e(){var t;s()-a>=o.f?i():r.fonts.load(c(t=o.a)+" "+t.f+"00 300px "+u(t.c),o.h).then(function(t){1<=t.length?n():setTimeout(e,25)},function(){i()})}()}),e=new Promise(function(t,e){setTimeout(e,o.f)});Promise.race([e,t]).then(function(){o.g(o.a)},function(){o.j(o.a)})};var S={D:"serif",C:"sans-serif"},e=null;function C(){var t;return null===e&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),e=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)),e}function E(t,e,n){for(var i in S)if(S.hasOwnProperty(i)&&e===t.f[S[i]]&&n===t.f[S[i]])return 1}function T(t,e){setTimeout(p(function(){n(this.g.a),n(this.h.a),n(this.j.a),n(this.o.a),e(this.a)},t),0)}function L(t,e,n){this.c=t,this.a=e,this.f=0,this.o=this.j=!1,this.s=n}w.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.o.a.offsetWidth,this.A=s(),function t(e){var n=e.g.a.offsetWidth,i=e.h.a.offsetWidth;n===e.f.serif&&i===e.f["sans-serif"]||C()&&E(e,n,i)?s()-e.A>=e.w?C()&&E(e,n,i)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?T(e,e.v):T(e,e.B):setTimeout(p(function(){t(this)},e),50):T(e,e.v)}(this)};var R=null;function I(t){0==--t.f&&t.j&&(t.o?((t=t.a).g&&g(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),v(t,"active")):b(t.a))}function j(t){this.j=t,this.a=new H,this.h=0,this.f=this.g=!0}function U(t,e){this.c=t,this.a=e}function W(t,e){this.c=t,this.a=e}function X(t,e,n){this.c=t||e+"//fonts.googleapis.com/css",this.a=[],this.f=[],this.g=n||""}function q(t){this.f=t,this.a=[],this.c={}}L.prototype.g=function(t){var e=this.a;e.g&&g(e.f,[e.a.c("wf",t.c,m(t).toString(),"active")],[e.a.c("wf",t.c,m(t).toString(),"loading"),e.a.c("wf",t.c,m(t).toString(),"inactive")]),v(e,"fontactive",t),this.o=!0,I(this)},L.prototype.h=function(t){var e,n,i,r=this.a;r.g&&(e=o(r.f,r.a.c("wf",t.c,m(t).toString(),"active")),n=[],i=[r.a.c("wf",t.c,m(t).toString(),"loading")],e||n.push(r.a.c("wf",t.c,m(t).toString(),"inactive")),g(r.f,n,i)),v(r,"fontinactive",t),I(this)},j.prototype.load=function(t){this.c=new B(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes;var e,i=this,n=new J(this.c,t),r=t,o=[],t=r.timeout,o=((e=n).g&&g(e.f,[e.a.c("wf","loading")]),v(e,"loading"),function(t,e,n){var i,r,o=[];for(i in e)e.hasOwnProperty(i)&&(r=t.c[i])&&o.push(r(e[i],n));return o}(i.a,r,i.c)),a=new L(i.c,n,t);for(i.h=o.length,n=0,r=o.length;n<r;n++)o[n].load(function(t,e,n){var h=a,u=t,c=e,f=n,d=0==--(t=i).h;(t.f||t.g)&&setTimeout(function(){var t=f||null,e=c||{};if(0===u.length&&d)b(h.a);else{h.f+=u.length,d&&(h.j=d);for(var n=[],i=0;i<u.length;i++){var r,o=u[i],a=e[o.c],s=h.a,l=o;s.g&&g(s.f,[s.a.c("wf",l.c,m(l).toString(),"loading")]),v(s,"fontloading",l),s=(R=(s=null)===R?!!window.FontFace&&(l=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),r=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor),l?42<parseInt(l[1],10):!r):R)?new y(p(h.g,h),p(h.h,h),h.c,o,h.s,a):new w(p(h.g,h),p(h.h,h),h.c,o,h.s,t,a),n.push(s)}for(i=0;i<n.length;i++)n[i].start()}},0)})},U.prototype.load=function(a){var s,t,e=this,l=e.a.projectId,n=e.a.version;l?(s=e.c.m,i(this.c,(t=l,P(e.c)+"//"+(e.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"")+"/"+t+".js"+(n?"?v="+n:"")),function(t){t?a([]):(s["__MonotypeConfiguration__"+l]=function(){return e.a},function t(){if(s["__mti_fntLst"+l]){var e,n=s["__mti_fntLst"+l](),i=[];if(n)for(var r=0;r<n.length;r++){var o=n[r].fontfamily;null!=n[r].fontStyle&&null!=n[r].fontWeight?(e=n[r].fontStyle+n[r].fontWeight,i.push(new k(o,e))):i.push(new k(o))}a(i)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+l):a([])},W.prototype.load=function(t){for(var e=this.a.urls||[],n=this.a.families||[],i=this.a.testStrings||{},r=new x,o=0,a=e.length;o<a;o++)A(this.c,e[o],M(r));for(var s=[],o=0,a=n.length;o<a;o++)if((e=n[o].split(":"))[1])for(var l=e[1].split(","),h=0;h<l.length;h+=1)s.push(new k(e[0],l[h]));else s.push(new k(e[0]));D(r,function(){t(s,i)})};var Y={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},$={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},V={i:"i",italic:"i",n:"n",normal:"n"},z=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function K(t,e){this.c=t,this.a=e}var Q={Arimo:!0,Cousine:!0,Tinos:!0};function Z(t,e){this.c=t,this.a=e}function tt(t,e){this.c=t,this.f=e,this.a=[]}K.prototype.load=function(t){for(var e=new x,n=this.c,i=new X(this.a.api,P(n),this.a.text),r=this.a.families,o=i,a=r,s=a.length,l=0;l<s;l++){var h=a[l].split(":"),u=(3==h.length&&o.f.push(h.pop()),"");2==h.length&&""!=h[1]&&(u=":"),o.a.push(h.join(u))}for(var c=new q(r),f=c,d=f.f.length,p=0;p<d;p++){var g=f.f[p].split(":"),m=g[0].replace(/\+/g," "),b=["n4"];if(2<=g.length){var v,_,y=g[1],w=[];if(y)for(var S=(y=y.split(",")).length,C=0;C<S;C++)(_=(_=y[C]).match(/^[\w-]+$/)&&null!=(v=z.exec(_.toLowerCase()))?[_=null==(_=v[2])||""==_?"n":V[_],v=null==(v=v[1])||""==v?"4":$[v]||(isNaN(v)?"4":v.substr(0,1))].join(""):"")&&w.push(_);0<w.length&&(b=w),3==g.length&&(w=[],0<(g=(g=g[2])?g.split(","):w).length)&&(g=Y[g[0]])&&(f.c[m]=g)}for(f.c[m]||(g=Y[m])&&(f.c[m]=g),g=0;g<b.length;g+=1)f.a.push(new k(m,b[g]))}A(n,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,n=[],i=0;i<e;i++)n.push(t.a[i].replace(/ /g,"+"));return e=t.c+"?family="+n.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(i),M(e)),D(e,function(){t(c.a,c.c,Q)})},Z.prototype.load=function(a){var t=this.a.id,s=this.c.m;t?i(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)a([]);else if(s.Typekit&&s.Typekit.config&&s.Typekit.config.fn){t=s.Typekit.config.fn;for(var e=[],n=0;n<t.length;n+=2)for(var i=t[n],r=t[n+1],o=0;o<r.length;o++)e.push(new k(i,r[o]));try{s.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}a(e)}},2e3):a([])},tt.prototype.load=function(l){var t=this.f.id,e=this.c.m,h=this;t?(e.__webfontfontdeckmodule__||(e.__webfontfontdeckmodule__={}),e.__webfontfontdeckmodule__[t]=function(t,e){for(var n,i,r,o=0,a=e.fonts.length;o<a;++o){var s=e.fonts[o];h.a.push(new k(s.name,(r=i=n=void 0,n=4,i="n",r=null,(s="font-weight:"+s.weight+";font-style:"+s.style)&&((r=s.match(/(normal|oblique|italic)/i))&&r[1]&&(i=r[1].substr(0,1).toLowerCase()),r=s.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?n=7:/[1-9]00/.test(r[1])&&(n=parseInt(r[1].substr(0,1),10))),i+n)))}l(h.a)},i(this.c,P(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+((e=this.c).m.location.hostname||e.a.location.hostname)+"/"+t+".js",function(t){t&&l([])})):l([])};var t=new j(window),F=(t.a.c.custom=function(t,e){return new W(e,t)},t.a.c.fontdeck=function(t,e){return new tt(e,t)},t.a.c.monotype=function(t,e){return new U(e,t)},t.a.c.typekit=function(t,e){return new Z(e,t)},t.a.c.google=function(t,e){return new K(e,t)},{load:p(t.load,t)});"function"==typeof define&&define.amd?define(function(){return F}):"undefined"!=typeof module&&module.exports?module.exports=F:(window.WebFont=F,window.WebFontConfig&&t.load(window.WebFontConfig))}();
(()=>{var i={221:function(){const a=(e,t,i,n,s,a,o=8,r=8)=>{n=n||{};var c=this.sizeX||n.cornerSize||s.cornerSize,l=this.sizeY||n.cornerSize||s.cornerSize,d=c/2,p=l/2,h=.6*c,u=s.cornerIconColor||"#000000";e.save(),e.translate(t,i),e.rotate(fabric.util.degreesToRadians(s.angle)),e.fillStyle=n.cornerColor||s.cornerColor,e.beginPath(),e.roundRect(-d+o,-p+r,c,l,4),e.filter="drop-shadow(0px 0px 2px rgba(0,0,0, 0.3))",e.fill(),e.font=h+"px FontFPD",e.fillStyle=u,e.textAlign="left",e.textBaseline="top",e.filter="none",e.fillText(a,-.5*h+o,-.5*h+r),e.restore()},e=(e,t,i,n,s)=>{n=n||{},e.save(),e.translate(t,i),e.rotate(fabric.util.degreesToRadians(s.angle)),e.fillStyle=n.cornerColor||s.cornerColor,e.beginPath(),e.roundRect(-3,-7.5,6,15,4),e.filter="drop-shadow(0px 0px 2px rgba(0,0,0, 0.3))",e.fill(),e.restore()},t=(e,t,i,n,s)=>{n=n||{},e.save(),e.translate(t,i),e.rotate(fabric.util.degreesToRadians(s.angle)),e.fillStyle=n.cornerColor||s.cornerColor,e.beginPath(),e.roundRect(-7.5,-3,15,6,4),e.filter="drop-shadow(0px 0px 2px rgba(0,0,0, 0.3))",e.fill(),e.restore()};fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.controls.tl.cursorStyleHandler=()=>"pointer",fabric.Object.prototype.controls.tl.mouseDownHandler=function(e,t){t=t.target;t.canvas.duplicateElement(t)},fabric.Object.prototype.controls.tl.actionHandler=null,fabric.Object.prototype.controls.tl.render=function(e,t,i,n,s){s.canvas&&s.canvas.viewOptions&&"basic"===s.canvas.viewOptions.cornerControlsStyle?fabric.controlsUtils.renderCircleControl.call(this,e,t,i,n,s):a(e,t,i,n,s,String.fromCharCode("0xe942"),-8,-8)},fabric.Object.prototype.controls.tr.cursorStyleHandler=()=>"pointer",fabric.Object.prototype.controls.tr.mouseDownHandler=function(e,t){t=t.target;t.canvas.removeElement(t)},fabric.Object.prototype.controls.tr.actionHandler=null,fabric.Object.prototype.controls.tr.render=function(e,t,i,n,s){s.canvas&&s.canvas.viewOptions&&"basic"===s.canvas.viewOptions.cornerControlsStyle?fabric.controlsUtils.renderCircleControl.call(this,e,t,i,n,s):a(e,t,i,n,s,String.fromCharCode("0xe926"),8,-8)},fabric.Object.prototype.controls.mtr.withConnection=!1,fabric.Object.prototype.controls.mtr.y=.5,fabric.Object.prototype.controls.mtr.offsetY=25,fabric.Object.prototype.controls.mtr.offsetX=-8,fabric.Object.prototype.controls.mtr.render=function(e,t,i,n,s){s.canvas&&s.canvas.viewOptions&&"basic"===s.canvas.viewOptions.cornerControlsStyle?fabric.controlsUtils.renderCircleControl.call(this,e,t,i,n,s):a(e,t,i,n,s,String.fromCharCode("0xe923"))},fabric.Object.prototype.controls.br.render=function(e,t,i,n,s){s.canvas&&s.canvas.viewOptions&&"basic"===s.canvas.viewOptions.cornerControlsStyle?fabric.controlsUtils.renderCircleControl.call(this,e,t,i,n,s):a(e,t,i,n,s,String.fromCharCode("0xe922"))},fabric.Object.prototype.controls.ml.render=e,fabric.Object.prototype.controls.mr.render=e,fabric.Object.prototype.controls.mt.render=t,fabric.Object.prototype.controls.mb.render=t,fabric.Textbox.prototype.controls.ml.render=e,fabric.Textbox.prototype.controls.mr.render=e,fabric.Object.prototype.controls.bl.visible=!1},295:()=>{fabric.Group.prototype.changeObjectColor=function(e,t){let i=[];return this.getObjects().forEach(e=>{e=tinycolor(e.fill);i.push(e.toHexString())}),i[e]=t,this.changeColor(i),i}},859:()=>{var t;fabric.Text.prototype.initialize=(t=fabric.Text.prototype.initialize,function(...e){return t.call(this,...e),this._TextInit(),this}),fabric.Text.prototype._TextInit=function(){this.on({modified:e=>{var t,i;(t=this).curved||t.uniScalingUnlockable||(i=t.fontSize*t.scaleX,i=parseFloat(Number(i).toFixed(0)),t.scaleX=1,t.scaleY=1,t._clearCache(),t.set("fontSize",i))}})}},431:()=>{var t;fabric.Textbox.prototype.initialize=(t=fabric.Textbox.prototype.initialize,function(...e){return t.call(this,...e),this._TextboxInit(),this}),fabric.Textbox.prototype._TextboxInit=function(){this.on({added:()=>{var e;this._calcWidth&&(this.set("width",1e3),e=this.calcTextWidth(),this.set("width",e),delete this._calcWidth)}})}},561:()=>{class e extends HTMLElement{constructor(){super()}connectedCallback(){}}customElements.define("fpd-actions-bar",e)}},n={};function de(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},i[e].call(t.exports,t,t.exports,de)),t.exports}(()=>{"use strict";const r=(e="",t=!1,i="",n=document.body)=>{n===document.body&&n.classList.add("fpd-overflow-hidden"),"prompt"===i?e=`
            <input type="text" placeholder="${e}" />
            <span class="fpd-btn"></span>
        `:"confirm"===i&&(e=`
            <div class="fpd-confirm-msg">${e}</div>
            <span class="fpd-btn fpd-confirm"></span>
        `);e=`
        <div class="fpd-modal-wrapper fpd-shadow-3">
            <div class="fpd-modal-close">
                <span class="fpd-icon-close"></span>
            </div>
            <div class="fpd-modal-content">${e}</div>
        </div>
    `;const s=document.createElement("div");return s.className="fpd-modal-internal fpd-modal-overlay "+(t?"fpd-fullscreen":""),s.innerHTML=e,s.dataset.type=i,n.append(s),p(s.querySelector(".fpd-modal-close"),["click"],e=>{s.remove()}),s},a=e=>"[object Object]"===Object.prototype.toString.call(e),n=(t,i)=>{if(t&&"object"==typeof t){let e=!0;for(var n=0;n<i.length;++n){var s=i[n];if(!t.hasOwnProperty(s)){e=!1;break}}return e}return!1},c=(e,t)=>{var i={...e,...t};if(Object.keys(t).length)for(const n of Object.keys(i))a(i[n])&&e[n]&&t[n]&&(i[n]=c(e[n],t[n]));return i},o=(e,t,i)=>{if(t)return void 0===(t=(Array.isArray(t)?t:t.match(/([^[.\]])+/g)).reduce((e,t)=>e&&e[t],e))?i:t},l=e=>/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e),d=e=>0===e||"string"==typeof e&&"0"===e,p=(e,t=[],i=()=>{},n=!1)=>{(t="string"==typeof t?[t]:t).forEach(t=>{!(e instanceof HTMLElement)&&Array.from(e).length?e.forEach(e=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n)})},h=(t=[],e=[])=>(t&&(t instanceof HTMLElement?e.forEach(e=>{t.classList.add(e)}):t.forEach(t=>{e.forEach(e=>{t.classList.add(e)})})),t),u=(t=[],e=[])=>(t&&(t instanceof HTMLElement?e.forEach(e=>{t.classList.remove(e)}):t.forEach(t=>{e.forEach(e=>{t.classList.remove(e)})})),t),f=(t=[],e=[],i=!0)=>(t&&(t instanceof HTMLElement?e.forEach(e=>{t.classList.toggle(e,i)}):t.forEach(t=>{e.forEach(e=>{t.classList.toggle(e,i)})})),t),m=e=>void 0===e||null==e||("string"==typeof e?!e.trim().length:Array.isArray(e)?!e.length:"object"==typeof e&&!Object.keys(e).length),g=()=>{var t=!0;try{window.localStorage.length,window.localStorage.setItem("fpd-storage","just-testing")}catch(e){t=!1}return t},s=(e={})=>{if(e.url){var t=document.createElement("div"),i=(t.className="fpd-item",t.dataset.source=e.url,e.title&&(t.dataset.title=e.title,t.setAttribute("aria-label",e.title),t.classList.add("fpd-hover-thumbnail")),document.createElement("picture")),i=(i.dataset.img=e.thumbnailUrl||e.url,t.append(i),document.createElement("span"));if(i.className="fpd-price",i.innerHTML=e.price,t.append(i),e.removable){const e=document.createElement("span");e.className="fpd-delete fpd-icon-remove",t.append(e)}return t}},v=(e,t,i=null)=>{if(!e.currentViewInstance)return"";var n=e.currentViewInstance.options;if(e.container.querySelector(".fpd-upload-zone-content").contains(t)&&e.currentViewInstance.currentUploadZone){const t=e.currentViewInstance.fabricCanvas.getUploadZone(e.currentViewInstance.currentUploadZone);t&&t.price&&(i=t.price)}return(i=null==i?o(n,"customImageParameters.price",0):i)?e.formatPrice(i):""},b=(t,e,i)=>{var n=t.currentViewInstance,s=n.options.customImageParameters;if(e>s.maxW||e<s.minW||i>s.maxH||i<s.minH){t.loadingCustomImage=!1,t.mainBar&&(t.mainBar.toggleContentDisplay(!1),n.currentUploadZone)&&t.mainBar.toggleUploadZonePanel(!1);let e=t.translator.getTranslation("misc","uploaded_image_size_alert");return e=e.replace("%minW",s.minW).replace("%minH",s.minH).replace("%maxW",s.maxW).replace("%maxH",s.maxH),r(e),!1}return!0};class y{static defaults={imageLoadTimestamp:!1,stageWidth:900,stageHeight:600,editorMode:!1,editorBoxParameters:["left","top","angle","fill","width","height","fontSize","price"],fonts:[{name:"Arial"},{name:"Lobster",url:"google"}],facebookAppId:"",instagramClientId:"",instagramRedirectUri:"",instagramTokenUri:"",zoomStep:.2,maxZoom:3,hexNames:{},selectedColor:"#f5f5f5",boundingBoxColor:"#2185d0",outOfBoundaryColor:"#990000",replaceInitialElements:!1,customImageAjaxSettings:{url:"php/custom-image-handler.php",data:{saveOnServer:0,uploadsDir:"./uploads",uploadsDirURL:"http://yourdomain.com/uploads"}},responsive:!0,cornerIconColor:"#000000",langJSON:"lang/default.json",colorPickerPalette:[],actions:{top:[],right:[],bottom:[],left:[]},mainBarModules:["products","images","text","designs","manage-layers"],initialActiveModule:"",maxValues:{},watermark:!1,priceFormat:{currency:"&#36;%d",decimalSep:".",thousandSep:","},mainBarContainer:!1,modalMode:!1,keyboardControl:!0,deselectActiveOnOutside:!0,uploadZonesTopped:!0,loadFirstProductInStage:!0,unsavedProductAlert:!1,hideDialogOnAdd:!0,toolbarPlacement:"smart",snapGridSize:[50,50],fabricCanvasOptions:{},namesNumbersDropdown:[],namesNumbersEntryPrice:0,colorSelectionPlacement:"",colorSelectionDisplayType:"grid",bulkVariationsPlacement:"",bulkVariations:{},toolbarDynamicContext:"body",boundingBoxProps:{strokeWidth:1},fitImagesInCanvas:!1,maxPrice:-1,inCanvasTextEditing:!0,openTextInputOnSelect:!1,designCategories:[],optionalView:!1,saveActionBrowserStorage:!0,pricingRules:[],uploadAgreementModal:!1,imageEditorSettings:{masks:[]},printingBox:null,printingBox:{},autoOpenInfo:!1,guidedTour:null,replaceColorsInColorGroup:!1,allowedImageTypes:["jpeg","png","svg","pdf"],pixabayApiKey:"",pixabayHighResImages:!1,pixabayLang:"en",openModalInDesigner:!1,imageSizeTooltip:!1,highlightEditableObjects:"",applyFillWhenReplacing:!0,layouts:[],dynamicViewsOptions:{unit:"mm",formats:[],pricePerArea:0,minWidth:0,minHeight:0,maxWidth:1e4,maxHeight:1e4},disableTextEmojis:!1,smartGuides:!1,usePrintingBoxAsBounding:!1,productsJSON:null,designsJSON:null,customizationRequiredRule:"any",swapProductConfirmation:!1,textLinkGroupProps:[],textTemplates:[],multiSelection:!1,multiSelectionColor:"#54dfe6",canvasHeight:"auto",maxCanvasHeight:.8,mobileGesturesBehaviour:"none",imageQualityRatings:null,splitMultiSVG:!1,cornerControlsStyle:"advanced",downloadFilename:"Product",autoFillUploadZones:!1,dragDropImagesToUploadZones:!1,responsiveBreakpoints:{small:768,medium:1024},dynamicDesigns:{},elementParameters:{objectCaching:!1,z:-1,price:0,colors:!1,removable:!1,draggable:!1,rotatable:!1,resizable:!1,copyable:!1,zChangeable:!1,boundingBox:!1,boundingBoxMode:"clipping",autoCenter:!1,replace:"",replaceInAllViews:!1,autoSelect:!1,topped:!1,colorPrices:{},colorLinkGroup:!1,patterns:[],sku:"",excludeFromExport:!1,showInColorSelection:!1,locked:!1,uniScalingUnlockable:!1,fixed:!1,originX:"center",originY:"center",cornerSize:24,fill:!1,lockUniScaling:!0,pattern:!1,top:0,left:0,angle:0,flipX:!1,flipY:!1,opacity:1,scaleX:1,scaleY:1},textParameters:{maxLength:0,curved:!1,curvable:!1,curveRadius:80,curveReverse:!1,maxLines:0,textBox:!1,textPlaceholder:!1,numberPlaceholder:!1,letterSpacing:0,chargeAfterEditing:!1,minFontSize:1,textTransform:"none",widthFontSize:0,maxFontSize:200,shadowColor:"",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textLinkGroup:"",strokeColors:[],editable:!0,fontFamily:"Arial",fontSize:18,lineHeight:1,fontWeight:"normal",fontStyle:"normal",textDecoration:"normal",padding:10,textAlign:"left",stroke:null,strokeWidth:0,charSpacing:0},imageParameters:{uploadZone:!1,filter:null,scaleMode:"fit",resizeToW:0,resizeToH:0,advancedEditing:!1,uploadZoneMovable:!1,uploadZoneRemovable:!1,padding:0,minScaleLimit:.01},customImageParameters:{minW:100,minH:100,maxW:1e4,maxH:1e4,minDPI:72,maxSize:10},customTextParameters:{},customAdds:{designs:!0,uploads:!0,texts:!0,drawing:!0},qrCodeProps:{autoCenter:!0,draggable:!0,removable:!0,resizable:!0}};static merge(e={},t={}){return c(e,t)}static getParameterKeys(){var e=Object.keys(this.defaults.elementParameters),t=Object.keys(this.defaults.imageParameters),i=Object.keys(this.defaults.textParameters);return(e=e.concat(t)).concat(i)}}window&&(window.FPDOptions=y),de(221),de(295),de(859);const x=(e,t,i,n,s="fit")=>{var a=1,o=0!==(i="number"!=typeof i?0:i),r=0!==(n="number"!=typeof n?0:n),a="cover"===s?i-e<n-t?o?Math.max(i/e,n/t):1:r?Math.max(i/e,n/t):1:t<e?o?Math.min(i/e,n/t):1:r?Math.min(i/e,n/t):1;return parseFloat(a.toFixed(10))};var t,i,C,w,E;fabric.IText.prototype.initialize=(t=fabric.IText.prototype.initialize,function(...e){return t.call(this,...e),this._ITextInit(),this}),fabric.IText.prototype._ITextInit=function(){this.on({added:()=>{this.setCurvedTextPath()},"editing:entered":()=>{this.canvas.viewOptions.inCanvasTextEditing||this.exitEditing(),this.curved&&this.exitEditing()},scaling:()=>{},changed:()=>{var e;if(0!=this.maxLines&&this.textLines.length>this.maxLines&&(e=this.textLines.slice(0,this.maxLines),this.set("text",e.join("\n")),this.exitEditing()),0!=this.maxLength&&this.text.length>this.maxLength&&(this.set("text",this.text.substr(0,this.maxLength)),this.exitEditing()),this.canvas.viewOptions.disableTextEmojis){let e=this.text.replace(FPDEmojisRegex,"");e=e.replace(String.fromCharCode(65039),""),this.set("text",e)}}})},fabric.IText.prototype.setCurvedTextPath=function(){var e;this.curved&&(e=new fabric.Path("M0,0m"+-(e=this.curveRadius)+",0a"+e+","+e+" 0 1,0 "+2*e+",0a"+e+","+e+" 0 1,0 "+2*-e+",0",{fill:"transparent",strokeWidth:2,stroke:"rgba(0,0,0, 0.5)",visible:!1}),this.set("path",e),this.setCurvedTextPosition())},fabric.IText.prototype.setCurvedTextPosition=function(){var e;this.curved&&this.path&&(this.pathSide=this.curveReverse?"left":"right",e=this.curveReverse?Math.PI*this.curveRadius*2*.25:Math.PI*this.curveRadius/2,this.pathStartOffset=e-this.calcTextWidth()/2,this.pathAlign="center")},de(431),fabric.Object.propertiesToInclude=["_isInitial","lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY","lockScalingFlip","lockUniScaling","resizeType","clipTo","clippingRect","boundingBox","boundingBoxMode","selectable","evented","title","editable","cornerColor","cornerIconColor","borderColor","isEditable","hasUploadZone","cornerSize"],fabric.Object.prototype.initialize=(E=fabric.Object.prototype.initialize,function(...e){return E.call(this,...e),this._elementInit(),this}),fabric.Object.prototype._elementInit=function(){this.on({added:()=>{!this.isCustom||this.hasUploadZone||this.replace||(this.copyable=this.originParams.copyable=!0)},moving:()=>{this._checkContainment()},rotating:()=>{this._checkContainment()},scaling:()=>{this._checkContainment()},selected:()=>{let e=!this.lockUniScaling;this.textBox&&(e=!0),"basic"==this.canvas.viewOptions.cornerControlsStyle&&(this.controls.mtr.offsetX=0,this.cornerSize=16),this.setControlsVisibility({ml:e,mr:e,mt:!this.lockUniScaling,mb:!this.lockUniScaling,tr:this.removable,tl:this.copyable,mtr:this.rotatable,br:this.resizable&&!this.curved})}})},fabric.Object.prototype.getType=function(e){return"text"===(e=e||this.type)||"i-text"===e||"curvedText"===e||"textbox"===e?"text":"image"},fabric.Object.prototype.isSVG=function(){return"group"===this.type||"path"===this.type||this.source&&this.source.includes(".svg")},fabric.Object.prototype.isColorizable=function(){return"text"===this.getType()?"text":!!this.source&&(1==this.source.split(".").length?this.source.includes("data:image/png;")?"dataurl":this.fill=this.colors=!1:this.source.replace(/\?.*$/,"").includes(".png")||this.isSVG()?this.isSVG()?"svg":"png":this.fill=this.colors=!1)},fabric.Object.prototype.hasColorSelection=function(){return(Array.isArray(this.colors)||Boolean(this.colors)||this.colorLinkGroup||this.__editorMode)&&!1!==this.isColorizable()},fabric.Object.prototype.checkEditable=function(e){return"object"==typeof(e=e||this).colors||!0===e.colors||1==e.colors||e.removable||e.draggable||e.resizable||e.rotatable||e.zChangeable||e.advancedEditing||e.editable||e.uploadZone||e.colorLinkGroup&&0<e.colorLinkGroup.length||e.__editorMode},fabric.Object.prototype.changeColor=function(e,i=!0){var t=this.isColorizable();if("string"==typeof e&&(e=tinycolor(e).toHexString()),"text"===this.getType())"object"==typeof e&&(e=e[0]),this.set("fill",e),this.canvas.renderAll(),this.pattern=null;else if("group"==this.type&&"object"==typeof e){const i=this.getObjects();e.forEach((e,t)=>{i[t]&&i[t].set("fill",e)}),this.canvas.renderAll(),this.svgFill=e,delete this.fill}else"string"!=typeof(e="object"==typeof e?e[0]:e)&&(e=!1),"png"==t||"dataurl"==t?(this.filters=[],e&&this.filters.push(new fabric.Image.filters.BlendColor({mode:"tint",color:e})),this.applyFilters(),this.canvas.renderAll(),this.canvas.fire("elementColorChange",{target:this,colorLinking:i}),this.fill=e):"svg"==t&&(this.set("fill",e),this.canvas.renderAll(),this.canvas.fire("elementColorChange",{target:this,colorLinking:i}))},fabric.Object.prototype.setPattern=function(e){(e=FancyProductDesigner.proxyFileServer?FancyProductDesigner.proxyFileServer+e:e)&&(fabric.util.loadImage(e,e=>{var t;if(this.isSVG())if(this.hasOwnProperty("getObjects"))for(var i=this.getObjects(),n=0;n<i.length;++n)i[n].set("fill",new fabric.Pattern({source:e,repeat:"repeat"}));else this.set("fill",new fabric.Pattern({source:e,repeat:"repeat"}));else"text"==this.getType()?this.set("fill",new fabric.Pattern({source:e,repeat:"repeat"})):(t=this.fill||this.colors[0],this.set("fill",t=t||"#000000"));this.canvas.renderAll()}),this.pattern=e)},fabric.Object.prototype.getZIndex=function(){return this.canvas.getObjects().indexOf(this)},fabric.Object.prototype.getBoundingBoxCoords=function(){if(this.boundingBox||this.uploadZone){if("object"==typeof this.boundingBox)return!!(this.boundingBox.hasOwnProperty("x")&&this.boundingBox.hasOwnProperty("y")&&this.boundingBox.width&&this.boundingBox.height)&&{left:this.boundingBox.x,top:this.boundingBox.y,width:this.boundingBox.width,height:this.boundingBox.height};for(var e=this.canvas.getObjects(),t=0;t<e.length;++t){var i,n=e[t];if(this.boundingBox==n.title)return{left:(i=n.getPointByOrigin("left","top")).x,top:i.y,width:n.width*n.scaleX,height:n.height*n.scaleY,angle:n.angle||0,cp:n.getCenterPoint()}}}return!1},fabric.Object.prototype.centerElement=function(e=!0,t=!0){let i=this.getBoundingBoxCoords(),n=this.left,s=this.top;e&&(n=i?i.cp?i.cp.x:i.left+.5*i.width:.5*this.canvas.viewOptions.stageWidth),t&&(s=i?i.cp?i.cp.y:i.top+.5*i.height:.5*this.canvas.viewOptions.stageHeight),this.setPositionByOrigin(new fabric.Point(n,s),"center","center"),this.canvas.renderAll(),this.setCoords(),this._checkContainment(),this.autoCenter=!1},fabric.Object.prototype._checkContainment=function(){var e,t,i,n,s;this.canvas.currentBoundingObject&&!this.hasUploadZone&&(this.setCoords(),"limitModify"===this.boundingBoxMode?(e=this.getBoundingRect(),s=(i=instance.currentBoundingObject.getBoundingRect()).left,n=i.left+i.width-e.width,t=i.top,i=i.top+i.height-e.height,this.isContainedWithinObject(instance.currentBoundingObject)?(limitModifyParameters={left:this.left,top:this.top,angle:this.angle,scaleX:this.scaleX,scaleY:this.scaleY},"text"==this.getType()&&(limitModifyParameters.fontSize=this.fontSize,limitModifyParameters.lineHeight=this.lineHeight,limitModifyParameters.charSpacing=this.charSpacing)):(0===this.__corner&&(e.left>s&&e.left<n&&(limitModifyParameters.left=this.left),e.top>t)&&e.top<i&&(limitModifyParameters.top=this.top),this.setOptions(limitModifyParameters))):"inside"!==this.boundingBoxMode&&"clipping"!==this.boundingBoxMode||(s=this.isOut,(n=!this.isContainedWithinObject(this.canvas.currentBoundingObject))?("inside"===this.boundingBoxMode&&(this.borderColor=this.canvas.viewOptions.outOfBoundaryColor),this.isOut=!0):("inside"===this.boundingBoxMode&&(this.borderColor=this.canvas.viewOptions.selectedColor),this.isOut=!1),s!=this.isOut&&null!=s&&(n?this.canvas.fire("elementOut",{target:this}):this.canvas.fire("elementIn",{target:this})),this.canvas.fire("elementCheckContainemt",{target:this,boundingBoxMode:this.boundingBoxMode}))),this.canvas.renderAll()},fabric.Object.prototype._clipElement=function(){var e=this.getBoundingBoxCoords()||this.clippingRect;e&&(this.clippingRect=e,e=new fabric.Rect({originX:"left",originY:"top",angle:e.angle||0,left:e.left,top:e.top,width:e.width,height:e.height,fill:"#DDD",absolutePositioned:!0}),this.clipPath=e)},fabric.Object.prototype.getElementJSON=function(e=!1,t=[]){this.canvas&&(t=Object.keys(this.canvas.viewOptions.elementParameters),t="text"===this.getType()?t.concat(Object.keys(this.canvas.viewOptions.textParameters)):t.concat(Object.keys(this.canvas.viewOptions.imageParameters))),e&&(t=t.concat(fabric.Object.propertiesToInclude)),this.uploadZone&&(t.push("customAdds"),t.push("designCategories"),t.push("designCategories[]")),"text"===this.getType()&&(t.push("text"),t.push("_initialText")),"group"===this.type&&t.push("svgFill"),t.push("width"),t.push("height"),t.push("isEditable"),t.push("hasUploadZone"),t.push("clippingRect"),t.push("evented"),t.push("isCustom"),t.push("currentColorPrice"),t.push("_isPriced"),t.push("originParams"),t.push("originSource"),t.push("_printingBox"),t=t.sort();let i={};return t.forEach(e=>{void 0!==this[e]&&(i[e]=this[e])}),i},fabric.Object.prototype.alignToPosition=function(e="left"){let t=this.getPointByOrigin("left","top"),i=this.getBoundingBoxCoords(),n="left",s="top";"left"===e?(t.x=i?i.left:0,t.x+=this.padding+1):"top"===e?(t.y=i?i.top:0,t.y+=this.padding+1):"right"===e?(t.x=i?i.left+i.width-this.padding:this.canvas.viewOptions.stageWidth-this.padding,n="right"):(t.y=i?i.top+i.height-this.padding:this.canvas.viewOptions.stageHeight,s="bottom"),this.setPositionByOrigin(t,n,s),this.setCoords(),this._checkContainment()},fabric.Object.prototype.toggleUploadZone=function(){if(this.hasUploadZone&&this.canvas){let e=this.canvas.getObjects(),t=!0;for(var i=0;i<e.lenth;++i)if(e[i].replace==this.replace){t=!1;break}var n=this.canvas.getUploadZone(this.replace);n&&(n.set("opacity",t?1:0),n.evented=t),this.canvas.renderAll()}},fabric.Canvas.prototype.initialize=(w=fabric.Canvas.prototype.initialize,function(...e){return w.call(this,...e),this._historyInit(),this}),fabric.Canvas.prototype.dispose=(C=fabric.Canvas.prototype.dispose,function(...e){return C.call(this,...e),this._historyDispose(),this}),fabric.Canvas.prototype._historyNext=function(){let e=y.getParameterKeys();e=e.concat(fabric.Object.propertiesToInclude);var t=this.toJSON(e);return t.objects.forEach(e=>{e.curved&&delete e.path}),JSON.stringify(t)},fabric.Canvas.prototype._historyEvents=function(){return{elementAdd:this._historySaveAction,elementRemove:this._historySaveAction,"object:modified":this._historySaveAction}},fabric.Canvas.prototype._historyInit=function(){this.historyUndo=[],this.historyRedo=[],this.historyNextState=this._historyNext(),this.on(this._historyEvents())},fabric.Canvas.prototype._historyDispose=function(){this.off(this._historyEvents())},fabric.Canvas.prototype._historySaveAction=function(){var e;this.historyProcessing||(e=this.historyNextState,this.historyUndo.push(e),this.historyNextState=this._historyNext(),this.fire("history:append",{json:e}))},fabric.Canvas.prototype.undo=function(e){this.historyProcessing=!0;var t=this.historyUndo.pop();t?(this.historyRedo.push(this._historyNext()),this.historyNextState=t,this._loadHistory(t,"history:undo",e)):this.historyProcessing=!1},fabric.Canvas.prototype.redo=function(e){this.historyProcessing=!0;var t=this.historyRedo.pop();t?(this.historyUndo.push(this._historyNext()),this.historyNextState=t,this._loadHistory(t,"history:redo",e)):this.historyProcessing=!1},fabric.Canvas.prototype._loadHistory=function(e,t,i){var n=this;this.loadFromJSON(e,function(){n.renderAll(),n.fire(t),n.historyProcessing=!1,i&&"function"==typeof i&&i()})},fabric.Canvas.prototype.clearHistory=function(){this.historyUndo=[],this.historyRedo=[],this.fire("history:clear")},fabric.Canvas.prototype.onHistory=function(){this.historyProcessing=!1,this._historySaveAction()},fabric.Canvas.prototype.offHistory=function(){this.historyProcessing=!0},fabric.Canvas.prototype.viewOptions={},fabric.Canvas.prototype.elements=[],fabric.Canvas.prototype.currentElement=null,fabric.Canvas.prototype.responsiveScale=1,fabric.Canvas.prototype.currentBoundingObject=null,fabric.Canvas.prototype.initialElementsLoaded=!1,fabric.Canvas.prototype.isCustomized=!1,fabric.Canvas.prototype.printingBoxObject=null,fabric.Canvas.prototype._canvasCreated=!1,fabric.Canvas.prototype.currentCurvedTextPath=!1,fabric.Canvas.prototype.initialize=(i=fabric.Canvas.prototype.initialize,function(...e){return i.call(this,...e),this._fpdCanvasInit(),this}),fabric.Canvas.prototype._fpdCanvasInit=function(){this.on({"after:render":()=>{this._canvasCreated||this._onCreated(),this.viewOptions&&3<this.viewOptions.highlightEditableObjects.length&&(this.contextContainer.strokeStyle=this.viewOptions.highlightEditableObjects,this.forEachObject(e=>{e!==this.getActiveObject()&&!e.isMoving&&("text"===e.getType()&&e.editable||e.uploadZone)?(e=e.getBoundingRect(),this.contextContainer.setLineDash([5,15]),this.contextContainer.strokeRect(e.left,e.top,e.width,e.height)):this.contextContainer.setLineDash([])}))},"object:added":({})=>{this._bringToppedElementsToFront()},"object:moving":({target:e})=>{this.fire("elementChange",{type:"moving",element:e})},"object:rotating":({target:e})=>{this.fire("elementChange",{type:"rotating",element:e})},"object:scaling":({target:e})=>{this.fire("elementChange",{type:"scaling",element:e})},"selection:created":({selected:e})=>{1==e.length?this._onSelected(e[0]):this._onMultiSelected(e)},"selection:updated":({selected:e})=>{1==e.length?this._onSelected(e[0]):this._onMultiSelected(e)},"selection:cleared":({})=>{this.currentCurvedTextPath&&(this.currentCurvedTextPath.visible=!1,this.currentCurvedTextPath=null)},"mouse:down":function(e){e.target&&e.target.__corner&&"function"==typeof e.target.exitEditing&&e.target.exitEditing(),null==e.target&&this.deselectElement()}})},fabric.Canvas.prototype._onCreated=function(){this._canvasCreated=!0,this._renderPrintingBox()},fabric.Canvas.prototype._onSelected=function(e){if(this.deselectElement(!1),this.dragStage)return this.deselectElement(),!1;this.currentElement=e,this.currentCurvedTextPath&&(this.currentCurvedTextPath.visible=!1),this.currentCurvedTextPath=e.path,this.currentCurvedTextPath&&(this.currentCurvedTextPath.visible=!0),this.fire("elementSelect",{element:e}),this.hoverCursor=e.draggable?"move":"pointer",e.boundingBox&&!e.uploadZone&&this._renderElementBoundingBox(e)},fabric.Canvas.prototype._onMultiSelected=function(e){const t=this.getActiveObject();this.viewOptions.multiSelection&&(t.set({lockScalingX:!0,lockScalingY:!0,lockRotation:!0,hasControls:!1,borderDashArray:[8,8],cornerStyle:"circle",cornerSize:16,transparentCorners:!1,borderColor:this.viewOptions.multiSelectionColor,borderScaleFactor:3}),e.forEach(e=>{e.draggable&&!e.locked||t.removeWithUpdate(e)}))},fabric.Canvas.prototype._renderElementBoundingBox=function(e){var t;this.currentBoundingObject&&(this.remove(this.currentBoundingObject),this.currentBoundingObject=null),e&&((t=e.getBoundingBoxCoords())&&"none"!=e.boundingBoxMode&&(t={left:t.left,top:t.top,width:t.width,height:t.height,angle:t.angle||0,stroke:this.viewOptions.boundingBoxColor,strokeWidth:1,strokeLineCap:"square",strokeDashArray:[10,10],fill:!1,selectable:!1,evented:!1,originX:"left",originY:"top",name:"bounding-box",excludeFromExport:!0,_ignore:!0},t=c(t,this.viewOptions.boundingBoxProps),this.currentBoundingObject=new fabric.Rect(t),this.add(this.currentBoundingObject),this.currentBoundingObject.bringToFront(),this.fire("boundingBoxToggle",{currentBoundingObject:this.currentBoundingObject,state:!0})),e._checkContainment())},fabric.Canvas.prototype._renderPrintingBox=function(){var e;this.printingBoxObject&&(this.remove(this.printingBoxObject),this.printingBoxObject=null),n(this.viewOptions.printingBox,["left","top","width","height"])&&(e=new fabric.Rect({left:100,top:100,width:this.viewOptions.printingBox.width,height:this.viewOptions.printingBox.height,stroke:this.viewOptions.printingBox.visibility||this.viewOptions.editorMode?"#db2828":"transparent",strokeWidth:1,strokeLineCap:"square",fill:!1,originX:"left",originY:"top",name:"printing-box",excludeFromExport:!0,_ignore:!0}),this.printingBoxObject=new fabric.Group([e],{left:this.viewOptions.printingBox.left,top:this.viewOptions.printingBox.top,evented:!1,resizable:!0,uniformScaling:!1,lockRotation:!0,borderColor:"transparent",transparentCorners:!0,cornerColor:this.viewOptions.selectedColor,cornerIconColor:this.viewOptions.cornerIconColor,cornerSize:24,originX:"left",originY:"top",name:"printing-boxes",excludeFromExport:!0,selectable:!1,_ignore:!0}),this.add(this.printingBoxObject),this.printingBoxObject.setCoords(),this.renderAll())},fabric.Canvas.prototype._bringToppedElementsToFront=function(){let e=this.getObjects(),t=[];e.forEach(e=>{(e.topped||e.uploadZone&&this.viewOptions.uploadZonesTopped)&&t.push(e)}),t.forEach(e=>{e.bringToFront()}),this.currentBoundingObject&&this.currentBoundingObject.bringToFront(),this.printingBoxObject&&this.printingBoxObject.bringToFront(),this.renderAll()},fabric.Canvas.prototype.addElements=function(i,e){let t=-1;const n=()=>{if(++t<i.length){const e=i[t];s(e)||this.addElement(e.type,e.source,e.title,e.parameters)}else this.off("elementAdd",n),void 0!==e&&e.call(e,this),this.initialElementsLoaded=!0},s=e=>{if(void 0===e.type||void 0===e.source||void 0===e.title){var t=i.indexOf(e);if(-1!==t)return console.log("Element index "+t+" from elements removed, its not a valid element object!","info"),n(),!0}else this.elements.push(e);return!1};i[0]?(this.on("elementAdd",n),n()):(void 0!==e&&e.call(e,instance),this.initialElementsLoaded=!0)},fabric.Canvas.prototype.addElement=function(a,i,e,o={}){if(void 0!==a&&void 0!==i&&void 0!==e){var t;this.fire("beforeElementAdd",{type:a,source:i,title:e,params:o}),"text"===a&&(i=(i=i.replace(/(<([^>]+)>)/gi,"")).replace(FancyProductDesigner.forbiddenTextChars,""),e=e.replace(/(<([^>]+)>)/gi,"")),"string"==typeof o.fill||Array.isArray(o.fill)||(o.fill=!1),t=a.toLowerCase().includes("text")?c(this.viewOptions.elementParameters,this.viewOptions.textParameters):c(this.viewOptions.elementParameters,this.viewOptions.imageParameters),!0!==(o=c(t,o)).colors&&1!=o.colors||(o.colors=o.fill||"#000"),o.colors&&"string"==typeof o.colors&&0==o.colors.indexOf("#")&&(t=o.colors.replace(/\s+/g,"").split(","),o.colors=t),o._isInitial=!this.initialElementsLoaded,a.toLowerCase().includes("text")&&(t=o.colors[0]||"#000000",o.fill=o.fill||t);let s={source:i,title:e,id:String((new Date).getTime())};if(this.viewOptions.editorMode?(o.__editorMode=this.viewOptions.editorMode,s.selectable=s.evented=!0):s=c(s,{selectable:!1,lockRotation:!0,hasRotatingPoint:!1,lockScalingX:!0,lockScalingY:!0,lockMovementX:!0,lockMovementY:!0,hasControls:!1,evented:!1,lockScalingFlip:!0}),(s=c(o,s)).isCustom&&(this.isCustomized=!0),this.viewOptions.usePrintingBoxAsBounding&&!s.boundingBox&&n(this.viewOptions.printingBox,["left","top","width","height"])&&(s.boundingBox={x:this.viewOptions.printingBox.left-1,y:this.viewOptions.printingBox.top-1,width:this.viewOptions.printingBox.width+1,height:this.viewOptions.printingBox.height+1},s._printingBox=s.boundingBox),"image"==a||"path"==a||"group"==a){-1===i.search("<svg ")&&(t=i.split("?"),i=s.source=t[0]);const a=(e,t,i,n={})=>{e?(t.originParams=c(t,n),e.setOptions(t),this.add(e),this.setElementOptions(t,e),e.originParams.angle=e.angle,e.originParams.z=e.getZIndex()):this.fire("imageFail",{url:t.source}),this.fire("elementAdd",{element:e})};if(void 0===i||0===i.length)console.log("No image source set for: "+e);else if(-1!==i.search("<svg"))fabric.loadSVGFromString(i,(e,t)=>{t=fabric.util.groupSVGElements(e,t);if(s.fill)s.svgFill||(s.svgFill=s.fill),delete s.fill;else if(!s.fill&&!s.svgFill){if(e){o.colors=[];for(var i=0;i<e.length;++i){var n=0<e[i].fill.length?tinycolor(e[i].fill).toHexString():"transparent";o.colors.push(n)}o.svgFill=o.colors}s.svgFill=o.svgFill}delete s.clippingRect,delete s.boundingBox,delete s.originParams,delete s.colors,delete s.svgFill,delete s.width,delete s.height,delete s.originX,delete s.originY,delete s.objectCaching,a(t,s,0,{svgFill:o.svgFill})});else if(i.split(".").includes("svg")){let e=Date.now().toString(),t=l(i)?new URL(FancyProductDesigner.proxyFileServer+i):i;!i.includes(".cloudfront.net/")&&!this.viewOptions.imageLoadTimestamp||FancyProductDesigner.proxyFileServer||t.searchParams.append("t",e),"object"==typeof t&&(t=t.toString()),fabric.loadSVGFromURL(t,(e,t)=>{t=e?fabric.util.groupSVGElements(e,t):null;if(s.fill)s.svgFill||(s.svgFill=s.fill),delete s.fill;else if(!s.fill&&!s.svgFill){if(e){o.colors=[];for(var i=0;i<e.length;++i){var n=0<e[i].fill.length?tinycolor(e[i].fill).toHexString():"transparent";o.colors.push(n)}o.svgFill=o.colors}s.svgFill=o.svgFill}a(t,s,0,{svgFill:o.svgFill})})}else{let e,t=Date.now().toString();i.includes("data:image/")?e=i:(e=l(i)?new URL(FancyProductDesigner.proxyFileServer+i):i,this.viewOptions.imageLoadTimestamp&&!FancyProductDesigner.proxyFileServer&&e.searchParams.append("t",t),"object"==typeof e&&(e=e.toString())),new fabric.Image.fromURL(e,function(e){e=""===e.getSrc()?null:e,a(e,s)},{crossOrigin:"anonymous"})}}else a.toLowerCase().includes("text")&&(i=i.replace(/\\n/g,"\n"),o.text=o.text||i,s._initialText=o.hasOwnProperty("_initialText")?o._initialText:o.text,s.originParams={...o},o.originParams&&o.originParams.text&&(s.originParams.text=s._initialText),t=o.curved?new fabric.IText(i.replace(/(?:\r\n|\r|\n)/g,""),s):new(o.textBox?fabric.Textbox:fabric.IText)(i,s),(s.textPlaceholder||s.numberPlaceholder)&&(s.textPlaceholder&&(this.textPlaceholder=t,s.removable=!1,s.editable=!1),s.numberPlaceholder)&&(this.numberPlaceholder=t,s.removable=!1,s.editable=!1),this.add(t),this.setElementOptions(s,t),t.originParams=c(t.toJSON(),t.originParams),delete t.originParams.clipTo,t.originParams.z=t.getZIndex(),this.fire("elementAdd",{element:t}))}},fabric.Canvas.prototype.deselectElement=function(e=!0){this.currentBoundingObject&&(this.remove(this.currentBoundingObject),this.fire("boudingBoxToggle",{boundingBox:this.currentBoundingObject,state:!1}),this.currentBoundingObject=null),e&&this.discardActiveObject(),this.currentElement=null,this.renderAll().calcOffset(),this.fire("elementSelect",{element:null})},fabric.Canvas.prototype.resetSize=function(){const e=this.wrapperEl.parentNode.clientWidth;let t=e<this.viewOptions.stageWidth?e/this.viewOptions.stageWidth:1,i=t,n=(this.responsiveScale=t,this.viewOptions.stageHeight);if("auto"!==this.viewOptions.canvasHeight&&this.viewOptions.canvasHeight.includes("px")&&(n=parseInt(this.viewOptions.canvasHeight),this.responsiveScale=t*(n/this.viewOptions.stageHeight),i=1),!isNaN(this.viewOptions.maxCanvasHeight)&&1!==this.viewOptions.maxCanvasHeight){const e=window.innerHeight*parseFloat(this.viewOptions.maxCanvasHeight);n*i>e&&(this.responsiveScale=t*(e/this.viewOptions.stageHeight),n=e)}return this.responsiveScale=parseFloat(Number(this.responsiveScale.toFixed(7))),this.responsiveScale=Math.min(this.responsiveScale,1),this.viewOptions.responsive||(this.responsiveScale=1),this.setDimensions({width:t*this.viewOptions.stageWidth,height:this.viewOptions.stageHeight*this.responsiveScale}).setZoom(this.responsiveScale).calcOffset().renderAll(),this.fire("sizeUpdate",{responsiveScale:this.responsiveScale,canvasHeight:n*i}),this.responsiveScale},fabric.Canvas.prototype.resetZoom=function(){this.deselectElement(),this.zoomToPoint(new fabric.Point(0,0),this.responsiveScale),this.absolutePan(new fabric.Point(0,0))},fabric.Canvas.prototype.getElementByTitle=function(e){for(var t=this.getObjects(),i=0;i<t.length;++i)if(t[i].title===e)return t[i]},fabric.Canvas.prototype.getElementByID=function(e){for(var t=this.getObjects(),i=0;i<t.length;++i)if(t[i].id==e)return t[i];return!1},fabric.Canvas.prototype.reset=function(e=!0){this.elements=[],this.clear(),e&&this.wrapperEl.remove(),this.fire("clear")},fabric.Canvas.prototype.removeElement=function(e){"string"==typeof e&&(e=this.getElementByTitle(e)),this.deselectElement(),e.toggleUploadZone&&e.toggleUploadZone(),this.remove(e),this.fire("elementRemove",{element:e})},fabric.Canvas.prototype.getElementByReplace=function(e){for(var t=this.getObjects(),i=0;i<t.length;++i){var n=t[i];if(n.replace===e)return n}return null},fabric.Canvas.prototype.setElementOptions=function(i,n){if(!(n=void 0===n?this.getActiveObject():n)||void 0===i)return!1;const e=(n="string"==typeof n?this.getElementByTitle(n):n).getType();if("image"==e&&!n._isInitial&&!n._addToUZ&&1===n.scaleX){let e=null;if(d(n.resizeToW)&&d(n.resizeToH)){if(n.boundingBox){const i=n.getBoundingBoxCoords();e=x(n.width,n.height,i.width,i.height,n.scaleMode)}else if(this.viewOptions.fitImagesInCanvas){const i=3*n.cornerSize;(n.width*n.scaleX+i>this.viewOptions.stageWidth||n.height*n.scaleY+i>this.viewOptions.stageHeight)&&(e=x(n.width,n.height,this.viewOptions.stageWidth-i,this.viewOptions.stageHeight-i))}}else{var t=n.resizeToW,s=n.resizeToH,t=isNaN(t)?parseFloat(t)/100*this.viewOptions.stageWidth:parseInt(t),s=isNaN(s)?parseFloat(s)/100*this.viewOptions.stageHeight:parseInt(s);e=x(n.width,n.height,t,s,n.scaleMode)}null!==e&&(i=c(i,{scaleX:e,scaleY:e}))}if(Boolean(n._addToUZ)){i.z=-1;let e=this.getElementByTitle(n._addToUZ),t=1;"image"==n.getType()&&(t=x(n.width,n.height,e.width*e.scaleX,e.height*e.scaleY,e.scaleMode)),(i=c(i,{boundingBox:n._addToUZ,boundingBoxMode:"clipping",scaleX:t,scaleY:t,autoCenter:!0,removable:!0,zChangeable:!1,autoSelect:!1,copyable:!1,hasUploadZone:!0,z:this.getElementByTitle(n._addToUZ).getZIndex(),rotatable:e.rotatable,draggable:e.draggable,resizable:e.resizable,price:e.price||i.price,replace:n._addToUZ,lockUniScaling:e.lockUniScaling,uniScalingUnlockable:e.uniScalingUnlockable,advancedEditing:e.advancedEditing,originX:e.originX,originY:e.originY,angle:e.angle})).originParams=c(i.originParams,{boundingBox:i.boundingBox,replace:i.replace,rotatable:i.rotatable,draggable:i.draggable,resizable:i.resizable,lockUniScaling:i.lockUniScaling,uniScalingUnlockable:i.uniScalingUnlockable,price:i.price,scaleX:i.scaleX,scaleY:i.scaleY,hasUploadZone:!0,autoCenter:!0,originX:i.originX,originY:i.originY,angle:i.angle}),delete i[""],delete n._addToUZ}if(i.topped&&(i.zChangeable=!1),n.checkEditable(i)&&(i.isEditable=i.evented=i.selectable=!0),(!i.uploadZone||this.viewOptions.editorMode)&&(i.draggable&&(i.lockMovementX=i.lockMovementY=!1),i.rotatable&&(i.lockRotation=!1,i.hasRotatingPoint=!0),i.resizable&&(i.lockScalingX=i.lockScalingY=!1),i.resizable||i.rotatable||i.removable)&&(i.hasControls=!0),i.uploadZone&&(this.viewOptions.editorMode||(i.uploadZoneMovable&&(i.lockMovementX=i.lockMovementY=!1),i.uploadZoneRemovable&&(i.removable=!0,i.copyable=!1,i.hasControls=!0)),i.borderColor="transparent",i.excludeFromExport=!0),i.fixed&&m(i.replace)&&(i.replace=n.title),i.replace&&""!=i.replace&&null!==(t=this.getElementByReplace(i.replace))&&t!==n&&(i.z=t.getZIndex(),i.left=n.originParams.left=t.left,i.top=n.originParams.top=t.top,i.autoCenter=!1,this.viewOptions.applyFillWhenReplacing&&(i.fill=t.fill),this.removeElement(t)),"string"==typeof i.text){let e=i.text;e=e.replace(FancyProductDesigner.forbiddenTextChars,""),this.initialElementsLoaded&&n.chargeAfterEditing&&(n._isPriced||(n._isPriced=!0),n._initialText===e)&&n._isPriced&&(n._isPriced=!1)}if("text"===e){if(i.hasOwnProperty("textDecoration")&&(i.underline="underline"===i.textDecoration),void 0!==i.letterSpacing&&(i.charSpacing=100*i.letterSpacing),i.fontSize&&i.fontSize<n.minFontSize?i.fontSize=n.minFontSize:i.fontSize&&i.fontSize>n.maxFontSize&&(i.fontSize=n.maxFontSize),i.text){let e=n.text;"uppercase"===n.textTransform?e=e.toUpperCase():"lowercase"===n.textTransform&&(e=e.toLowerCase()),n.set("text",e)}if(i.textTransform){let e=n.text;"uppercase"===i.textTransform?e=e.toUpperCase():"lowercase"===i.textTransform&&(e=e.toLowerCase()),n.set("text",e)}(i.shadowColor||i.shadowBlur||i.shadowOffsetX||i.shadowOffsetY)&&!n.shadow&&(s={color:i.shadowColor||"rgba(0,0,0,0)"},n.setShadow(s)),n.shadow&&i.hasOwnProperty("shadowColor")&&(i.shadowColor?n.shadow.color=i.shadowColor:n.setShadow(null)),n.shadow&&(i.shadowBlur&&(n.shadow.blur=i.shadowBlur),i.shadowOffsetX&&(n.shadow.offsetX=i.shadowOffsetX),i.shadowOffsetY)&&(n.shadow.offsetY=i.shadowOffsetY)}if(delete i.paths,n.setOptions(i),"i-text"==n.type&&n.widthFontSize&&0<n.text.length){let e;(e=n.width>n.widthFontSize?n.fontSize*(n.widthFontSize/(n.width+1)):n.fontSize*(n.widthFontSize/(n.width-1)))<n.minFontSize?e=n.minFontSize:e>n.maxFontSize&&(e=n.maxFontSize),e=parseInt(e),n.set("fontSize",e)}if((n.boundingBox&&"clipping"===i.boundingBoxMode||i.hasUploadZone)&&n._clipElement(),i.autoCenter&&n.centerElement(),void 0!==i.fill||void 0!==i.svgFill){const e=void 0!==i.svgFill?i.svgFill:i.fill;n.changeColor(e),n.pattern=void 0}void 0!==i.pattern&&n.setPattern(i.pattern),i.filter,n.canvas&&0<=i.z&&(n.moveTo(i.z),this._bringToppedElementsToFront()),n.curved&&(i.curveRadius&&n.setCurvedTextPath(),i.text)&&(n.set("text",n.text.replace(/(?:\r\n|\r|\n)/g,"")),n.setCurvedTextPosition()),n.uploadZone?n.evented=0!==n.opacity:n.isEditable&&!this.viewOptions.editorMode&&(n.evented=!i.locked);for(var a=this.getObjects(),o=0;o<a.length;++o){var r=a[o];r.uploadZone&&r.title==i.replace&&(r.opacity=0,r.evented=!1)}n.setCoords(),this.renderAll().calcOffset(),n._checkContainment(),i.autoSelect&&n.isEditable&&!this.editorMode&&this.wrapperEl.offsetParent&&setTimeout(()=>{this.setActiveObject(n)},200)},fabric.Canvas.prototype.duplicateElement=function(e){var t=e.getElementJSON();t.top=t.top+30,t.left=t.left+30,this.viewOptions.editorMode||(t.autoSelect=!0),this.addElement(e.getType(),e.source,"Copy "+e.title,t)},fabric.Canvas.prototype.getUploadZone=function(e){for(var t=this.getObjects(),i=0;i<t.length;++i)if(t[i].uploadZone&&t[i].title==e)return t[i]};class I extends EventTarget{static relevantOptions=["stageWidth","stageHeight","selectedColor","boundingBoxColor","outOfBoundaryColor","cornerIconColor","customAdds","elementParameters","imageParameters","textParameters","customImageParameters","customTextParameters","maxPrice","optionalView","designCategories","printingBox","output","layouts","usePrintingBoxAsBounding","threeJsPreviewModel","editorMode","imageLoadTimestamp","fitImagesInCanvas","inCanvasTextEditing","applyFillWhenReplacing","disableTextEmojis","cornerControlsStyle","responsive","canvasHeight","maxCanvasHeight","boundingBoxProps","highlightEditableObjects","multiSelection","multiSelectionColor"];totalPrice=0;truePrice=0;additionalPrice=0;viewData;onCreatedCallback;title;thumbnail;options;canvasElem=null;fabricCanvas=null;constructor(e,t={},i,n={}){super(),this.viewData=t,this.onCreatedCallback=i,this.title=t.title,this.thumbnail=t.thumbnail,this.options=t.options;i=this.options.selectedColor;fabric.Object.prototype.borderColor=i,fabric.Object.prototype.cornerColor=i,fabric.Object.prototype.cornerIconColor=this.options.cornerIconColor,n=c({containerClass:"fpd-view-stage fpd-hidden",selection:this.options.multiSelection,selectionBorderColor:this.options.multiSelectionColor,selectionColor:tinycolor(this.options.multiSelectionColor).setAlpha(.1).toRgbString(),hoverCursor:"pointer",controlsAboveOverlay:!0,centeredScaling:!0,allowTouchScrolling:!0,preserveObjectStacking:!0},n),this.fabricOptions=n,this.canvasElem=document.createElement("canvas"),e.append(this.canvasElem),this.fabricCanvas=new fabric.Canvas(this.canvasElem,n),this.fabricCanvas.viewOptions=this.options,this.fabricCanvas.setDimensions({width:this.options.stageWidth,height:this.options.stageHeight}),this.fabricCanvas.on({imageFail:({url:e})=>{r(`
                    <p>The image with the URL<br /><i style='font-size: 10px;'>${e}</i><br />can not be loaded into the canvas.</p>
                    <p><b>Troubleshooting</b>
                        <ul>
                            <li>The URL is not correct!</li>
                            <li>The image has been blocked by <a href='https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS' target='_blank'>CORS policy</a>. You need to host the image under the same protocol and domain or enable 'Access-Control-Allow-Origin' on the server where you host the image. <a href='http://enable-cors.org/' target='_blank'>Read more about it here.</a><
                            /li>
                        </ul>
                    </p>
                `)}})}init(){this.loadElements(this.viewData.elements,this.#e.bind(this))}loadElements(e,t){this.fabricCanvas.initialElementsLoaded&&this.fabricCanvas.reset(!1),this.fabricCanvas.offHistory(),this.fabricCanvas.addElements(e,t)}#e(){this.onCreatedCallback(this);let n=null;this.fabricCanvas.on({"mouse:up":e=>{},"object:moving":e=>{n="moving",e.target.lockMovementX&&e.target.lockMovementY||this.options.smartGuides},"object:modified":e=>{var t=e.target;if(null!==n){var i={};switch(n){case"moving":i.left=Number(t.left),i.top=Number(t.top);break;case"scaling":"text"!==t.getType()||"curvedText"===t.type||t.uniScalingUnlockable?(i.scaleX=parseFloat(t.scaleX),i.scaleY=parseFloat(t.scaleY)):i.fontSize=parseInt(t.fontSize);break;case"rotating":i.angle=t.angle}this.dispatchEvent(new CustomEvent("elementModify",{detail:{element:t,properties:i}}))}n=null}}),this.dispatchEvent(new CustomEvent("priceChange",{detail:{elementPrice:0,truePrice:this.truePrice}}))}}window.FancyProductDesigner=I;const S=t=>{let e=t.url;t.params&&(e+="?"+new URLSearchParams(t.params).toString());const i=new XMLHttpRequest;return i.responseType="json",i.open("GET",e),i.onreadystatechange=e=>{4==i.readyState&&200==i.status?t.onSuccess&&t.onSuccess(i.response):200!==i.status&&t.onError&&t.onError(i)},i.send(),i};class D extends EventTarget{langJSON=null;constructor(){super()}loadLangJSON(t=null,i=()=>{}){!1!==t?"object"==typeof t?(this.langJSON=t,i.call(this)):S({url:t,onSuccess:e=>{this.langJSON=e,i.call(this)},onError:e=>{alert('Language JSON "'+t+'" could not be loaded or is not valid. Make sure you set the correct URL in the options and the JSON is valid!'),i.call(this)}}):i.call(this)}translateElement(e){let t="";var i,n;return this.langJSON&&(i=(e.getAttribute("placeholder")?e.getAttribute("placeholder"):e.getAttribute("title")?e.getAttribute("title"):e.dataset.title||e.innerText).split("."),n=this.langJSON[i[0]])&&void 0!==(t=n[i[1]])||(t=e.dataset.defaulttext),e.getAttribute("placeholder")?(e.setAttribute("placeholder",t),e.innerText=""):e.getAttribute("title")?e.setAttribute("title",t):e.dataset.title?e.dataset.title=t:e.innerText=t,t}getTranslation(e,t,i=""){return this.langJSON&&(e=this.langJSON[e])&&e[t]?e[t]:i}}class e extends HTMLElement{placeholder="";value="";searchable=!1;constructor(){super(),this.innerHTML='<input type="text" class="fpd-dropdown-current"/> <div class="fpd-dropdown-arrow"><span class="fpd-icon-arrow-dropdown"></span></div> <div class="fpd-dropdown-list"> <div class="fpd-scroll-area"></div> </div> '}connectedCallback(){this.addEventListener("click",()=>{this.classList.toggle("fpd-active")}),this.querySelector(".fpd-dropdown-arrow").addEventListener("click",e=>{e.stopPropagation(),this.classList.toggle("fpd-active")}),this.querySelector("input.fpd-dropdown-current").addEventListener("keyup",e=>{if(this.searchable){const t=e.currentTarget.value;this.querySelectorAll(".fpd-dropdown-list .fpd-item").forEach(e=>{0==t.length?e.classList.remove("fpd-hidden"):e.classList.toggle("fpd-hidden",!e.innerText.toLowerCase().includes(t.toLowerCase()))})}})}static get observedAttributes(){return["searchable","placeholder","value"]}attributeChangedCallback(e,t,i){t!==i&&("placeholder"===e?this.querySelector("input.fpd-dropdown-current").setAttribute("placeholder",i):"value"===e?this.querySelector("input.fpd-dropdown-current").value=i:"searchable"===e&&(this.searchable=this.hasAttribute("searchable")))}}customElements.define("fpd-dropdown",e);class O extends HTMLElement{constructor(){super()}connectedCallback(){var e=document.createElement("template");e.innerHTML='<div class="fpd-navigation fpd-scrollbar-hidden"></div> <div class="fpd-module-content"></div> <div class="fpd-secondary-content"> <div class="fpd-upload-zone-panel"> <div class="fpd-upload-zone-content"></div> <div class="fpd-bottom-nav fpd-module-tabs"> <div class="fpd-add-image" data-module="images"> <span class="fpd-icon-photo"></span> </div> <div class="fpd-add-text" data-module="text"> <span class="fpd-icon-text-secondary"></span> </div> <div class="fpd-add-design" data-module="designs"> <span class="fpd-icon-design-library"></span> </div> </div> </div> </div> <div class="fpd-close-off-canvas"> <span class="fpd-icon-close"></span> </div> <div class="fpd-draggable-dialog fpd-container fpd-shadow-2"> <div class="fpd-dialog-head"> <div class="fpd-dialog-drag-handle"> <div> <span class="fpd-icon-drag"></span><span class="fpd-dialog-title"></span> </div> </div> <div class="fpd-close-dialog"> <span class="fpd-icon-close"></span> </div> </div> </div> ',this.append(e.content.cloneNode(!0))}}customElements.define("fpd-main-bar",O);class T extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-grid" data-defaulttext="Swap Product" data-title="modules.products"> <fpd-dropdown class="fpd-product-categories" searchable></fpd-dropdown> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain fpd-padding"> </div> </div> </div>'}}customElements.define("fpd-module-products",T);class k extends EventTarget{currentCategoryIndex=0;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-products"),t.append(this.container),e.addEventListener("productsSet",e=>{const n=this.container.querySelector(".fpd-dropdown-list > .fpd-scroll-area");n.innerHTML="",this.fpdInstance.products&&0<this.fpdInstance.products.length&&(void 0!==this.fpdInstance.products[0].category&&1<this.fpdInstance.products.length&&(this.container.classList.add("fpd-categories-enabled"),this.fpdInstance.products.forEach((e,t)=>{var i=document.createElement("span");i.className="fpd-item",i.dataset.index=t,i.innerText=e.category,i.addEventListener("click",e=>{this.selectCategory(e.currentTarget.dataset.index)}),n.append(i)})),this.#t(),this.selectCategory(0))}),e.addEventListener("productAdd",(e,t,i,n)=>{n==this.currentCategoryIndex&&this.#i(t)})}#t(){if(!this.fpdInstance.mainOptions.editorMode){let e=this.fpdInstance.products[0],t=void 0===e;void 0!==e&&(t=!!(!e.hasOwnProperty("category")&&this.fpdInstance.products.length<2||e.hasOwnProperty("category")&&e.products.length<2&&this.fpdInstance.products.length<2)),this.fpdInstance.container.classList.toggle("fpd-products-module-hidden",t)}}#i(e,i){var t=e[0].productThumbnail||e[0].thumbnail,e=e[0].productTitle||e[0].title,n=document.createElement("div"),e=(n.className="fpd-item fpd-hover-thumbnail",n.dataset.title=e,n.dataset.source=t,n.dataset.index=i,n.addEventListener("click",e=>{if(e.preventDefault(),this.fpdInstance.mainOptions.swapProductConfirmation){var t=r(this.fpdInstance.translator.getTranslation("modules","products_confirm_replacement"),!1,"confirm",this.fpdInstance.container);const e=t.querySelector(".fpd-confirm");e.innerText=this.fpdInstance.translator.getTranslation("modules","products_confirm_button"),p(e,["click"],()=>{this.fpdInstance.selectProduct(i,this.currentCategoryIndex),t.remove()})}else this.fpdInstance.selectProduct(Number(e.currentTarget.dataset.index),this.currentCategoryIndex)}),this.container.querySelector(".fpd-grid").append(n),document.createElement("picture"));e.dataset.img=t,n.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e)}selectCategory(t=0){if(this.currentCategoryIndex=t,this.container.querySelector(".fpd-grid").innerHTML="",this.fpdInstance.products&&0<this.fpdInstance.products.length){let e;void 0!==this.fpdInstance.products[0].category?(e=this.fpdInstance.products[t].products,this.container.querySelector(".fpd-dropdown-current").value=this.fpdInstance.products[t].category):e=this.fpdInstance.products.products,e.forEach((e,t)=>{this.#i(e,t)})}}}class j extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-text-secondary" data-defaulttext="Add Text" data-title="modules.text"> <div class="fpd-add-text"> <textarea data-defaulttext="Enter some text" placeholder="modules.text_input_placeholder"></textarea> <div class="fpd-btn"> <span data-defaulttext="Add Text">modules.text_add_btn</span> <span class="fpd-price"></span> </div> </div> <div class="fpd-text-templates fpd-scroll-area"> <div class="fpd-grid"></div> </div> </div>'}}customElements.define("fpd-module-text",j);class M extends EventTarget{constructor(a,e){var s;super(),this.fpdInstance=a,this.container=document.createElement("fpd-module-text"),e.append(this.container),this.container.querySelector(".fpd-btn").addEventListener("click",e=>{var t=this.container.querySelector("textarea"),i=t.value;if(a.currentViewInstance&&0<i.length){const e=a.currentViewInstance.options;var n=c(e.customTextParameters,{textBox:!0,resizable:!0,isCustom:!0,_addToUZ:a.currentViewInstance.currentUploadZone,_calcWidth:!0});a.currentViewInstance.fabricCanvas.addElement("text",i,i,n)}t.value=""}),p(this.container.querySelector("textarea"),["input","change"],e=>{var t=a.currentViewInstance.options;let i=e.currentTarget.value,n=t.customTextParameters.maxLength,s=t.customTextParameters.maxLines;i=i.replace(FancyProductDesigner.forbiddenTextChars,""),a.mainOptions.disableTextEmojis&&(i=(i=i.replace(FPDEmojisRegex,"")).replace(String.fromCharCode(65039),"")),0!=n&&i.length>n&&(i=i.substr(0,n)),0!=s&&i.split("\n").length>s&&(i=i.replace(/([\s\S]*)\n/,"$1")),e.currentTarget.value=i}),p(a,["viewSelect","secondaryModuleCalled"],t=>{if(a.currentViewInstance){var i=a.currentViewInstance.options;let e=null;if(a.currentViewInstance.currentUploadZone&&this.container.parentNode.classList.contains("fpd-upload-zone-content")){const t=a.currentViewInstance.fabricCanvas.getUploadZone(a.currentViewInstance.currentUploadZone);o(t,"price")&&(e=t.price)}i=o(i,"customTextParameters.price",0),i=(null==e&&i&&(e=i),this.container.querySelector(".fpd-btn > .fpd-price"));i&&(i.innerHTML=e?" - "+a.formatPrice(e):"")}}),Array.isArray(a.mainOptions.textTemplates)&&(s=this.container.querySelector(".fpd-text-templates .fpd-grid"),a.mainOptions.textTemplates.forEach(i=>{var e=i.properties,t="font-family:"+(e.fontFamily||"Arial"),e=(t+="; text-align:"+(e.textAlign||"left"),document.createElement("div")),n=(e.className="fpd-item",e.addEventListener("click",e=>{if(a.currentViewInstance){const e=a.currentViewInstance.options;var t={...i.properties},t=(t.isCustom=!0,t.textBox=!0,t.resizable=!0,t._addToUZ=a.currentViewInstance.currentUploadZone,t._calcWidth=!0,c(e.customTextParameters,t));a.currentViewInstance.fabricCanvas.addElement("text",i.text,i.text,t)}}),document.createElement("div"));n.setAttribute("style",t),n.innerHTML=i.text.replace(/(?:\r\n|\r|\n)/g,"<br>"),e.append(n),s.append(e)}))}}class H extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-design-library" data-defaulttext="Add Designs" data-title="modules.designs"> <div class="fpd-head"> <div class="fpd-input-back-search"> <div class="fpd-back fpd-btn"> <span class="fpd-icon-back"></span> </div> <div class="fpd-input-search"> <input type="text"/> <span class="fpd-icon-magnify"></span> </div> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain"></div> </div> </div>'}}customElements.define("fpd-module-designs",H);class N extends EventTarget{#n="";#s=!1;#a=[];#o=null;#r=null;constructor(i,e,t=null){super(),this.#n=i.translator.getTranslation("modules","designs_search_in").toUpperCase(),this.fpdInstance=i,this.#r=t,this.container=document.createElement("fpd-module-designs"),e.append(this.container),t&&(this.container.dataset.dynamicDesignsId=t),this.headElem=this.container.querySelector(".fpd-head"),this.gridElem=this.container.querySelector(".fpd-grid"),this.headElem.querySelector(".fpd-input-search input").addEventListener("keyup",e=>{var t=e.currentTarget,i=this.gridElem.querySelectorAll(".fpd-item");if(""==t.value)for(var n of i)n.classList.remove("fpd-hidden");else{const e=t.value.toLowerCase().trim();for(var s of i)s.classList.add("fpd-hidden"),s.dataset.search.includes(e)&&s.classList.remove("fpd-hidden")}}),p(this.headElem.querySelector(".fpd-back"),"click",e=>{0<this.gridElem.querySelectorAll(".fpd-category").length&&this.#a.pop();let t,i=this.fpdInstance.designs;this.#a.forEach(e=>{t=i[e],i=t.category}),(this.#o=i)&&this.#l(this.#o,t),void 0===t&&this.toggleCategories()}),p(i,"designsSet",e=>{var t=i.designs;Array.isArray(t)&&0!==t.length&&(t[0].hasOwnProperty("source")?(this.container.classList.add("fpd-single-cat"),this.#c(t)):1<t.length||t[0].category?(this.#s=!0,this.toggleCategories()):1===t.length&&t[0].designs&&(this.container.classList.add("fpd-single-cat"),this.#c(t[0].designs)))}),p(i,"viewSelect",()=>{this.toggleCategories()})}#l(e,t){this.gridElem.innerHTML="",this.gridElem.classList.remove("fpd-padding"),this.headElem.querySelector(".fpd-input-search input").value="",this.container.classList.remove("fpd-designs-active"),this.container.classList.add("fpd-categories-active"),e.forEach((e,t)=>{this.#d(e)}),t&&(this.headElem.querySelector(".fpd-input-search input").setAttribute("placeholder",this.#n+" "+t.title.toUpperCase()),this.container.classList.add("fpd-head-visible"))}#d(e){var t,i=document.createElement("div");i.className="fpd-category fpd-item",i.dataset.title=e.title,i.dataset.search=e.title.toLowerCase(),e.thumbnail?((t=document.createElement("picture")).dataset.img=e.thumbnail,i.append(t),this.fpdInstance.lazyBackgroundObserver.observe(t),(t=document.createElement("span")).innerText=e.title,i.append(t)):i.innerHTML="<span>"+e.title+"</span>",i.addEventListener("click",e=>{var e=e.currentTarget,t=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(e),i=this.#o[t];i.category?(this.#a.push(t),this.#o=i.category,this.#l(this.#o,i)):this.#c(i.designs,i.parameters),this.headElem.querySelector(".fpd-input-search input").setAttribute("placeholder",this.#n+" "+e.dataset.search.toUpperCase())}),this.gridElem.append(i)}#c(e,t={}){this.gridElem.innerHTML="",this.gridElem.classList.add("fpd-padding"),this.headElem.querySelector(".fpd-input-search input").value="",this.container.classList.remove("fpd-categories-active"),this.container.classList.add("fpd-designs-active","fpd-head-visible"),e.forEach(e=>{e.parameters=c(t,e.parameters),this.#p(e)})}#p(e){e.thumbnail=void 0===e.thumbnail?e.source:e.thumbnail;var t=s({url:e.source,thumbnailUrl:e.thumbnail,title:e.title,price:v(this.fpdInstance,this.container,e.parameters.price)});t.dataset.search=e.title.toLowerCase(),t.parameters=e.parameters,t.addEventListener("click",e=>{e=e.currentTarget;this.fpdInstance.addCanvasDesign(e.dataset.source,e.dataset.title,e.parameters)}),this.gridElem.append(t),this.fpdInstance.lazyBackgroundObserver.observe(t.querySelector("picture"))}toggleCategories(){if(this.#s){this.#a=[],this.container.classList.remove("fpd-head-visible","fpd-single-cat"),this.#o=this.fpdInstance.designs,this.#l(this.#o);let e=[];if(this.#r&&(e=this.fpdInstance.mainOptions.dynamicDesigns[this.#r].categories),this.fpdInstance.currentViewInstance){const t=this.fpdInstance.currentElement;e=(t&&t.uploadZone&&t.designCategories?this.fpdInstance.currentElement:this.fpdInstance.currentViewInstance.options).designCategories}var t=this.container.querySelectorAll(".fpd-category");if(0<e.length){var i,n=[];for(i of t)e.includes(i.dataset.title)?(i.classList.remove("fpd-hidden"),n.push(i)):i.classList.add("fpd-hidden");1===n.length&&(this.container.classList.add("fpd-single-cat"),n[0].click())}else for(var s of t)s.classList.remove("fpd-hidden")}}}class q extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-design-library" data-defaulttext="Text to Image" data-title="modules.text_to_image"> <div class="fpd-head"> <textarea></textarea> <div class="fpd-btn"> <span data-defaulttext="Generate">modules.text_to_image_generate</span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover"></div> </div> </div>'}}customElements.define("fpd-module-text-to-image",q);class U extends EventTarget{#u="https://radykal.dep/fpd-js/server/php/sd-api.php";#h=!1;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-text-to-image"),t.append(this.container),this.inputElem=this.container.querySelector(".fpd-head textarea"),this.gridElem=this.container.querySelector(".fpd-grid"),this.container.querySelector(".fpd-head .fpd-btn").addEventListener("click",e=>{const t=e.currentTarget;m(this.inputElem.value)||this.#h||(this.#h=!0,t.classList.add("fpd-loading"),e={action:"text2img",prompt:this.inputElem.value,numOfImg:2},fetch(this.#u,{method:"POST",redirect:"follow",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{(e=JSON.parse(e))&&e.output&&this.#g(e.output),this.#h=!1,t.classList.remove("fpd-loading")}).catch(e=>{this.#h=!1,t.classList.remove("fpd-loading")}))})}#g(e=[]){e.forEach(e=>{var t=document.createElement("div");t.className="fpd-item",t.dataset.source=e,t.innerHTML='<picture data-img="'+e+'"></picture><span class="fpd-price"></span>',this.gridElem.append(t),t.addEventListener("click",e=>{e=e.currentTarget;this.fpdInstance._addCanvasDesign(e.dataset.source,e.dataset.title,e.dataset.parameters)}),this.fpdInstance.lazyBackgroundObserver.observe(t.querySelector("picture"))})}}class z extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-photo" data-defaulttext="Add Image" data-title="modules.images"> <div class="fpd-module-tabs"> <div data-context="upload" class="fpd-active"> <span class="fpd-icon-cloud-upload"></span> </div> <div data-context="facebook" class="fpd-hidden" title="Facebook"> <span class="fpd-icon-facebook"></span> </div> <div data-context="instagram" class="fpd-hidden" title="Instagram"> <span class="fpd-icon-instagram"></span> </div> <div data-context="pixabay" class="fpd-hidden" title="Pixabay"> <span class="fpd-icon-pixabay"></span> </div> <div data-context="qr-code" title="QR-Code"> <span class="fpd-icon-qrcode"></span> </div> </div> <div class="fpd-module-tabs-content"> <div data-context="upload" class="fpd-active"></div> <div data-context="facebook"></div> <div data-context="instagram"></div> <div data-context="pixabay"></div> <div data-context="qr-code"></div> </div> </div>'}}customElements.define("fpd-module-images",z);class R extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-upload-image"> <div> <span class="fpd-icon-file-upload"></span> <span data-defaulttext="Click or drop images here">modules.upload_zone</span> <span class="fpd-price"></span> </div> </div> <input type="file" multiple="multiple" class="fpd-upload-input fpd-hidden" name="files[]" accept="image/jpeg,image/jpg,image/png,image/svg+xml,application/pdf"/> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-uploads",R);const L=(e="",t=!0)=>{let i=document.body.querySelector(".fpd-snackbar-wrapper");i||((i=document.createElement("div")).className="fpd-snackbar-wrapper",document.body.append(i));const n=document.createElement("div");return n.className="fpd-snackbar fpd-shadow-1",n.innerHTML="<p>"+e+"</p>",n.addEventListener("click",e=>{n.remove()}),i.append(n),t&&setTimeout(function(){n.remove()},5e3),n};class V extends EventTarget{#f;#m=0;#v=!1;#b=[];#y=0;constructor(t,e){super(),this.fpdInstance=t,this.container=document.createElement("fpd-module-uploads"),e.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid");e=this.container.querySelector(".fpd-upload-image");this.#f=t.mainOptions.allowedImageTypes,this.#f.includes("jpeg")&&!this.#f.includes("jpg")&&this.#f.push("jpg");const i=this.container.querySelector(".fpd-upload-input");let n=[];if(this.#f.forEach(e=>{"pdf"==e?n.push("application/pdf"):("svg"==e&&(e+="+xml"),n.push("image/"+e))}),i.setAttribute("accept",n.join()),p(e,"click",async e=>{e.preventDefault(),i.click()}),p(i,"change",e=>{this.#C(e.currentTarget.files)}),p(e,["dragover","dragleave"],e=>{e.stopPropagation(),e.preventDefault(),e.currentTarget.classList.toggle("fpd-hover","dragover"===e.type)}),p(e,"drop",e=>{e.stopPropagation(),e.preventDefault();e=e.target.files||e.dataTransfer.files;this.#C(e)}),p(t,"productCreate",e=>{this.#v=!1}),g,window.localStorage.getItem("fpd_uploaded_images")){const t=JSON.parse(window.localStorage.getItem("fpd_uploaded_images"));t.forEach(e=>{this.#x(e.url,e.title);var n=new Image;n.src=e.url,n.onerror=function(){var i=null;t.forEach(function(e,t){e.url==n.src&&(i=t)}),null!=i&&(t.splice(i,1),window.localStorage.setItem("fpd_uploaded_images",JSON.stringify(t)))}})}}#C(e){var t,i;this.fpdInstance.mainOptions.uploadAgreementModal?((i=(t=r(this.fpdInstance.translator.getTranslation("modules","images_agreement"),!1,"confirm",this.fpdInstance.container)).querySelector(".fpd-confirm")).innerText=this.fpdInstance.translator.getTranslation("modules","images_confirm_button"),p(i,["click"],()=>{this.#E(e),t.remove()})):this.#E(e)}#E(e){this.#m=0,this.#y=e.length,this.fpdInstance.loadingCustomImage=!0,Array.from(e).forEach((e,t)=>{this.#f.includes(e.name.split(".").pop().toLowerCase().split("?")[0])&&this.#w(e,0==t)}),this.container.querySelector(".fpd-upload-image").classList.remove("fpd-hover")}#w(e,t){var i=1024*this.fpdInstance.mainOptions.customImageParameters.maxSize*1024;e.size>i?(L(this.fpdInstance.translator.getTranslation("misc","maximum_size_info").replace("%filename",e.name).replace("%mb",this.fpdInstance.mainOptions.customImageParameters.maxSize)),this.fpdInstance.loadingCustomImage=!1):"application/pdf"===e.type?this.#I(e,t):this.#D(e,t)}#D(s,a=!1){const o=this.fpdInstance.mainOptions,e=new FileReader;e.onload=t=>{t=t.currentTarget.result;if("image/jpeg"===s.type&&o.customImageParameters.minDPI){const a=new JpegMeta.JpegFile(atob(t.replace(/^.*?,/,"")),s.name);let e=null;if(a.tiff&&a.tiff.XResolution&&a.tiff.XResolution.value?(i=a.tiff.XResolution.value.den,e=a.tiff.XResolution.value.num/i):a.jfif&&a.jfif.Xdensity&&a.jfif.Xdensity.value&&(e=a.jfif.Xdensity.value),null!==e){if(console.log(s.name+" Real Resolution: "+e),e<o.customImageParameters.minDPI){let e=this.fpdInstance.translator.getTranslation("misc","minimum_dpi_info");return e=e.replace("%dpi",o.customImageParameters.minDPI),r(e,!1,"",this.fpdInstance.container),this.fpdInstance.loadingCustomImage=!1}}else console.log(s.name+": Resolution is not accessible.")}const n=this.#x(t,s.name);this.fpdInstance.uploadsToServer&&(n.classList.add("fpd-loading"),n.insertAdjacentHTML("beforeend",'<div class="fpd-loading-bar"><div class="fpd-loading-progress"></div></div>'));var i=new Image;i.onload=t=>{var t=t.currentTarget,e=t.height,i=t.width;if(this.fpdInstance.currentViewInstance.options.customImageParameters,b(this.fpdInstance,i,e))if(this.fpdInstance.uploadsToServer){i=new FormData;i.append("uploadsDir",this.fpdInstance.uploadsDir),i.append("uploadsDirURL",this.fpdInstance.uploadsDirURL),i.append("images[]",s);const t=new XMLHttpRequest;t.responseType="json",t.onreadystatechange=e=>{if(t.readyState===XMLHttpRequest.DONE){const e=t.status;if(0===e||200<=e&&e<400){const e=t.response;e.image_src&&(this.#S(e.image_src,e.filename),n.dataset.source=e.image_src,n.classList.remove("fpd-loading"),n.querySelector(".fpd-loading-bar").remove(),this.#O(n,a),this.#m++,n.xhr=null),this.fpdInstance.loadingCustomImage=!1}}},t.upload.onprogress=e=>{var t=e.total,e=e.loaded,e=parseInt(100*e/t);n.querySelector(".fpd-loading-progress").style.width=e+"%"},t.upload.onerror=e=>{this.fpdInstance.loadingCustomImage=!1,n.remove(),L("Upload failed. Please try again or check your web console!")},t.open("POST",this.fpdInstance.uploadsURL),t.send(i),n.xhr=t}else this.#S(t,s.name),this.#O(n,a),this.#m++;else n.remove(),this.fpdInstance.currentViewInstance.currentUploadZone=null},i.src=t},e.readAsDataURL(s)}#I(e,t=0){this.fpdInstance.mainOptions;const i=L(this.fpdInstance.translator.getTranslation("modules","images_pdf_upload_info"),!1),n=new FormData,s=(n.append("uploadsDir",this.fpdInstance.uploadsDir),n.append("uploadsDirURL",this.fpdInstance.uploadsDirURL),n.append("pdf",e),new XMLHttpRequest);s.responseType="json",s.onreadystatechange=e=>{if(s.readyState===XMLHttpRequest.DONE){const e=s.status;if(0===e||200<=e&&e<400){const e=s.response;this.#y--,e.pdf_images.forEach((e,t)=>{var i=this.#x(e.image_url,e.filename);this.#O(i,0==t),this.#S(e.image_url,e.filename),this.#m++}),i.remove(),this.#y++,this.fpdInstance.loadingCustomImage=!1}}},s.upload.onerror=()=>{this.fpdInstance.loadingCustomImage=!1,i.remove(),L("Upload failed. Please try again or check your web console!")},s.open("POST",this.fpdInstance.uploadsURL),s.send(n)}#S(e,t){g;var i=window.localStorage.getItem("fpd_uploaded_images")?JSON.parse(window.localStorage.getItem("fpd_uploaded_images")):[];i.push({url:e,title:t}),window.localStorage.setItem("fpd_uploaded_images",JSON.stringify(i))}#x(e,t){const i=s({url:e,title:t,price:v(this.fpdInstance,this.container),removable:!0});return this.#T(i,e),this.gridElem.append(i),this.fpdInstance.lazyBackgroundObserver.observe(i.querySelector("picture")),p(i,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),p(i.querySelector(".fpd-delete"),"click",e=>{e.stopPropagation(),e.preventDefault();var t,e=Array.from(this.gridElem.children).indexOf(i);i.classList.contains("fpd-loading")||((t=JSON.parse(window.localStorage.getItem("fpd_uploaded_images"))).splice(e,1),window.localStorage.setItem("fpd_uploaded_images",JSON.stringify(t)),i.xhr&&i.xhr.abort(),i.remove())}),i}#O(e,t){if(!this.#v&&this.fpdInstance.mainOptions.autoFillUploadZones){const t=this.#b[this.#m]||null;t&&this.fpdInstance._addGridItemToCanvas(e,{_addToUZ:t.uz},t.viewIndex)}else t&&this.fpdInstance._addGridItemToCanvas(e);this.#m==this.#y-1&&(this.#v=!0)}#T(r,e){var t=this.fpdInstance.mainOptions.imageQualityRatings;if(t&&"object"==typeof t){let i=t.low||null,n=t.mid||null,s=t.high||null,a="fpd-icon-star",o="fpd-icon-star-outline";const c=new Image;c.onload=()=>{var e=document.createElement("div");let t;if(e.className="fpd-image-quality-ratings",r.append(e),i&&2==i.length){const r=c.width<Number(i[0])||c.height<Number(i[1])?o:a,n=document.createElement("span");n.className=r,e.append(n),r==a&&(t=this.fpdInstance.translator.getTranslation("misc","image_quality_rating_low"))}if(n&&2==n.length){const r=c.width<Number(n[0])||c.height<Number(n[1])?o:a,i=document.createElement("span");i.className=r,e.append(i),r==a&&(t=this.fpdInstance.translator.getTranslation("misc","image_quality_rating_mid"))}if(s&&2==s.length){const r=c.width<Number(s[0])||c.height<Number(s[1])?o:a,i=document.createElement("span");i.className=r,e.append(i),r==a&&(t=this.fpdInstance.translator.getTranslation("misc","image_quality_rating_high"))}t&&(e.dataset.qualityLabel=t)},c.src=e}}}class Z extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-head"> <div class="fpd-facebook-login"> <fb:login-button data-max-rows="1" data-show-faces="false" data-scope="user_photos"> </fb:login-button> </div> <fpd-dropdown class="fpd-facebook-albums" placeholder="Select An Album" searchable></fpd-dropdown> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-facebook-images",Z);class W extends EventTarget{constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-facebook-images"),t.append(this.container),this.dropdown=this.container.querySelector("fpd-dropdown"),this.dropdownList=this.container.querySelector(".fpd-dropdown-list"),this.gridElem=this.container.querySelector(".fpd-grid"),this.#L()}#L(){var e=document.createElement("script");e.src="//connect.facebook.com/en_US/sdk.js",e.addEventListener("load",()=>{FB.init({appId:this.fpdInstance.mainOptions.facebookAppId,autoLogAppEvents:!0,xfbml:!0,version:"v16.0"}),FB.getLoginStatus(this.#k.bind(this)),FB.Event.subscribe("auth.statusChange",this.#k.bind(this))}),document.body.appendChild(e)}#k(e){"connected"===e.status&&(h(this.container,["fpd-facebook-logged-in"]),FB.api("/me/albums?fields=name,count,id",e=>{e=e.data;e&&e.forEach(e=>{var t=document.createElement("span");t.className="fpd-item",t.dataset.albumid=e.id,t.innerText=e.name,t.addEventListener("click",e=>{this.dropdown.setAttribute("value",e.currentTarget.innerText),this.#P(e.currentTarget.dataset.albumid)}),this.dropdownList.append(t)}),u(this.dropdown,["fpd-on-loading"])}))}#P(t){this.gridElem.innerHTML="",h(this.dropdown,["fpd-on-loading"]),FB.api("/"+t+"?fields=count",e=>{e=e.count;FB.api("/"+t+"?fields=photos.limit("+e+").fields(source,images)",e=>{u(this.dropdown,["fpd-on-loading"]),e.error||e.photos.data.forEach(e=>{var t=(e.images[0]||e).source,i=(e.images[e.images.length-1]?e.images[e.images.length-1]:e).source,t=s({url:t,thumbnailUrl:i,title:e.id,price:v(this.fpdInstance,this.container)});p(t,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),this.gridElem.append(t),this.fpdInstance.lazyBackgroundObserver.observe(t.querySelector("picture"))}),this.fpdInstance.toggleSpinner(!1)})})}}class X extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-instagram-images",X);class G extends EventTarget{accessToken=null;nextStack=null;loadingStack=!1;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-instagram-images"),t.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid");const i=this.container.querySelector(".fpd-scroll-area");i.addEventListener("scroll",e=>{var t=i.scrollHeight;i.clientHeight+i.scrollTop+100>t&&(null===this.nextStack||this.loadingStack||this.#F(this.nextStack,!1))})}authenticate(){const e=this.fpdInstance.mainOptions;if(g()){const e=window.localStorage.getItem("fpd_insta_access_token");if(!m(e))return this.accessToken=e,void this.#F()}var t=(window.screen.width-700)/2,i=(window.screen.height-500)/2,n={app_id:e.instagramClientId,redirect_uri:e.instagramRedirectUri,scope:"user_profile,user_media",response_type:"code"},n=new URLSearchParams(n).toString(),s=window.open("https://api.instagram.com/oauth/authorize?"+n,"","width=700,height=500,left="+t+",top="+i),a=setInterval(()=>{s.closed&&clearInterval(a);try{var e;s.location&&s.location.href&&(e=new URL(s.location.href).searchParams.get("code"))&&(e=e.replace("#_",""),this.#A(e),s.close())}catch(e){}},500)}#A(e){var t=this.fpdInstance.mainOptions;this.fpdInstance.toggleSpinner(!0),S({url:t.instagramTokenUri,params:{code:e,client_app_id:t.instagramClientId,redirect_uri:t.instagramRedirectUri},onSuccess:e=>{e.access_token?(g()&&window.localStorage.setItem("fpd_insta_access_token",e.access_token),this.accessToken=e.access_token,this.#F()):e.error_message&&this.fpdInstance.toggleSpinner(!1)},onError:e=>{this.fpdInstance.toggleSpinner(!1)}})}#F(e="https://graph.instagram.com/me/media",t=!0){this.loadingStack=!0,this.fpdInstance.toggleSpinner(!0);e={url:e,onSuccess:e=>{e.data&&(this.nextStack=e.paging&&e.paging.next?e.paging.next:null,e.data.forEach(e=>{"VIDEO"!==e.media_type&&(e=s({url:e.media_url,thumbnailUrl:e.thumbnail_url||e.media_url,title:e.id,price:v(this.fpdInstance,this.container)}),p(e,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),this.gridElem.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture")))})),this.fpdInstance.toggleSpinner(!1),this.loadingStack=!1},onError:e=>{e.response&&e.response.error&&e.response.error.code&&g()&&190==e.response.error.code&&(window.localStorage.removeItem("fpd_insta_access_token"),this.accessToken=null,this.authenticate()),this.fpdInstance.toggleSpinner(!1),this.loadingStack=!1}};t&&(this.gridElem.innerHTML="",e.params={fields:"id,caption,media_url,media_type",access_token:this.accessToken}),S(e)}}class J extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-loader-wrapper"> <div class="fpd-loader"> <div class="fpd-loader-circle"></div> </div> </div> <div class="fpd-head"> <a href="https://pixabay.com/" target="_blank" class="fpd-pixabay-logo"> </a> <div class="fpd-input-search"> <input type="text" data-defaulttext="Search in Pixabay library" placeholder="modules.pixabay_search"/> <span class="fpd-icon-magnify"></span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-pixabay-images",J);class Y extends EventTarget{loadingStack=!1;currentQuery="";pixabayPage=1;constructor(e,t){super(),this.fpdInstance=e,this.container=document.createElement("fpd-module-pixabay-images"),t.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid"),this.loader=this.container.querySelector(".fpd-loader-wrapper");const i=this.container.querySelector(".fpd-scroll-area");i.addEventListener("scroll",e=>{var t=i.scrollHeight;i.clientHeight+i.scrollTop+100>t&&(this.loadingStack||(this.pixabayPage++,this.loadImages(void 0,!1)))}),p(this.container.querySelector("input"),["keypress"],e=>{13==e.which&&(this.pixabayPage=1,this.loadImages(e.currentTarget.value))})}loadImages(e,t=!0){if(this.currentQuery===e)return!1;var i=this.fpdInstance.mainOptions,e=(this.loadingStack=!0,this.currentQuery=void 0===e?this.currentQuery:e,i.pixabayHighResImages?"&response_group=high_resolution":""),e="https://pixabay.com/api/?safesearch=true&key="+i.pixabayApiKey+"&page="+this.pixabayPage+"&per_page=40&min_width="+i.customImageParameters.minW+"&min_height="+i.customImageParameters.minH+e+"&q="+encodeURIComponent(this.currentQuery)+"&lang="+i.pixabayLang;t&&(this.gridElem.innerHTML=""),u(this.loader,["fpd-hidden"]),S({url:e,onSuccess:e=>{h(this.loader,["fpd-hidden"]),0<e.hits.length&&e.hits.forEach(e=>{e=s({url:e.imageURL||e.webformatURL,thumbnailUrl:e.webformatURL,title:e.id||e.id_hash,price:v(this.fpdInstance,this.container)});p(e,["click"],e=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(e.currentTarget)}),this.gridElem.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture"))}),this.loadingStack=!1},onError:e=>{h(this.loader,["fpd-hidden"])}})}}class Q extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-scroll-area"> <input type="text" data-defaulttext="Enter a URL, some text..." placeholder="actions.qr_code_input"/> <div class="fpd-qr-code-colors"> <div class="fpd-qr-code-color-dark"></div> <div class="fpd-qr-code-color-light"></div> </div> <span class="fpd-add-qr-code fpd-btn" data-defaulttext="Add QR-Code"> actions.qr_code_add_btn </span> <div class="fpd-qr-code-wrapper fpd-hidden"></div> </div> '}}customElements.define("fpd-module-qr-code",Q);class $ extends EventTarget{constructor(n,e){super(),this.fpdInstance=n,this.darkColor="#000",this.lightColor="#fff",this.container=document.createElement("fpd-module-qr-code"),e.append(this.container);const t=this.container.querySelector(".fpd-qr-code-color-dark"),i=(t.style.backgroundColor="#000",new Picker({parent:t,popup:"bottom",alpha:!1,color:this.darkColor,onChange:e=>{this.darkColor=tinycolor(e.rgbaString).toHexString(),t.style.backgroundColor=this.darkColor}}),this.container.querySelector(".fpd-qr-code-color-light")),s=(i.style.backgroundColor=this.lightColor,new Picker({parent:i,popup:"bottom",alpha:!1,color:this.lightColor,onChange:e=>{this.lightColor=tinycolor(e.rgbaString).toHexString(),i.style.backgroundColor=this.lightColor}}),this.container.querySelector(".fpd-qr-code-wrapper"));p(this.container.querySelector(".fpd-btn"),"click",e=>{s.innerHTML="";const i=this.container.querySelector('input[type="text"]').value;i&&0<i.length&&(new QRCode(s,{text:this.container.querySelector('input[type="text"]').value,width:256,height:256,colorDark:this.darkColor,colorLight:this.lightColor,correctLevel:QRCode.CorrectLevel.H}),s.querySelector("img").onload=e=>{var t={_addToUZ:n.currentViewInstance.currentUploadZone};n._addCanvasImage(e.currentTarget.src,"QR-Code: "+i,t),this.container.querySelector('input[type="text"]').value=""})})}}class K extends EventTarget{constructor(n,e){super(),this.fpdInstance=n,this.container=document.createElement("fpd-module-images"),e.append(this.container);const i=Array.from(this.container.querySelectorAll(".fpd-module-tabs > div")),s=Array.from(this.container.querySelectorAll(".fpd-module-tabs-content > div"));let a=null,o=null;p(i,"click",e=>{const t=e.currentTarget;u(i,["fpd-active"]),u(s,["fpd-active"]),h(t,["fpd-active"]),h(s.find(e=>e.dataset.context==t.dataset.context),["fpd-active"]),"instagram"==t.dataset.context&&a&&!a.accessToken?a.authenticate():"pixabay"==t.dataset.context&&o&&o.loadImages()});e=n.mainOptions;new V(n,s.find(e=>"upload"==e.dataset.context)),p(n,["viewSelect","secondaryModuleCalled"],e=>{const t=v(n,this.container),i=this.container.querySelectorAll(".fpd-price");i&&(f(i,["fpd-hidden"],!Boolean(t)),i.forEach(e=>{e.innerHTML=t}))}),m(e.facebookAppId)||(new W(n,s.find(e=>"facebook"==e.dataset.context)),i.find(e=>"facebook"==e.dataset.context).classList.remove("fpd-hidden")),m(e.instagramClientId)||(a=new G(n,s.find(e=>"instagram"==e.dataset.context)),i.find(e=>"instagram"==e.dataset.context).classList.remove("fpd-hidden")),m(e.pixabayApiKey)||(o=new Y(n,s.find(e=>"pixabay"==e.dataset.context)),i.find(e=>"pixabay"==e.dataset.context).classList.remove("fpd-hidden")),new $(n,s.find(e=>"qr-code"==e.dataset.context)),i.filter(e=>!e.classList.contains("fpd-hidden")).length<2&&this.container.classList.add("fpd-hide-tabs")}}class ee extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-layers" data-defaulttext="Manage Layers" data-title="modules.manage_layers"> <div class="fpd-scroll-area"> <div class="fpd-list"></div> </div> </div>'}}customElements.define("fpd-module-manage-layers",ee);const P=s=>{var e=document.createElement("div");e.className="fpd-scroll-area",(s.enablePicker||s.subPalette)&&h(e,["fpd-has-subpanel"]);const a=document.createElement("div");let o;return a.className="fpd-color-palette",e.append(a),s.colors&&Array.isArray(s.colors)&&s.colors.forEach((t,i)=>{let e=t;if(s.colorNames){const a=s.colorNames[t.replace("#","").toLowerCase()];a&&(e=a.toUpperCase())}const n=document.createElement("span");n.className="fpd-item",n.style.backgroundColor=t,n.setAttribute("aria-label",e),a.append(n),s.enablePicker||s.subPalette||h(n,["fpd-tooltip"]),p(n,"click",e=>{if(e.stopPropagation(),s.enablePicker||s.subPalette){o&&(o.remove(),o=null);const e=n.classList.contains("fpd-active");e||(o=s.enablePicker?B({initialColor:t,colorNames:s.colorNames,palette:s.palette,onMove:e=>{s.onMove&&s.onMove(e,i)},onChange:e=>{n.style.backgroundColor=e,s.onChange&&s.onChange(e,i)}}):P({colors:s.palette,colorNames:s.colorNames,onChange:e=>{n.style.backgroundColor=e,s.onChange&&s.onChange(e,i)}}),a.append(o)),u(a,["fpd-sub-show"]),u(a.querySelectorAll(".fpd-item"),["fpd-active"]),e||(h(a,["fpd-sub-show"]),h(n,["fpd-active"]))}else s.onChange&&s.onChange(t)})}),e},_=P,B=i=>{let n=!1,s=null;var e=document.createElement("div");e.className="fpd-colorpicker-wrapper";const t=new Picker({parent:e,popup:!1,alpha:!1,color:i.initialColor||"#fff",onChange:e=>{const t=tinycolor(e.rgbaString).toHexString();n&&i.onMove&&i.onMove(t),"number"==typeof s&&clearTimeout(s),s=setTimeout(()=>{n&&i.onChange&&i.onChange(t),n=!0},500)}});if(void 0!==window.EyeDropper){const i=t.domElement.querySelector(".picker_sample"),n=document.createElement("span");n.className="fpd-icon-color",i.append(n),p(i,"click",e=>{(new EyeDropper).open().then(e=>{t.setColor(e.sRGBHex)}).catch(e=>{console.log(e)})})}if(i.palette&&Array.isArray(i.palette)){const n=_({colors:i.palette,colorNames:i.colorNames,onChange:e=>{i.onChange&&i.onChange(e)}});e.append(n)}return e};class te extends EventTarget{#_=null;constructor(t,e){super(),this.fpdInstance=t,this.container=document.createElement("fpd-module-manage-layers"),e.append(this.container),this.listElem=this.container.querySelector(".fpd-list"),p(t,"viewSelect",()=>{this.#B()}),p(t,["elementAdd","elementRemove"],e=>{t.productCreated&&this.#B()})}#B(){this.listElem.innerHTML="",this.fpdInstance.getElements(this.fpdInstance.currentViewIndex).forEach(e=>{e.checkEditable()&&this.#M(e)}),this.#_&&this.#_.dispose();let i;this.#_=AreaSortable("vertical",{container:this.listElem,handle:"fpd-icon-reorder",item:"fpd-list-row",placeholder:"fpd-sortable-placeholder",activeItem:"fpd-sortable-dragged",closestItem:"fpd-sortable-closest",autoscroll:!0,animationMs:0,onStart:e=>{const t=window.pageYOffset||document.documentElement.scrollTop||0;window.onscroll=()=>{window.scrollTo({top:t})},i=e.offsetTop},onChange:e=>{var t=this.fpdInstance.currentViewInstance.fabricCanvas,i=t.getElementByID(e.id);let n=this.listElem.querySelector(".fpd-sortable-closest"),s=t.getElementByID((n||e).id).getZIndex();n||s++,t.setElementOptions({z:s},i)},onEnd:e=>{window.onscroll=()=>{}}})}#M(i){const n=document.createElement("div");n.className="fpd-list-row",n.id=i.id;let e=document.createElement("span"),t=null;if(!i.uploadZone&&i.hasColorSelection()){t=((e,t)=>{var i=[];if("group"==e.type){const t=e.getObjects();1===t.length?i=e.colors:(i=[],t.forEach(e=>{e=tinycolor(e.fill);i.push(e.toHexString())}))}else i=(e.colorLinkGroup&&t.colorLinkGroups[e.colorLinkGroup]?t.colorLinkGroups[e.colorLinkGroup]:e).colors;return i})(i,this.fpdInstance);const s=(e=>{let t=e.fill;return"string"==typeof t?t:"object"==typeof t?t.source?"url("+(t=t.source.src)+")":t[0]:!0===e.colors&&"group"===e.type?tinycolor(e.getObjects()[0].fill):!1===t&&e.colors&&e.colors[0]?e.colors[0]:void 0})(i);e.style.background=s,e.className="fpd-current-color",n.colors=t}const s=document.createElement("div");s.className="fpd-cell-0",s.append(e),n.append(s);let a=i.title;"text"===i.getType()&&i.editable&&((a=document.createElement("textarea")).innerText=i.text,p(a,"keyup",e=>{e.stopPropagation();let t=e.target.value;t=t.replace(FancyProductDesigner.forbiddenTextChars,""),this.fpdInstance.mainOptions.disableTextEmojis&&(t=(t=t.replace(FPDEmojisRegex,"")).replace(String.fromCharCode(65039),"")),this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({text:t},i)}),i.on({"editing:exited":()=>{a.value=i.text}}));var o=document.createElement("div"),o=(o.className="fpd-cell-1",o.append(a),n.append(o),document.createElement("div"));if(o.className="fpd-cell-2",n.append(o),i.uploadZone){h(n,["fpd-add-layer"]);const i=document.createElement("span");i.className="fpd-icon-add",o.append(i)}else{if(i.zChangeable){const i=document.createElement("span");i.className="fpd-icon-reorder",o.append(i)}const e=i.locked?"fpd-icon-locked-full":"fpd-icon-unlocked",t=document.createElement("span");t.className="fpd-lock-element",t.innerHTML=`<span class="${e}"></span>`,o.append(t),p(t,"click",e=>{e.stopPropagation(),u(n,["fpd-show-colors"]),i.evented=!i.evented,i.locked=!i.evented;e=e.currentTarget.querySelector("span");f(e,["fpd-icon-unlocked"],i.evented),f(e,["fpd-icon-locked-full"],!i.evented),f(n,["fpd-locked"],!i.evented)}),f(n,["fpd-locked"],i.locked)}let r=i.removable||i.__editorMode;if(r=i.uploadZone?i.uploadZoneRemovable:r){const n=document.createElement("span");n.className="fpd-remove-element",n.innerHTML='<span class="fpd-icon-remove"></span>',o.append(n),p(n,"click",e=>{e.stopPropagation(),this.fpdInstance.currentViewInstance.fabricCanvas.removeElement(i)})}if(this.listElem.append(n),t){const e=document.createElement("div");if(e.className="fpd-cell-full",n.append(e),"group"===i.type&&1<i.getObjects().length){o=Array.isArray(i.colors)&&1<i.colors.length?_({colors:t,colorNames:this.fpdInstance.mainOptions.hexNames,palette:i.colors,subPalette:!0,onChange:(e,t)=>{this.#j(i,t,e)}}):_({colors:t,enablePicker:!0,colorNames:this.fpdInstance.mainOptions.hexNames,palette:this.fpdInstance.mainOptions.colorPickerPalette,onMove:(e,t)=>{i.changeObjectColor(t,e)},onChange:(e,t)=>{this.#j(i,t,e)}});e.append(o)}else if(1===t.length){const s=B({initialColor:t[0],colorNames:this.fpdInstance.mainOptions.hexNames,palette:this.fpdInstance.mainOptions.colorPickerPalette,onMove:e=>{this.#U(i,e)},onChange:e=>{this.#q(i,n,e)}});e.append(s)}else{const s=_({colors:t,colorNames:this.fpdInstance.mainOptions.hexNames,palette:this.fpdInstance.mainOptions.colorPickerPalette,onChange:e=>{this.#q(i,n,e)}});if(e.append(s),Array.isArray(i.patterns)&&(i.isSVG()||"text"===i.getType())){const t=(s=>{var e=document.createElement("div");e.className="fpd-scroll-area";const a=document.createElement("div");return a.className="fpd-patterns-wrapper",e.append(a),s.images&&Array.isArray(s.images)&&s.images.forEach((t,e)=>{var i=t.replace(/^.*[\\\/]/,"").replace(/\.[^/.]+$/,"").replace("_"," ").toUpperCase(),n=document.createElement("span");n.className="fpd-item fpd-tooltip",n.style.backgroundImage=`url("${t}")`,n.setAttribute("aria-label",i),a.append(n),p(n,"click",e=>{s.onChange&&s.onChange(t)})}),e})({images:i.patterns,onChange:e=>{n.querySelector(".fpd-current-color").style.backgroundImage=`url("${e}")`,this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({pattern:e},i)}});e.append(t)}}p(n.querySelector(".fpd-current-color"),"click",e=>{var t=!n.classList.contains("fpd-show-colors");u(this.listElem.querySelectorAll(".fpd-list-row"),["fpd-show-colors"]),f(n,["fpd-show-colors"],t)})}p(n,"click",e=>{var t=e.currentTarget;t.classList.contains("fpd-locked")||"TEXTAREA"==e.target.nodeName||(e=this.fpdInstance.getElementByID(t.id))&&e.canvas.setActiveObject(e).renderAll()})}#U(e,t){"png"!==e.isColorizable()&&e.changeColor(t)}#q(e,t,i){t.querySelector(".fpd-current-color").style.backgroundColor=i,this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:i},e)}#j(e,t,i){t=e.changeObjectColor(t,i);this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:t},e)}}class F extends EventTarget{constructor(t,i,n){let s;if(super(),"products"===n)s=new k(t,i);else if("text"===n)s=new M(t,i);else if("text-to-image"===n)s=new U(t,i);else if(n.includes("designs")){let e=null;if(n.includes("designs_")&&!m(t.mainOptions.dynamicDesigns)){if(!(e=n.split("_").pop())||!t.mainOptions.dynamicDesigns[e])return;{var a=t.mainOptions.dynamicDesigns[e];const i={};i["data-dynamic-designs-id"]=e,!m(a.icon)&&a.icon.includes(".svg")&&(this.configs={icon:a.icon,defaultText:a.name,attrs:i})}}s=new N(t,i,e)}else"images"===n?s=new K(t,i):"manage-layers"===n&&(s=new te(t,i));if(FancyProductDesigner.additionalModules&&!s){const a=FancyProductDesigner.additionalModules[n];a&&(s=new a(t,i))}if(s&&(this.moduleInstance=s,t["moduleInstance_"+n]=s,!n.includes("designs_"))){const t=s.container.querySelector("div");this.configs={icon:t.dataset.moduleicon,langId:t.dataset.title,langKeys:t.dataset.title.split("."),defaultText:t.dataset.defaulttext}}}}class ie extends EventTarget{#N=null;#H=null;#z=!1;#R=0;#V=0;#Z=0;#W=0;#G=!1;#X=!1;contentElem=null;navElem=null;currentModuleKey="";constructor(e){super();var t=(this.fpdInstance=e).container;if(this.container=document.createElement("fpd-main-bar"),t.append(this.container),this.contentElem=this.container.querySelector(".fpd-module-content"),this.navElem=this.container.querySelector(".fpd-navigation"),this.secContent=this.container.querySelector(".fpd-secondary-content"),this.currentModules=e.mainOptions.mainBarModules,this.#N=document.querySelector(this.fpdInstance.mainOptions.modalMode?".fpd-modal-product-designer":"body"),this.#H=document.querySelector(".fpd-draggable-dialog"),this.#N.append(this.#H),p(this.#H,["mousedown","touchstart"],this.#Y.bind(this)),p(this.#H,["mouseup","touchend"],this.#J.bind(this)),p(document,["mousemove","touchmove"],this.#$.bind(this)),p(this.#H.querySelector(".fpd-close-dialog"),["click","touchstart"],this.#Q.bind(this)),p(this.container.querySelector(".fpd-close-off-canvas"),"click",this.#Q.bind(this)),p(e,"viewSelect",this.#K.bind(this)),t.classList.contains("fpd-off-canvas")){let t=0,i=0;this.contentElem.addEventListener("touchstart",e=>{t=e.touches[0].pageX,h(this.container,["fpd-is-dragging"])}),this.contentElem.addEventListener("touchmove",e=>{e.preventDefault();e=e.touches[0].pageX;i=t-e,i=Math.abs(i)<0?0:Math.abs(i),this.contentElem.style.left=-i+"px",this.contentElem.previousElementSibling.style.left=this.contentElem.clientWidth-i+"px"}),this.contentElem.addEventListener("touchend",e=>{100<Math.abs(i)?this.toggleContentDisplay(!1):(this.contentElem.style.left="0px",this.contentElem.previousElementSibling.style.left=this.contentElem.clientWidth+"px"),i=0,u(this.container,["fpd-is-dragging"])})}this.updateContentWrapper(),this.setup(this.currentModules)}#Y(e){this.#H.querySelector(".fpd-dialog-drag-handle").contains(e.target)&&(e.preventDefault(),this.#z=!0,this.#R=(e.touches?event.touches[0]:e).clientX,this.#V=(e.touches?event.touches[0]:e).clientY,this.#Z=this.#R-this.#H.offsetLeft,this.#W=this.#V-this.#H.offsetTop)}#$(i){if(this.#z){var n=this.#N.clientWidth<window.innerWidth?window.innerWidth:this.#N.clientWidth,s=this.#N.clientHeight<window.innerHeight?window.innerHeight:this.#N.clientHeight,n=n-this.#H.clientWidth,s=s-this.#H.clientHeight,a=(i.touches?event.touches[0]:i).clientX;let e=(i.touches?event.touches[0]:i).clientY-this.#W,t=a-this.#Z;t<0&&(t=0),e<0&&(e=0),t>n&&(t=n),e>s&&(e=s),this.#H.style.top=e+"px",this.#H.style.left=t+"px"}}#J(e){this.#z=!1}#ee(e){e.stopPropagation(),this.fpdInstance.deselectElement(),this.fpdInstance.currentViewInstance&&(this.fpdInstance.currentViewInstance.currentUploadZone=null),e.currentTarget.classList.contains("fpd-active")&&this.contentClosable?this.toggleContentDisplay(!1):this.callModule(e.currentTarget.dataset.module,e.currentTarget.dataset.dynamicDesignsId)}#Q(){this.fpdInstance.currentViewInstance&&this.fpdInstance.currentViewInstance.currentUploadZone&&this.fpdInstance.currentViewInstance.deselectElement(),this.toggleContentDisplay(!1)}#K(){var e=this.fpdInstance.currentViewInstance,t=e.options.customAdds;f(document.querySelectorAll('.fpd-nav-item[data-module^="designs"]'),["fpd-disabled"],!t.designs),f(document.querySelectorAll('.fpd-nav-item[data-module="images"]'),["fpd-disabled"],!t.uploads),f(document.querySelectorAll('.fpd-nav-item[data-module="text-to-image"]'),["fpd-disabled"],!t.uploads),f(document.querySelectorAll('.fpd-nav-item[data-module="drawing"]'),["fpd-disabled"],!t.drawing),f(document.querySelectorAll('.fpd-nav-item[data-module="text"]'),["fpd-disabled"],!t.texts),f(document.querySelectorAll('.fpd-nav-item[data-module="names-numbers"]'),["fpd-disabled"],!e.textPlaceholder&&!e.numberPlaceholder),this.toggleContentDisplay(!1)}callModule(e,t=null){let i;if(u(this.secContent,["fpd-active"]),u(this.contentElem,["fpd-hidden"]),u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),u(Array.from(this.contentElem.children),["fpd-active"]),t)i=h(this.navElem.querySelector('.fpd-nav-item[data-dynamic-designs-id="'+t+'"]'),["fpd-active"]),h(this.contentElem.querySelector('[data-dynamic-designs-id="'+t+'"]'),["fpd-active"]);else{i=h(this.navElem.querySelector('.fpd-nav-item[data-module="'+e+'"]'),["fpd-active"]);const t=this.contentElem.querySelector("fpd-module-"+e);h(t,["fpd-active"]),"text"==e&&t.querySelector("textarea").focus()}this.toggleContentDisplay(),this.currentModuleKey=e}callSecondary(e){u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),h(this.contentElem,["fpd-hidden"]),h(this.secContent,["fpd-active"]),h(this.secContent.querySelector(".fpd-"+e),["fpd-active"]),this.fpdInstance.dispatchEvent(new CustomEvent("secondaryModuleCalled",{detail:{moduleName:e}}))}get contentClosable(){var e=this.fpdInstance.container;return this.#X||this.#G||e.classList.contains("fpd-layout-small")}toggleContentDisplay(e=!0){var t=this.fpdInstance.container;f(t,["fpd-module-visible"],e),this.contentClosable&&!e&&u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),this.#X?(!e&&this.currentModuleKey.length&&this.fpdInstance.deselectElement(),this.contentElem.style.removeProperty("left"),this.contentElem.previousElementSibling.style.removeProperty("left"),this.contentElem.style.height=this.fpdInstance.mainWrapper.container.clientHeight+"px",this.container.classList.toggle("fpd-show",e)):this.#G&&(e&&(this.#H.querySelector(".fpd-dialog-title").innerText=this.navElem.querySelector(".fpd-nav-item.fpd-active .fpd-label").innerText),this.#H.classList.toggle("fpd-show",e)),e||(this.currentModuleKey="")}updateContentWrapper(){var e=this.fpdInstance.container;this.toggleContentDisplay(!1),this.#X=!1,this.#G=!1,u(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),(e.classList.contains("fpd-off-canvas")?(this.#X=!0,this.container):e.classList.contains("fpd-sidebar")?this.container:(this.#G=!0,this.#H)).append(this.contentElem)}toggleUploadZonePanel(e=!0,t={}){if(!this.fpdInstance.loadingCustomImage)if(f(this.secContent,["fpd-active"],e),e){f(this.uploadZoneNavItems.find(e=>e.classList.contains("fpd-add-image")),["fpd-hidden"],!Boolean(t.uploads)),f(this.uploadZoneNavItems.find(e=>e.classList.contains("fpd-add-text")),["fpd-hidden"],!Boolean(t.texts)),f(this.uploadZoneNavItems.find(e=>e.classList.contains("fpd-add-design")),["fpd-hidden"],!Boolean(t.designs)),this.fpdInstance.UZmoduleInstance_designs&&this.fpdInstance.UZmoduleInstance_designs.toggleCategories();const e=this.uploadZoneNavItems.find(e=>!e.classList.contains("fpd-hidden"));e&&e.click(),this.callSecondary("upload-zone-panel")}else this.fpdInstance.currentViewInstance.currentUploadZone=null}setup(t=[]){let e=this.fpdInstance.mainOptions.initialActiveModule||"";const o=this.container.querySelector(".fpd-navigation");this.currentModules.length<=1&&!this.fpdInstance.container.classList.contains("fpd-topbar")?(e=this.currentModules[0]||"",o.classList.add("fpd-hidden")):this.fpdInstance.container.classList.contains("fpd-sidebar")&&""==e?e=this.currentModules[0]||"":o.classList.remove("fpd-hidden"),o.innerHTML=this.contentElem.innerHTML="",FancyProductDesigner.additionalModules&&Object.keys(FancyProductDesigner.additionalModules).forEach(e=>{t.push(e)}),t.forEach(e=>{let i="";var n=new F(this.fpdInstance,this.contentElem,e);if(n.moduleInstance){var s,a=document.createElement("div");a.classList.add("fpd-nav-item"),a.dataset.module=e,a.addEventListener("click",this.#ee.bind(this)),o.appendChild(a);let t=document.createElement("span");if(n.configs.icon.includes(".svg")?(s={url:n.configs.icon,onSuccess:e=>{t.innerHTML=e},onError:e=>{console.log(e)}},fetch(s.url).then(e=>{e.ok?e.text().then(e=>{s.onSuccess&&s.onSuccess(e)}):e.text().then(e=>{s.onError&&s.onError(e)})})):(t.classList.add("fpd-nav-icon"),t.classList.add(n.configs.icon)),a.append(t),n.configs.langKeys){const e=n.configs.langKeys;i=this.fpdInstance.translator.getTranslation(e[0],e[1],this.fpdInstance.mainOptions.langJson,n.configs.defaultText)}else n.configs.defaultText&&(i=n.configs.defaultText);e=document.createElement("span");if(e.className="fpd-label",e.innerText=i,a.append(e),n.configs.attrs)for(const[e,i]of Object.entries(n.configs.attrs))a.setAttribute(e,i)}}),this.contentClosable||o.querySelector(`[data-module="${e}"]`).click(),this.uploadZoneContent=this.secContent.querySelector(".fpd-upload-zone-content"),this.uploadZoneNavItems=Array.from(this.secContent.querySelectorAll(".fpd-upload-zone-panel .fpd-bottom-nav > div"));var i=new F(this.fpdInstance,this.uploadZoneContent,"images"),i=(this.fpdInstance.UZmoduleInstance_images=i.moduleInstance,new F(this.fpdInstance,this.uploadZoneContent,"text")),i=(this.fpdInstance.UZmoduleInstance_text=i.moduleInstance,new F(this.fpdInstance,this.uploadZoneContent,"designs"));this.fpdInstance.UZmoduleInstance_designs=i.moduleInstance,p(this.uploadZoneNavItems,"click",e=>{u(this.uploadZoneNavItems,["fpd-active"]),h(e.currentTarget,["fpd-active"]),u(Array.from(this.uploadZoneContent.children),["fpd-active"]),h(this.uploadZoneContent.querySelector("fpd-module-"+e.currentTarget.dataset.module),["fpd-active"])})}}class ne extends HTMLElement{constructor(){super()}connectedCallback(){var e=document.createElement("template");e.innerHTML='<div class="fpd-snap-line-h"></div> <div class="fpd-snap-line-v"></div> <div class="fpd-product-stage"></div>',this.append(e.content.cloneNode(!0))}}customElements.define("fpd-main-wrapper",ne);class se{constructor(e){this.container=document.createElement("fpd-main-wrapper"),e.container.append(this.container)}}de(561);class ae extends EventTarget{constructor(e){super(),this.container=document.createElement("fpd-actions-bar"),e.container.append(this.container)}}class oe extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<span class="fpd-view-prev"> <span class="fpd-icon-forward"></span> </span> <div class="fpd-views-selection"></div> <span class="fpd-view-next"> <span class="fpd-icon-forward"></span> </span> '}}customElements.define("fpd-views-wrapper",oe);class re extends EventTarget{constructor(e){super(),this.container=document.createElement("fpd-views-wrapper"),e.container.classList.contains("fpd-views-outside")||e.mainOptions.modalMode?e.container.after(this.container):e.mainWrapper.container.append(this.container)}}class ce extends EventTarget{#te=0;constructor(e){super(),this.fpdInstance=e}init(){this.#ie(),this.#ne(),this.#se(),this.fpdInstance.container.classList.add("fpd-container"),this.fpdInstance.container.classList.add("fpd-wrapper");var e=document.createElement("div");e.innerHTML='<div class="fpd-loader-wrapper"> <div class="fpd-loader"> <div class="fpd-loader-circle"></div> <span class="fpd-loader-text" data-defaulttext="Initializing Product Designer">misc.initializing</span> </div> </div>',this.fpdInstance.container.appendChild(e.firstChild.cloneNode(!0)),this.fpdInstance.mainLoader=this.fpdInstance.container.querySelector(".fpd-loader-wrapper"),this.fpdInstance.actionsBar=new ae(this.fpdInstance),this.fpdInstance.mainBar=new ie(this.fpdInstance),this.fpdInstance.mainWrapper=new se(this.fpdInstance),this.fpdInstance.productStage=this.fpdInstance.mainWrapper.container.querySelector(".fpd-product-stage"),this.fpdInstance.viewsWrapper=new re(this.fpdInstance),Array.from(this.fpdInstance.container.querySelectorAll("[data-defaulttext]")).forEach(e=>{this.fpdInstance.translator.translateElement(e,this.fpdInstance.mainOptions.langJson)}),this.dispatchEvent(new CustomEvent("ready")),window.addEventListener("resize",this.#ie.bind(this))}#ie(){var e=this.fpdInstance.mainOptions.responsiveBreakpoints;this.#te=window.innerWidth,this.#te<e.small?(this.fpdInstance.container.classList.remove("fpd-layout-medium"),this.fpdInstance.container.classList.remove("fpd-layout-large"),this.fpdInstance.container.classList.add("fpd-layout-small")):this.#te<e.medium?(this.fpdInstance.container.classList.remove("fpd-layout-small"),this.fpdInstance.container.classList.remove("fpd-layout-large"),this.fpdInstance.container.classList.add("fpd-layout-medium")):(this.fpdInstance.container.classList.remove("fpd-layout-medium"),this.fpdInstance.container.classList.remove("fpd-layout-small"),this.fpdInstance.container.classList.add("fpd-layout-large"))}#ne(){var e=document.body;let i;(i=document.createElement("div")).className="fpd-thumbnail-preview fpd-shadow-1 fpd-hidden",i.innerHTML="<picture></picture>";const n=document.createElement("div");n.className="fpd-preview-title",i.append(n),e.append(i),p(e,["mouseover","mouseout","mousemove","click"],e=>{var t=e.target;if(t.classList.contains("fpd-hover-thumbnail")&&i.classList.contains("fpd-hidden")&&"mouseover"===e.type&&t.dataset.source){i.querySelector(".fpd-price")&&i.querySelector(".fpd-price").remove(),i.querySelector(".fpd-image-quality-ratings")&&i.querySelector(".fpd-image-quality-ratings").remove(),i.querySelector("picture").style.backgroundImage=`url("${t.dataset.source}")`,t.dataset.title&&(n.innerText=t.dataset.title),f(n,["fpd-hidden"],!t.dataset.title),f(i,["fpd-title-enabled"],t.dataset.title);const e=t.querySelector(".fpd-price");e&&i.append(e.cloneNode(!0));t=t.querySelector(".fpd-image-quality-ratings");console.log(t),t&&i.append(t.cloneNode(!0)),i.classList.remove("fpd-hidden")}if(i.classList.contains("fpd-hidden")||"mousemove"!==e.type&&"mouseover"!==e.type)"mouseout"!==e.type&&"click"!=e.type||i.classList.add("fpd-hidden");else{const n=e.pageX+10+i.offsetWidth>window.innerWidth?window.innerWidth-i.offsetWidth:e.pageX+10;i.style.left=n+"px",i.style.top=e.pageY+10+"px"}})}#se(){const e=document.body,r=document.createElement("div");r.className="fpd-main-tooltip",e.append(r),this.fpdInstance.mainTooltip=r,e.addEventListener("mouseover",i=>{var n=i.target;if(n.classList.contains("fpd-tooltip")){const i=n.getAttribute("aria-label");r.innerHTML=i;var{x:n,y:s,width:a,height:o}=n.getBoundingClientRect();let e=Math.floor(s-r.clientHeight-5),t=Math.floor(n+a/2-r.clientWidth/2);e<0&&(e=Math.floor(s+o+5)),t<0?t=0:t>window.outerWidth-r.clientWidth&&(t=window.outerWidth-r.clientWidth-5),r.style.left=t+"px",r.style.top=e+"px",r.classList.add("fpd-show")}else r.classList.remove("fpd-show")}),e.addEventListener("touchstart",e=>{r.classList.remove("fpd-show")})}}class le{constructor(i){const t=document.querySelector(i.mainOptions.editorMode);t&&(h(t,["fpd-editor-box-wrapper","fpd-container"]),this.titleElem=document.createElement("div"),this.titleElem.className="fpd-eb-title",t.append(this.titleElem),this.gridElem=document.createElement("div"),this.gridElem.className="fpd-eb-grid",t.append(this.gridElem),i.mainOptions.editorBoxParameters.forEach(e=>{var t=document.createElement("div");t.innerHTML="<span>"+e+'</span><input type="text" readonly data-prop="'+e+'" />',this.gridElem.append(t)})),p(i,["elementSelect","elementChange"],e=>{t&&(i.currentElement?(this.titleElem.innerText=i.currentElement.title,i.mainOptions.editorBoxParameters.forEach(e=>{let t=i.currentElement[e];void 0!==t&&(t="object"==typeof(t="number"==typeof t?t.toFixed(2):t)&&t.source?t.source.src:t,"fill"===e&&"group"===i.currentElement.type&&(t=i.currentElement.svgFill),e=this.gridElem.querySelector('input[data-prop="'+e+'"]'))&&(e.value=t)})):this.titleElem.innerText="",f(this.gridElem,["fpd-hidden"],!i.currentElement))})}}class A extends EventTarget{static forbiddenTextChars=/<|>/g;static proxyFileServer="";static additionalModules={};container=null;mainOptions={};currentViewInstance=null;currentViewIndex=0;products=[];designs=[];modalContainer=document.body;currentCategoryIndex=0;currentProductIndex=0;viewInstances=[];currentViews=null;currentElement=null;productCreated=!1;colorLinkGroups={};globalCustomElements=[];doUnsavedAlert=!1;currentPrice=0;singleProductPrice=0;pricingRulesPrice=0;loadingCustomImage=!1;lazyBackgroundObserver=null;#ae=0;#oe=0;#re=!1;constructor(e,t={}){super(),this.lazyBackgroundObserver=new IntersectionObserver((e,t)=>{e.forEach(e=>{var t,i,n;e.isIntersecting&&(t=e.target,i=null,t&&(t.classList.add("fpd-on-loading"),(n=new Image).src=i||t.dataset.img,n.onload=function(){t.dataset.originwidth=this.width,t.dataset.originheight=this.height,t.classList.remove("fpd-on-loading"),t.style.backgroundImage='url("'+this.src+'")'},n.onerror=function(){t.parentNode.remove()}),this.lazyBackgroundObserver.unobserve(e.target))})}),this.container=e,(this.container.instance=this).mainOptions=y.merge(y.defaults,t);e=this.mainOptions.customImageAjaxSettings;this.uploadsURL=e.url,this.uploadsDir=e.data&&e.data.uploadsDir?e.data.uploadsDir:"",this.uploadsDirURL=e.data&&e.data.uploadsDirURL?e.data.uploadsDirURL:"",this.uploadsToServer=e.data&&e.data.saveOnServer?1:0;let i={};Object.keys(this.mainOptions.hexNames).forEach(e=>{i[e.toLowerCase()]=this.mainOptions.hexNames[e]}),this.mainOptions.hexNames=i,this.translator=new D,this.translator.loadLangJSON(this.mainOptions.langJson,this.#le.bind(this))}#le(){this.uiManager=new ce(this),this.uiManager.addEventListener("ready",e=>{this.#ce()}),this.uiManager.init()}#ce(){(class{static parseFontsToEmbed(e){var t="";if(e.hasOwnProperty("url")){e.name;var i=-1!==e.url.search(".woff")?"woff":"TrueType",n=FancyProductDesigner.proxyFileServer+e.url;if(t+='@font-face {font-family:"'+e.name+'"; font-style: normal; font-weight: normal; src:url("'+n+'") format("'+i+'");}\n',e.variants){for(const s in e.variants)n=FancyProductDesigner.proxyFileServer+e.variants[s],t+='@font-face {font-family:"'+e.name+'"; '+{n7:"font-style: normal; font-weight: bold;",i4:"font-style: italic; font-weight: normal;",i7:"font-style: italic; font-weight: bold;"}[s]+' src:url("'+n+'") format("'+i+'");}\n';Object.keys(e.variants).toString()}}return t}static load(e,o){var t=e.mainOptions.fonts;if(t&&0<t.length&&"object"==typeof t[0]){t.sort((e,t)=>{e=e.name.toUpperCase(),t=t.name.toUpperCase();return e<t?-1:t<e?1:0});let n=[],s=[],a=0;const r=document.createElement("style");r.id="fpd-fonts",e.container.before(r),t.forEach(e=>{var t;e.hasOwnProperty("url")&&("google"==e.url?n.push(e.name+":400,400i,700,700i"):(t=e.name,t+=":n4",e.variants&&(t+=","+Object.keys(e.variants).toString()),s.push(t),r.append(this.parseFontsToEmbed(e))))});var i=function(e,t,i){"inactive"==e&&console.log(t+" font could not be loaded."),a==n.length+s.length-1&&o(),a++},e={fontactive:function(e,t){i("active",e)},fontinactive:function(e,t){i("inactive",e)},timeout:3e3};0<n.length&&(e.google={families:n}),0<s.length&&(e.custom={families:s}),"undefined"!=typeof WebFont&&(0<n.length||0<s.length)?WebFont.load(e):o()}else o()}}).load(this,()=>{this.#de()})}#de(){setTimeout(()=>{this.dispatchEvent(new CustomEvent("uiSet"))},1),this.#pe()}#pe(){this.dispatchEvent(new CustomEvent("ready")),this.mainOptions.productsJSON&&("object"==typeof this.mainOptions.productsJSON?this.setupProducts(this.mainOptions.productsJSON):S({url:this.mainOptions.productsJSON,onSuccess:e=>{this.setupProducts(e)},onError:()=>{alert("Products JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.productsJSON)}})),this.mainOptions.designsJSON&&("object"==typeof this.mainOptions.productsJSON?this.setupDesigns(this.mainOptions.designsJSON):S({url:this.mainOptions.designsJSON,onSuccess:e=>{this.setupDesigns(e)},onError:()=>{alert("Design JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.designsJSON)}})),this.mainOptions.keyboardControl&&p(document,"keydown",e=>{if(this.currentViewInstance&&this.currentViewInstance.fabricCanvas){var t=this.currentViewInstance,i=e.target.nodeName,n=t.fabricCanvas.getActiveObject();if(n&&!["TEXTAREA","INPUT"].includes(i)){switch(e.which){case 8:n.removable&&t.fabricCanvas.removeElement(n);break;case 37:n.draggable&&t.fabricCanvas.setElementParameters({left:n.left-1});break;case 38:n.draggable&&t.fabricCanvas.setElementParameters({top:n.top-1});break;case 39:n.draggable&&t.fabricCanvas.setElementParameters({left:n.left+1});break;case 40:n.draggable&&t.fabricCanvas.setElementParameters({top:n.top+1});break;default:return}e.preventDefault()}}});let t=0,i=(p(window,"resize",e=>{window.innerWidth===t||this.#re||(t=window.innerWidth,this.currentViewInstance&&this.currentViewInstance.fabricCanvas.resetSize(),this.currentElement&&!["INPUT","TEXTAREA"].includes(document.activeElement)&&this.deselectElement())}),p(this,"productCreate",this.#ue.bind(this)),!1);p(document.body,"mousedown",e=>{}),p(document.body,["focusin","blur"],e=>{["TEXTAREA","INPUT"].includes(e.target.nodeName)&&(this.#re="focusin"==e.type)},!0),p(document.body,["mouseup","touchend"],t=>{var e=Array.from(document.querySelectorAll(".fpd-container"));Boolean(e.find(e=>e.contains(t.target)))||!this.mainOptions.deselectActiveOnOutside||i||this.deselectElement(),i=!1},!0),"string"==typeof this.mainOptions.editorMode&&new le(this)}#ue(){const e=this.globalCustomElements.concat(this.fixedElements);if(!e.length)return;let t=0;const i=t=>{var i=this.viewInstances[t.viewIndex];if(i){t=t.element;let e=Object.keys(this.mainOptions.elementParameters);e="text"===t.getType()?e.concat(Object.keys(this.mainOptions.textParameters)):e.concat(Object.keys(this.mainOptions.imageParameters));var n=t.getElementJSON(!1,e);n._printingBox&&delete n.boundingBox,i.fabricCanvas.addElement(t.getType(),t.source,t.title,n)}else s()},s=()=>{++t<e.length?i(e[t]):this.removeEventListener("elementAdd",s)};p(this,"elementAdd",s),e[0]&&i(e[0])}#he(t){var e=this.products.findIndex(e=>e.category===t);return-1!==e&&e}setupProducts(e=[]){this.products=[],e.forEach(t=>{t.hasOwnProperty("category")?t.products.forEach(e=>{this.addProduct(e,t.category)}):this.addProduct(t)}),this.mainOptions.loadFirstProductInStage&&0<e.length?this.selectProduct(0):this.toggleSpinner(!1),this.dispatchEvent(new CustomEvent("productsSet"))}setupDesigns(e){this.designs=e,this.dispatchEvent(new CustomEvent("designsSet"))}addProduct(e,t){var i=this.#he(t);(void 0===t?this:(!1===i&&(i=this.products.length,this.products[i]={category:t,products:[]}),this.products[i])).products.push(e),this.dispatchEvent(new CustomEvent("productAdd",{detail:{views:e,category:t,catIndex:i}}))}selectProduct(e,t){this.currentCategoryIndex=void 0===t?this.currentCategoryIndex:t,t=(this.products&&this.products.length&&this.products[0].category?this.products[this.currentCategoryIndex]:instance).products,(this.currentProductIndex=e)<0?this.currentProductIndex=0:e>t.length-1&&(this.currentProductIndex=t.length-1);e=t[this.currentProductIndex];this.dispatchEvent(new CustomEvent("productSelect",{detail:{product:e}})),this.loadProduct(e,this.mainOptions.replaceInitialElements)}loadProduct(e,t=!1,i=!1){e&&(this.toggleSpinner(!0),this.productCreated=!1,this.colorLinkGroups={},this.globalCustomElements=[],t?this.globalCustomElements=this.getCustomElements():this.doUnsavedAlert=!1,this.fixedElements=this.getFixedElements(),this.reset(),i&&e.forEach((e,t)=>{e.options=y.merge(this.mainOptions,e.options)}),this.currentViews=e,this.#ae=this.#oe=0,e.forEach((e,t)=>{this.#ae+=e.elements.length}),p(this,"viewCreate",this.#ge),e)&&this.addView(e[0])}addView(e){const t=A.proxyFileServer?A.proxyFileServer+e.thumbnail:e.thumbnail,i=document.createElement("div");i.className="fpd-shadow-1 fpd-item",i.title=e.title,i.innerHTML='<picture style="background-image: url('+t+');"></picture>',this.viewsWrapper.container.querySelector(".fpd-views-selection").append(i),p(i,"click",e=>{var t=Array.from(this.viewsWrapper.container.querySelectorAll(".fpd-views-selection > div")).indexOf(i);this.selectView(t)});let n={},s=(I.relevantOptions.forEach(e=>{var t=this.mainOptions[e];n[e]=a(t)?{...t}:t}),e.options=a(e.options)?c(n,e.options):n,new I(this.productStage,e,this.#fe.bind(this),this.mainOptions.fabricCanvasOptions));s.fabricCanvas.on({beforeElementAdd:e=>{this.productCreated||(this.#oe++,e=e.title+"<br>"+String(this.#oe)+"/"+this.#ae,this.mainLoader.querySelector(".fpd-loader-text").innerHTML=e)},elementAdd:({element:e})=>{if(e){if(this.productCreated&&"image"==e.getType()&&e.isCustom&&(this.toggleSpinner(!1),L(this.translator.getTranslation("misc","image_added"))),e.colorLinkGroup&&0<e.colorLinkGroup.length&&!this.mainOptions.editorMode){var n=this.getViewIndexByWrapper(s.fabricCanvas.wrapperEl);if(this.colorLinkGroups.hasOwnProperty(e.colorLinkGroup)){if(this.colorLinkGroups[e.colorLinkGroup].elements.push({id:e.id,viewIndex:n}),"object"==typeof e.colors){const n=this.mainOptions.replaceColorsInColorGroup?e.colors:this.colorLinkGroups[e.colorLinkGroup].colors.concat(e.colors);this.colorLinkGroups[e.colorLinkGroup].colors=(()=>{for(var e=n.concat(),t=0;t<e.length;++t)for(var i=t+1;i<e.length;++i)e[t]===e[i]&&e.splice(i--,1);return e})()}}else this.colorLinkGroups[e.colorLinkGroup]={elements:[{id:e.id,viewIndex:n}],colors:[]},"object"==typeof e.colors&&(this.colorLinkGroups[e.colorLinkGroup].colors=e.colors)}this.dispatchEvent(new CustomEvent("elementAdd",{detail:{element:e}})),this.dispatchEvent(new CustomEvent("viewCanvasUpdate",{detail:{viewInstance:s}}))}else this.toggleSpinner(!1)},elementRemove:({element:e})=>{this.dispatchEvent(new CustomEvent("elementRemove",{detail:{element:e}})),this.dispatchEvent(new CustomEvent("viewCanvasUpdate",{detail:{viewInstance:s}}))},elementSelect:({element:t})=>{if(this.currentElement=t,this.#me(),t&&!t._ignore&&this.currentViewInstance){if(t.uploadZone&&!this.mainOptions.editorMode){let e=c(this.currentViewInstance.options.customAdds,t.customAdds||{});return void setTimeout(()=>{this.currentViewInstance.currentUploadZone=t.title,this.mainBar.toggleUploadZonePanel(!0,e)},100)}this.currentViewInstance.currentUploadZone&&this.mainBar.toggleUploadZonePanel(!1)}this.dispatchEvent(new CustomEvent("elementSelect"))},elementCheckContainemt:({boundingBoxMode:e})=>{"inside"===e&&this.#me()},elementColorChange:({target:t,colorLinking:e})=>{if(this.productCreated&&e&&t.colorLinkGroup&&0<t.colorLinkGroup.length){const e=this.colorLinkGroups[t.colorLinkGroup];e&&e.elements&&e.elements.forEach(e=>{t.id,e.id&&this.viewInstances[e.viewIndex].fabricCanvas.getElementByID(e.id).changeColor(t.fill,!1)})}new CustomEvent("elementColorChange",{detail:{target:t,colorLinking:e}}),this.dispatchEvent(new CustomEvent("viewCanvasUpdate",{detail:{viewInstance:s}}))},elementChange:({element:e,type:t})=>{this.dispatchEvent(new CustomEvent("elementChange",{detail:{type:t,element:e}}))}}),s.init()}#ge(){if(this.viewInstances.length<this.currentViews.length)this.addView(this.currentViews[this.viewInstances.length]);else{if(this.removeEventListener("viewCreate",this.#ge),this.toggleSpinner(!1),this.selectView(0),!this.mainOptions.editorMode&&this.currentViewInstance&&this.currentViewInstance.fabricCanvas.wrapperEl.offsetParent){let t=null;this.currentViewInstance.fabricCanvas.getObjects().forEach(e=>{e.autoSelect&&!e.hasUploadZone&&(t=e)}),t&&setTimeout(()=>{this.currentViewInstance.fabricCanvas.setActiveObject(t)},500)}this.productCreated=!0,this.dispatchEvent(new CustomEvent("productCreate"))}}#fe(e){this.viewInstances.push(e),e.fabricCanvas.on("sizeUpdate",({canvasHeight:e})=>{e+="px";this.productStage.style.height=e,this.container.classList.contains("fpd-sidebar")&&(this.mainBar.container.style.height=e)}),this.dispatchEvent(new CustomEvent("viewCreate",{detail:{viewInstance:e}})),e.fabricCanvas.onHistory(),e.fabricCanvas.clearHistory()}#me(){const e=this.currentElement;if(this.productCreated&&e&&!e.uploadZone&&!e.__editorMode){if(e.isOut&&"inside"===e.boundingBoxMode){const e=this.translator.getTranslation("misc","out_of_bounding_box");this.mainTooltip.innerHTML=e,this.mainTooltip.classList.add("fpd-show")}else this.mainOptions.imageSizeTooltip&&"image"===e.getType()?this.mainTooltip.classList.add("fpd-show"):this.mainTooltip.classList.remove("fpd-show");var t,i;this.mainTooltip.classList.contains("fpd-show")&&(t=e.oCoords,i=this.currentViewInstance.fabricCanvas.wrapperEl.getBoundingClientRect(),this.mainTooltip.style.left=i.left+t.mt.x-this.mainTooltip.clientWidth/2+"px",this.mainTooltip.style.top=i.top+t.mt.y-this.mainTooltip.clientHeight-20+"px")}else this.mainTooltip.classList.remove("fpd-show")}getViewIndexByWrapper(e){return Array.from(this.productStage.querySelectorAll(".fpd-view-stage")).indexOf(e)}toggleSpinner(e=!0,t=""){return this.mainLoader.querySelector(".fpd-loader-text").innerText=t,this.mainLoader.classList.toggle("fpd-hidden",!e),this.mainLoader}selectView(e=0){this.viewInstances.length<=0||(this.currentViewInstance&&this.currentViewInstance.fabricCanvas&&this.currentViewInstance.fabricCanvas.resetZoom(),(this.currentViewIndex=e)<0?this.currentViewIndex=0:e>this.viewInstances.length-1&&(this.currentViewIndex=this.viewInstances.length-1),this.currentViewInstance&&this.currentViewInstance.fabricCanvas&&this.currentViewInstance.fabricCanvas.clearHistory(),this.currentViewInstance=this.viewInstances[this.currentViewIndex],this.deselectElement(),e=this.productStage.querySelectorAll(".fpd-view-stage"),h(e,["fpd-hidden"]),u(e.item(this.currentViewIndex),["fpd-hidden"]),this.currentViewInstance.fabricCanvas.resetSize(),this.dispatchEvent(new CustomEvent("viewSelect")))}getElements(e,t="all",i=!0){e=void 0===e||isNaN(e)?-1:e,i&&this.deselectElement();let n=[];if(-1===e)for(var s=0;s<this.viewInstances.length;++s)n=n.concat(this.viewInstances[s].fabricCanvas.getObjects());else{if(!this.viewInstances[e])return[];n=this.viewInstances[e].fabricCanvas.getObjects()}if(n=n.filter(e=>!e._ignore),"text"===t){let t=[];return n.forEach(e=>{"text"===e.getType(e)&&t.push(e)}),t}if("image"!==t)return n;{let t=[];return n.forEach(function(e){"image"===e.getType()&&t.push(e)}),t}}getCustomElements(e="all",t=-1,i=!0){let n=[];return this.getElements(t,e,i).forEach(e=>{var t;e.isCustom&&(t=this.getViewIndexByWrapper(e.canvas.wrapperEl),n.push({element:e,viewIndex:t}))}),n}getFixedElements(e="all",t=-1,i=!0){let n=[];return this.getElements(t,e,i).forEach(e=>{var t;e.fixed&&(t=this.getViewIndexByWrapper(e.canvas.wrapperEl),n.push({element:e,viewIndex:t}))}),n}getElementByID(e,t){return t=void 0===t?this.currentViewIndex:t,this.viewInstances[t]?this.viewInstances[t].fabricCanvas.getElementByID(e):null}reset(){null!==this.currentViews&&(this.removeEventListener("viewCreate",this.#ge),this.deselectElement(),this.currentViewInstance.fabricCanvas.resetZoom(),this.currentViewIndex=this.currentPrice=this.singleProductPrice=this.pricingRulesPrice=0,this.currentViewInstance=this.currentViews=this.currentElement=null,this.viewInstances.forEach(e=>{e.fabricCanvas.clear()}),this.productStage.innerHTML="",this.viewsWrapper.container.querySelector(".fpd-views-selection").innerHTML="",this.viewInstances=[],this.dispatchEvent(new CustomEvent("clear")),this.dispatchEvent(new CustomEvent("priceChange")))}deselectElement(){this.currentViewInstance&&this.currentViewInstance.fabricCanvas&&(this.currentViewInstance.fabricCanvas.deselectElement(),this.currentElement=null)}formatPrice(s){var a=this.mainOptions.priceFormat;if(s&&"object"==typeof a){var o=a.thousandSep,r=a.decimalSep;let e=s.toString().split("."),t=e[0],i=e[1],n="";if(void 0!==t){for(var c=t.length-1;0<=c;c--)n+=t.charAt(c);for((n=n.replace(/(\d{3})/g,"$1"+o)).slice(-o.length)==o&&(n=n.slice(0,-o.length)),t="",c=n.length-1;0<=c;c--)t+=n.charAt(c);void 0!==i&&0<i.length&&(1==i.length&&(i+="0"),t+=r+i)}return t=a.currency.replace("%d",t.toString())}return s=s&&a.priceFormat.replace("%d",s)}addCustomImage(n,s,a={},o){o=void 0===o?this.currentViewIndex:o;const r=new Image;r.crossOrigin="anonymous",r.src=n,this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),h(this.viewsWrapper.container,["fpd-disabled"]),r.onload=()=>{this.loadingCustomImage=!1;var e=r.height,t=r.width,i=this.currentViewInstance.options.customImageParameters;if(!b(this,t,e))return this.toggleSpinner(!1),!1;t={isCustom:!0},r.src.includes(".svg")&&!i.colors&&(t.colors=!0),e=c(i,t),e=c(e,a);this.viewInstances[o].fabricCanvas.addElement("image",n,s,e,o),u(this.viewsWrapper.container,["fpd-disabled"])},r.onerror=()=>{L("Image could not be loaded!")}}_addGridItemToCanvas(e,t={},i){this.currentViewInstance&&(i=void 0===i?this.currentViewIndex:i,t=c({_addToUZ:this.currentViewInstance.currentUploadZone},t),this._addCanvasImage(e.dataset.source,e.dataset.title,t,i))}_addCanvasImage(e,t,i={},n){var s;this.currentViewInstance&&(n=void 0===n?this.currentViewIndex:n,s=!e.includes(window.location.origin),this.uploadsToServer&&s?this._downloadRemoteImage(e,t,i):(this.loadingCustomImage=!0,this.addCustomImage(e,t,i,n)),this.productCreated)&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleContentDisplay(!1)}_downloadRemoteImage(e,t,i={}){this.loadingCustomImage=!0,this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),h(this.viewsWrapper.container,["fpd-disabled"]);var n,s=new FormData;s.append("uploadsDir",this.uploadsDir),s.append("uploadsDirURL",this.uploadsDirURL),s.append("saveOnServer",this.uploadsToServer),s.append("url",e),n={url:this.uploadsURL,body:s,onSuccess:e=>{e&&e.image_src?this.addCustomImage(e.image_src,e.filename||t,i):(this.toggleSpinner(!1),L(e.error))},onError:e=>{this.loadingCustomImage=!1,this.toggleSpinner(!1),L(data.error)}},e=n.url,s={Accept:"application/json"},!n.body instanceof FormData&&(s["Content-Type"]="application/json"),fetch(e,{method:"POST",redirect:"follow",headers:s,body:n.body instanceof FormData?n.body:JSON.stringify(n.body)}).then(e=>e.json()).then(e=>{n.onSuccess&&n.onSuccess(e)}).catch(e=>{n.onError&&n.onError(e)}),this.productCreated&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleContentDisplay(!1)}addCanvasDesign(e,t,i={},n){this.currentViewInstance&&(this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),(i=c(this.currentViewInstance.options.customImageParameters,i)).isCustom=!0,this.currentViewInstance.currentUploadZone&&(i._addToUZ=this.currentViewInstance.currentUploadZone),this.currentViewInstance.fabricCanvas.addElement("image",e,t,i,n),this.productCreated)&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleContentDisplay(!1)}}window.FancyProductDesigner=A,window.FPDEmojisRegex=/(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F/g})()})();